var ga=Object.create;var ao=Object.defineProperty;var va=Object.getOwnPropertyDescriptor;var xa=Object.getOwnPropertyNames;var _a=Object.getPrototypeOf,wa=Object.prototype.hasOwnProperty;var Sa=(r,t)=>()=>(t||r((t={exports:{}}).exports,t),t.exports);var Aa=(r,t,e,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of xa(t))!wa.call(r,i)&&i!==e&&ao(r,i,{get:()=>t[i],enumerable:!(o=va(t,i))||o.enumerable});return r};var ba=(r,t,e)=>(e=r!=null?ga(_a(r)):{},Aa(t||!r||!r.__esModule?ao(e,"default",{value:r,enumerable:!0}):e,r));var Ei=Sa(($k,bi)=>{"use strict";var $s=Object.create,ee=Object.defineProperty,Zs=Object.getOwnPropertyDescriptor,tu=Object.getOwnPropertyNames,ru=Object.getPrototypeOf,eu=Object.prototype.hasOwnProperty,nu=(r,t,e)=>t in r?ee(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,Ct=(r,t)=>()=>(r&&(t=r(r=0)),t),J=(r,t)=>()=>(t||r((t={exports:{}}).exports,t),t.exports),Nt=(r,t)=>{for(var e in t)ee(r,e,{get:t[e],enumerable:!0})},qo=(r,t,e,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of tu(t))!eu.call(r,i)&&i!==e&&ee(r,i,{get:()=>t[i],enumerable:!(o=Zs(t,i))||o.enumerable});return r},In=(r,t,e)=>(e=r!=null?$s(ru(r)):{},qo(t||!r||!r.__esModule?ee(e,"default",{value:r,enumerable:!0}):e,r)),xt=r=>qo(ee({},"__esModule",{value:!0}),r),F=(r,t,e)=>(nu(r,typeof t!="symbol"?t+"":t,e),e),ou=J(r=>{"use strict";X(),r.byteLength=g,r.toByteArray=m,r.fromByteArray=y;var t=[],e=[],o=typeof Uint8Array<"u"?Uint8Array:Array,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(u=0,l=i.length;u<l;++u)t[u]=i[u],e[i.charCodeAt(u)]=u;var u,l;e["-".charCodeAt(0)]=62,e["_".charCodeAt(0)]=63;function s(p){var h=p.length;if(h%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var x=p.indexOf("=");x===-1&&(x=h);var A=x===h?0:4-x%4;return[x,A]}function g(p){var h=s(p),x=h[0],A=h[1];return(x+A)*3/4-A}function v(p,h,x){return(h+x)*3/4-x}function m(p){var h,x=s(p),A=x[0],C=x[1],E=new o(v(p,A,C)),N=0,O=C>0?A-4:A,_;for(_=0;_<O;_+=4)h=e[p.charCodeAt(_)]<<18|e[p.charCodeAt(_+1)]<<12|e[p.charCodeAt(_+2)]<<6|e[p.charCodeAt(_+3)],E[N++]=h>>16&255,E[N++]=h>>8&255,E[N++]=h&255;return C===2&&(h=e[p.charCodeAt(_)]<<2|e[p.charCodeAt(_+1)]>>4,E[N++]=h&255),C===1&&(h=e[p.charCodeAt(_)]<<10|e[p.charCodeAt(_+1)]<<4|e[p.charCodeAt(_+2)]>>2,E[N++]=h>>8&255,E[N++]=h&255),E}function d(p){return t[p>>18&63]+t[p>>12&63]+t[p>>6&63]+t[p&63]}function f(p,h,x){for(var A,C=[],E=h;E<x;E+=3)A=(p[E]<<16&16711680)+(p[E+1]<<8&65280)+(p[E+2]&255),C.push(d(A));return C.join("")}function y(p){for(var h,x=p.length,A=x%3,C=[],E=16383,N=0,O=x-A;N<O;N+=E)C.push(f(p,N,N+E>O?O:N+E));return A===1?(h=p[x-1],C.push(t[h>>2]+t[h<<4&63]+"==")):A===2&&(h=(p[x-2]<<8)+p[x-1],C.push(t[h>>10]+t[h>>4&63]+t[h<<2&63]+"=")),C.join("")}}),iu=J(r=>{X(),r.read=function(t,e,o,i,u){var l,s,g=u*8-i-1,v=(1<<g)-1,m=v>>1,d=-7,f=o?u-1:0,y=o?-1:1,p=t[e+f];for(f+=y,l=p&(1<<-d)-1,p>>=-d,d+=g;d>0;l=l*256+t[e+f],f+=y,d-=8);for(s=l&(1<<-d)-1,l>>=-d,d+=i;d>0;s=s*256+t[e+f],f+=y,d-=8);if(l===0)l=1-m;else{if(l===v)return s?NaN:(p?-1:1)*(1/0);s=s+Math.pow(2,i),l=l-m}return(p?-1:1)*s*Math.pow(2,l-i)},r.write=function(t,e,o,i,u,l){var s,g,v,m=l*8-u-1,d=(1<<m)-1,f=d>>1,y=u===23?Math.pow(2,-24)-Math.pow(2,-77):0,p=i?0:l-1,h=i?1:-1,x=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(g=isNaN(e)?1:0,s=d):(s=Math.floor(Math.log(e)/Math.LN2),e*(v=Math.pow(2,-s))<1&&(s--,v*=2),s+f>=1?e+=y/v:e+=y*Math.pow(2,1-f),e*v>=2&&(s++,v/=2),s+f>=d?(g=0,s=d):s+f>=1?(g=(e*v-1)*Math.pow(2,u),s=s+f):(g=e*Math.pow(2,f-1)*Math.pow(2,u),s=0));u>=8;t[o+p]=g&255,p+=h,g/=256,u-=8);for(s=s<<u|g,m+=u;m>0;t[o+p]=s&255,p+=h,s/=256,m-=8);t[o+p-h]|=x*128}}),au=J(r=>{"use strict";X();var t=ou(),e=iu(),o=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;r.Buffer=s,r.SlowBuffer=C,r.INSPECT_MAX_BYTES=50;var i=2147483647;r.kMaxLength=i,s.TYPED_ARRAY_SUPPORT=u(),!s.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function u(){try{let n=new Uint8Array(1),a={foo:function(){return 42}};return Object.setPrototypeOf(a,Uint8Array.prototype),Object.setPrototypeOf(n,a),n.foo()===42}catch{return!1}}Object.defineProperty(s.prototype,"parent",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.buffer}}),Object.defineProperty(s.prototype,"offset",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.byteOffset}});function l(n){if(n>i)throw new RangeError('The value "'+n+'" is invalid for option "size"');let a=new Uint8Array(n);return Object.setPrototypeOf(a,s.prototype),a}function s(n,a,c){if(typeof n=="number"){if(typeof a=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return d(n)}return g(n,a,c)}s.poolSize=8192;function g(n,a,c){if(typeof n=="string")return f(n,a);if(ArrayBuffer.isView(n))return p(n);if(n==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof n);if(Vt(n,ArrayBuffer)||n&&Vt(n.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(Vt(n,SharedArrayBuffer)||n&&Vt(n.buffer,SharedArrayBuffer)))return h(n,a,c);if(typeof n=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');let w=n.valueOf&&n.valueOf();if(w!=null&&w!==n)return s.from(w,a,c);let I=x(n);if(I)return I;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof n[Symbol.toPrimitive]=="function")return s.from(n[Symbol.toPrimitive]("string"),a,c);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof n)}s.from=function(n,a,c){return g(n,a,c)},Object.setPrototypeOf(s.prototype,Uint8Array.prototype),Object.setPrototypeOf(s,Uint8Array);function v(n){if(typeof n!="number")throw new TypeError('"size" argument must be of type number');if(n<0)throw new RangeError('The value "'+n+'" is invalid for option "size"')}function m(n,a,c){return v(n),n<=0?l(n):a!==void 0?typeof c=="string"?l(n).fill(a,c):l(n).fill(a):l(n)}s.alloc=function(n,a,c){return m(n,a,c)};function d(n){return v(n),l(n<0?0:A(n)|0)}s.allocUnsafe=function(n){return d(n)},s.allocUnsafeSlow=function(n){return d(n)};function f(n,a){if((typeof a!="string"||a==="")&&(a="utf8"),!s.isEncoding(a))throw new TypeError("Unknown encoding: "+a);let c=E(n,a)|0,w=l(c),I=w.write(n,a);return I!==c&&(w=w.slice(0,I)),w}function y(n){let a=n.length<0?0:A(n.length)|0,c=l(a);for(let w=0;w<a;w+=1)c[w]=n[w]&255;return c}function p(n){if(Vt(n,Uint8Array)){let a=new Uint8Array(n);return h(a.buffer,a.byteOffset,a.byteLength)}return y(n)}function h(n,a,c){if(a<0||n.byteLength<a)throw new RangeError('"offset" is outside of buffer bounds');if(n.byteLength<a+(c||0))throw new RangeError('"length" is outside of buffer bounds');let w;return a===void 0&&c===void 0?w=new Uint8Array(n):c===void 0?w=new Uint8Array(n,a):w=new Uint8Array(n,a,c),Object.setPrototypeOf(w,s.prototype),w}function x(n){if(s.isBuffer(n)){let a=A(n.length)|0,c=l(a);return c.length===0||n.copy(c,0,0,a),c}if(n.length!==void 0)return typeof n.length!="number"||$e(n.length)?l(0):y(n);if(n.type==="Buffer"&&Array.isArray(n.data))return y(n.data)}function A(n){if(n>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return n|0}function C(n){return+n!=n&&(n=0),s.alloc(+n)}s.isBuffer=function(n){return n!=null&&n._isBuffer===!0&&n!==s.prototype},s.compare=function(n,a){if(Vt(n,Uint8Array)&&(n=s.from(n,n.offset,n.byteLength)),Vt(a,Uint8Array)&&(a=s.from(a,a.offset,a.byteLength)),!s.isBuffer(n)||!s.isBuffer(a))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(n===a)return 0;let c=n.length,w=a.length;for(let I=0,P=Math.min(c,w);I<P;++I)if(n[I]!==a[I]){c=n[I],w=a[I];break}return c<w?-1:w<c?1:0},s.isEncoding=function(n){switch(String(n).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(n,a){if(!Array.isArray(n))throw new TypeError('"list" argument must be an Array of Buffers');if(n.length===0)return s.alloc(0);let c;if(a===void 0)for(a=0,c=0;c<n.length;++c)a+=n[c].length;let w=s.allocUnsafe(a),I=0;for(c=0;c<n.length;++c){let P=n[c];if(Vt(P,Uint8Array))I+P.length>w.length?(s.isBuffer(P)||(P=s.from(P)),P.copy(w,I)):Uint8Array.prototype.set.call(w,P,I);else if(s.isBuffer(P))P.copy(w,I);else throw new TypeError('"list" argument must be an Array of Buffers');I+=P.length}return w};function E(n,a){if(s.isBuffer(n))return n.length;if(ArrayBuffer.isView(n)||Vt(n,ArrayBuffer))return n.byteLength;if(typeof n!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof n);let c=n.length,w=arguments.length>2&&arguments[2]===!0;if(!w&&c===0)return 0;let I=!1;for(;;)switch(a){case"ascii":case"latin1":case"binary":return c;case"utf8":case"utf-8":return Xt(n).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return c*2;case"hex":return c>>>1;case"base64":return io(n).length;default:if(I)return w?-1:Xt(n).length;a=(""+a).toLowerCase(),I=!0}}s.byteLength=E;function N(n,a,c){let w=!1;if((a===void 0||a<0)&&(a=0),a>this.length||((c===void 0||c>this.length)&&(c=this.length),c<=0)||(c>>>=0,a>>>=0,c<=a))return"";for(n||(n="utf8");;)switch(n){case"hex":return ot(this,a,c);case"utf8":case"utf-8":return B(this,a,c);case"ascii":return j(this,a,c);case"latin1":case"binary":return $(this,a,c);case"base64":return Q(this,a,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ir(this,a,c);default:if(w)throw new TypeError("Unknown encoding: "+n);n=(n+"").toLowerCase(),w=!0}}s.prototype._isBuffer=!0;function O(n,a,c){let w=n[a];n[a]=n[c],n[c]=w}s.prototype.swap16=function(){let n=this.length;if(n%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let a=0;a<n;a+=2)O(this,a,a+1);return this},s.prototype.swap32=function(){let n=this.length;if(n%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let a=0;a<n;a+=4)O(this,a,a+3),O(this,a+1,a+2);return this},s.prototype.swap64=function(){let n=this.length;if(n%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let a=0;a<n;a+=8)O(this,a,a+7),O(this,a+1,a+6),O(this,a+2,a+5),O(this,a+3,a+4);return this},s.prototype.toString=function(){let n=this.length;return n===0?"":arguments.length===0?B(this,0,n):N.apply(this,arguments)},s.prototype.toLocaleString=s.prototype.toString,s.prototype.equals=function(n){if(!s.isBuffer(n))throw new TypeError("Argument must be a Buffer");return this===n?!0:s.compare(this,n)===0},s.prototype.inspect=function(){let n="",a=r.INSPECT_MAX_BYTES;return n=this.toString("hex",0,a).replace(/(.{2})/g,"$1 ").trim(),this.length>a&&(n+=" ... "),"<Buffer "+n+">"},o&&(s.prototype[o]=s.prototype.inspect),s.prototype.compare=function(n,a,c,w,I){if(Vt(n,Uint8Array)&&(n=s.from(n,n.offset,n.byteLength)),!s.isBuffer(n))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof n);if(a===void 0&&(a=0),c===void 0&&(c=n?n.length:0),w===void 0&&(w=0),I===void 0&&(I=this.length),a<0||c>n.length||w<0||I>this.length)throw new RangeError("out of range index");if(w>=I&&a>=c)return 0;if(w>=I)return-1;if(a>=c)return 1;if(a>>>=0,c>>>=0,w>>>=0,I>>>=0,this===n)return 0;let P=I-w,M=c-a,it=Math.min(P,M),At=this.slice(w,I),ut=n.slice(a,c);for(let at=0;at<it;++at)if(At[at]!==ut[at]){P=At[at],M=ut[at];break}return P<M?-1:M<P?1:0};function _(n,a,c,w,I){if(n.length===0)return-1;if(typeof c=="string"?(w=c,c=0):c>2147483647?c=2147483647:c<-2147483648&&(c=-2147483648),c=+c,$e(c)&&(c=I?0:n.length-1),c<0&&(c=n.length+c),c>=n.length){if(I)return-1;c=n.length-1}else if(c<0)if(I)c=0;else return-1;if(typeof a=="string"&&(a=s.from(a,w)),s.isBuffer(a))return a.length===0?-1:k(n,a,c,w,I);if(typeof a=="number")return a=a&255,typeof Uint8Array.prototype.indexOf=="function"?I?Uint8Array.prototype.indexOf.call(n,a,c):Uint8Array.prototype.lastIndexOf.call(n,a,c):k(n,[a],c,w,I);throw new TypeError("val must be string, number or Buffer")}function k(n,a,c,w,I){let P=1,M=n.length,it=a.length;if(w!==void 0&&(w=String(w).toLowerCase(),w==="ucs2"||w==="ucs-2"||w==="utf16le"||w==="utf-16le")){if(n.length<2||a.length<2)return-1;P=2,M/=2,it/=2,c/=2}function At(at,lt){return P===1?at[lt]:at.readUInt16BE(lt*P)}let ut;if(I){let at=-1;for(ut=c;ut<M;ut++)if(At(n,ut)===At(a,at===-1?0:ut-at)){if(at===-1&&(at=ut),ut-at+1===it)return at*P}else at!==-1&&(ut-=ut-at),at=-1}else for(c+it>M&&(c=M-it),ut=c;ut>=0;ut--){let at=!0;for(let lt=0;lt<it;lt++)if(At(n,ut+lt)!==At(a,lt)){at=!1;break}if(at)return ut}return-1}s.prototype.includes=function(n,a,c){return this.indexOf(n,a,c)!==-1},s.prototype.indexOf=function(n,a,c){return _(this,n,a,c,!0)},s.prototype.lastIndexOf=function(n,a,c){return _(this,n,a,c,!1)};function R(n,a,c,w){c=Number(c)||0;let I=n.length-c;w?(w=Number(w),w>I&&(w=I)):w=I;let P=a.length;w>P/2&&(w=P/2);let M;for(M=0;M<w;++M){let it=parseInt(a.substr(M*2,2),16);if($e(it))return M;n[c+M]=it}return M}function S(n,a,c,w){return ve(Xt(a,n.length-c),n,c,w)}function T(n,a,c,w){return ve(Ye(a),n,c,w)}function L(n,a,c,w){return ve(io(a),n,c,w)}function W(n,a,c,w){return ve(ha(a,n.length-c),n,c,w)}s.prototype.write=function(n,a,c,w){if(a===void 0)w="utf8",c=this.length,a=0;else if(c===void 0&&typeof a=="string")w=a,c=this.length,a=0;else if(isFinite(a))a=a>>>0,isFinite(c)?(c=c>>>0,w===void 0&&(w="utf8")):(w=c,c=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let I=this.length-a;if((c===void 0||c>I)&&(c=I),n.length>0&&(c<0||a<0)||a>this.length)throw new RangeError("Attempt to write outside buffer bounds");w||(w="utf8");let P=!1;for(;;)switch(w){case"hex":return R(this,n,a,c);case"utf8":case"utf-8":return S(this,n,a,c);case"ascii":case"latin1":case"binary":return T(this,n,a,c);case"base64":return L(this,n,a,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return W(this,n,a,c);default:if(P)throw new TypeError("Unknown encoding: "+w);w=(""+w).toLowerCase(),P=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function Q(n,a,c){return a===0&&c===n.length?t.fromByteArray(n):t.fromByteArray(n.slice(a,c))}function B(n,a,c){c=Math.min(n.length,c);let w=[],I=a;for(;I<c;){let P=n[I],M=null,it=P>239?4:P>223?3:P>191?2:1;if(I+it<=c){let At,ut,at,lt;switch(it){case 1:P<128&&(M=P);break;case 2:At=n[I+1],(At&192)===128&&(lt=(P&31)<<6|At&63,lt>127&&(M=lt));break;case 3:At=n[I+1],ut=n[I+2],(At&192)===128&&(ut&192)===128&&(lt=(P&15)<<12|(At&63)<<6|ut&63,lt>2047&&(lt<55296||lt>57343)&&(M=lt));break;case 4:At=n[I+1],ut=n[I+2],at=n[I+3],(At&192)===128&&(ut&192)===128&&(at&192)===128&&(lt=(P&15)<<18|(At&63)<<12|(ut&63)<<6|at&63,lt>65535&&lt<1114112&&(M=lt))}}M===null?(M=65533,it=1):M>65535&&(M-=65536,w.push(M>>>10&1023|55296),M=56320|M&1023),w.push(M),I+=it}return V(w)}var z=4096;function V(n){let a=n.length;if(a<=z)return String.fromCharCode.apply(String,n);let c="",w=0;for(;w<a;)c+=String.fromCharCode.apply(String,n.slice(w,w+=z));return c}function j(n,a,c){let w="";c=Math.min(n.length,c);for(let I=a;I<c;++I)w+=String.fromCharCode(n[I]&127);return w}function $(n,a,c){let w="";c=Math.min(n.length,c);for(let I=a;I<c;++I)w+=String.fromCharCode(n[I]);return w}function ot(n,a,c){let w=n.length;(!a||a<0)&&(a=0),(!c||c<0||c>w)&&(c=w);let I="";for(let P=a;P<c;++P)I+=da[n[P]];return I}function ir(n,a,c){let w=n.slice(a,c),I="";for(let P=0;P<w.length-1;P+=2)I+=String.fromCharCode(w[P]+w[P+1]*256);return I}s.prototype.slice=function(n,a){let c=this.length;n=~~n,a=a===void 0?c:~~a,n<0?(n+=c,n<0&&(n=0)):n>c&&(n=c),a<0?(a+=c,a<0&&(a=0)):a>c&&(a=c),a<n&&(a=n);let w=this.subarray(n,a);return Object.setPrototypeOf(w,s.prototype),w};function pt(n,a,c){if(n%1!==0||n<0)throw new RangeError("offset is not uint");if(n+a>c)throw new RangeError("Trying to access beyond buffer length")}s.prototype.readUintLE=s.prototype.readUIntLE=function(n,a,c){n=n>>>0,a=a>>>0,c||pt(n,a,this.length);let w=this[n],I=1,P=0;for(;++P<a&&(I*=256);)w+=this[n+P]*I;return w},s.prototype.readUintBE=s.prototype.readUIntBE=function(n,a,c){n=n>>>0,a=a>>>0,c||pt(n,a,this.length);let w=this[n+--a],I=1;for(;a>0&&(I*=256);)w+=this[n+--a]*I;return w},s.prototype.readUint8=s.prototype.readUInt8=function(n,a){return n=n>>>0,a||pt(n,1,this.length),this[n]},s.prototype.readUint16LE=s.prototype.readUInt16LE=function(n,a){return n=n>>>0,a||pt(n,2,this.length),this[n]|this[n+1]<<8},s.prototype.readUint16BE=s.prototype.readUInt16BE=function(n,a){return n=n>>>0,a||pt(n,2,this.length),this[n]<<8|this[n+1]},s.prototype.readUint32LE=s.prototype.readUInt32LE=function(n,a){return n=n>>>0,a||pt(n,4,this.length),(this[n]|this[n+1]<<8|this[n+2]<<16)+this[n+3]*16777216},s.prototype.readUint32BE=s.prototype.readUInt32BE=function(n,a){return n=n>>>0,a||pt(n,4,this.length),this[n]*16777216+(this[n+1]<<16|this[n+2]<<8|this[n+3])},s.prototype.readBigUInt64LE=sr(function(n){n=n>>>0,ar(n,"offset");let a=this[n],c=this[n+7];(a===void 0||c===void 0)&&Er(n,this.length-8);let w=a+this[++n]*2**8+this[++n]*2**16+this[++n]*2**24,I=this[++n]+this[++n]*2**8+this[++n]*2**16+c*2**24;return BigInt(w)+(BigInt(I)<<BigInt(32))}),s.prototype.readBigUInt64BE=sr(function(n){n=n>>>0,ar(n,"offset");let a=this[n],c=this[n+7];(a===void 0||c===void 0)&&Er(n,this.length-8);let w=a*2**24+this[++n]*2**16+this[++n]*2**8+this[++n],I=this[++n]*2**24+this[++n]*2**16+this[++n]*2**8+c;return(BigInt(w)<<BigInt(32))+BigInt(I)}),s.prototype.readIntLE=function(n,a,c){n=n>>>0,a=a>>>0,c||pt(n,a,this.length);let w=this[n],I=1,P=0;for(;++P<a&&(I*=256);)w+=this[n+P]*I;return I*=128,w>=I&&(w-=Math.pow(2,8*a)),w},s.prototype.readIntBE=function(n,a,c){n=n>>>0,a=a>>>0,c||pt(n,a,this.length);let w=a,I=1,P=this[n+--w];for(;w>0&&(I*=256);)P+=this[n+--w]*I;return I*=128,P>=I&&(P-=Math.pow(2,8*a)),P},s.prototype.readInt8=function(n,a){return n=n>>>0,a||pt(n,1,this.length),this[n]&128?(255-this[n]+1)*-1:this[n]},s.prototype.readInt16LE=function(n,a){n=n>>>0,a||pt(n,2,this.length);let c=this[n]|this[n+1]<<8;return c&32768?c|4294901760:c},s.prototype.readInt16BE=function(n,a){n=n>>>0,a||pt(n,2,this.length);let c=this[n+1]|this[n]<<8;return c&32768?c|4294901760:c},s.prototype.readInt32LE=function(n,a){return n=n>>>0,a||pt(n,4,this.length),this[n]|this[n+1]<<8|this[n+2]<<16|this[n+3]<<24},s.prototype.readInt32BE=function(n,a){return n=n>>>0,a||pt(n,4,this.length),this[n]<<24|this[n+1]<<16|this[n+2]<<8|this[n+3]},s.prototype.readBigInt64LE=sr(function(n){n=n>>>0,ar(n,"offset");let a=this[n],c=this[n+7];(a===void 0||c===void 0)&&Er(n,this.length-8);let w=this[n+4]+this[n+5]*2**8+this[n+6]*2**16+(c<<24);return(BigInt(w)<<BigInt(32))+BigInt(a+this[++n]*2**8+this[++n]*2**16+this[++n]*2**24)}),s.prototype.readBigInt64BE=sr(function(n){n=n>>>0,ar(n,"offset");let a=this[n],c=this[n+7];(a===void 0||c===void 0)&&Er(n,this.length-8);let w=(a<<24)+this[++n]*2**16+this[++n]*2**8+this[++n];return(BigInt(w)<<BigInt(32))+BigInt(this[++n]*2**24+this[++n]*2**16+this[++n]*2**8+c)}),s.prototype.readFloatLE=function(n,a){return n=n>>>0,a||pt(n,4,this.length),e.read(this,n,!0,23,4)},s.prototype.readFloatBE=function(n,a){return n=n>>>0,a||pt(n,4,this.length),e.read(this,n,!1,23,4)},s.prototype.readDoubleLE=function(n,a){return n=n>>>0,a||pt(n,8,this.length),e.read(this,n,!0,52,8)},s.prototype.readDoubleBE=function(n,a){return n=n>>>0,a||pt(n,8,this.length),e.read(this,n,!1,52,8)};function It(n,a,c,w,I,P){if(!s.isBuffer(n))throw new TypeError('"buffer" argument must be a Buffer instance');if(a>I||a<P)throw new RangeError('"value" argument is out of bounds');if(c+w>n.length)throw new RangeError("Index out of range")}s.prototype.writeUintLE=s.prototype.writeUIntLE=function(n,a,c,w){if(n=+n,a=a>>>0,c=c>>>0,!w){let M=Math.pow(2,8*c)-1;It(this,n,a,c,M,0)}let I=1,P=0;for(this[a]=n&255;++P<c&&(I*=256);)this[a+P]=n/I&255;return a+c},s.prototype.writeUintBE=s.prototype.writeUIntBE=function(n,a,c,w){if(n=+n,a=a>>>0,c=c>>>0,!w){let M=Math.pow(2,8*c)-1;It(this,n,a,c,M,0)}let I=c-1,P=1;for(this[a+I]=n&255;--I>=0&&(P*=256);)this[a+I]=n/P&255;return a+c},s.prototype.writeUint8=s.prototype.writeUInt8=function(n,a,c){return n=+n,a=a>>>0,c||It(this,n,a,1,255,0),this[a]=n&255,a+1},s.prototype.writeUint16LE=s.prototype.writeUInt16LE=function(n,a,c){return n=+n,a=a>>>0,c||It(this,n,a,2,65535,0),this[a]=n&255,this[a+1]=n>>>8,a+2},s.prototype.writeUint16BE=s.prototype.writeUInt16BE=function(n,a,c){return n=+n,a=a>>>0,c||It(this,n,a,2,65535,0),this[a]=n>>>8,this[a+1]=n&255,a+2},s.prototype.writeUint32LE=s.prototype.writeUInt32LE=function(n,a,c){return n=+n,a=a>>>0,c||It(this,n,a,4,4294967295,0),this[a+3]=n>>>24,this[a+2]=n>>>16,this[a+1]=n>>>8,this[a]=n&255,a+4},s.prototype.writeUint32BE=s.prototype.writeUInt32BE=function(n,a,c){return n=+n,a=a>>>0,c||It(this,n,a,4,4294967295,0),this[a]=n>>>24,this[a+1]=n>>>16,this[a+2]=n>>>8,this[a+3]=n&255,a+4};function me(n,a,c,w,I){ge(a,w,I,n,c,7);let P=Number(a&BigInt(4294967295));n[c++]=P,P=P>>8,n[c++]=P,P=P>>8,n[c++]=P,P=P>>8,n[c++]=P;let M=Number(a>>BigInt(32)&BigInt(4294967295));return n[c++]=M,M=M>>8,n[c++]=M,M=M>>8,n[c++]=M,M=M>>8,n[c++]=M,c}function he(n,a,c,w,I){ge(a,w,I,n,c,7);let P=Number(a&BigInt(4294967295));n[c+7]=P,P=P>>8,n[c+6]=P,P=P>>8,n[c+5]=P,P=P>>8,n[c+4]=P;let M=Number(a>>BigInt(32)&BigInt(4294967295));return n[c+3]=M,M=M>>8,n[c+2]=M,M=M>>8,n[c+1]=M,M=M>>8,n[c]=M,c+8}s.prototype.writeBigUInt64LE=sr(function(n,a=0){return me(this,n,a,BigInt(0),BigInt("0xffffffffffffffff"))}),s.prototype.writeBigUInt64BE=sr(function(n,a=0){return he(this,n,a,BigInt(0),BigInt("0xffffffffffffffff"))}),s.prototype.writeIntLE=function(n,a,c,w){if(n=+n,a=a>>>0,!w){let it=Math.pow(2,8*c-1);It(this,n,a,c,it-1,-it)}let I=0,P=1,M=0;for(this[a]=n&255;++I<c&&(P*=256);)n<0&&M===0&&this[a+I-1]!==0&&(M=1),this[a+I]=(n/P>>0)-M&255;return a+c},s.prototype.writeIntBE=function(n,a,c,w){if(n=+n,a=a>>>0,!w){let it=Math.pow(2,8*c-1);It(this,n,a,c,it-1,-it)}let I=c-1,P=1,M=0;for(this[a+I]=n&255;--I>=0&&(P*=256);)n<0&&M===0&&this[a+I+1]!==0&&(M=1),this[a+I]=(n/P>>0)-M&255;return a+c},s.prototype.writeInt8=function(n,a,c){return n=+n,a=a>>>0,c||It(this,n,a,1,127,-128),n<0&&(n=255+n+1),this[a]=n&255,a+1},s.prototype.writeInt16LE=function(n,a,c){return n=+n,a=a>>>0,c||It(this,n,a,2,32767,-32768),this[a]=n&255,this[a+1]=n>>>8,a+2},s.prototype.writeInt16BE=function(n,a,c){return n=+n,a=a>>>0,c||It(this,n,a,2,32767,-32768),this[a]=n>>>8,this[a+1]=n&255,a+2},s.prototype.writeInt32LE=function(n,a,c){return n=+n,a=a>>>0,c||It(this,n,a,4,2147483647,-2147483648),this[a]=n&255,this[a+1]=n>>>8,this[a+2]=n>>>16,this[a+3]=n>>>24,a+4},s.prototype.writeInt32BE=function(n,a,c){return n=+n,a=a>>>0,c||It(this,n,a,4,2147483647,-2147483648),n<0&&(n=4294967295+n+1),this[a]=n>>>24,this[a+1]=n>>>16,this[a+2]=n>>>8,this[a+3]=n&255,a+4},s.prototype.writeBigInt64LE=sr(function(n,a=0){return me(this,n,a,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),s.prototype.writeBigInt64BE=sr(function(n,a=0){return he(this,n,a,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Ar(n,a,c,w,I,P){if(c+w>n.length)throw new RangeError("Index out of range");if(c<0)throw new RangeError("Index out of range")}function de(n,a,c,w,I){return a=+a,c=c>>>0,I||Ar(n,a,c,4,34028234663852886e22,-34028234663852886e22),e.write(n,a,c,w,23,4),c+4}s.prototype.writeFloatLE=function(n,a,c){return de(this,n,a,!0,c)},s.prototype.writeFloatBE=function(n,a,c){return de(this,n,a,!1,c)};function ye(n,a,c,w,I){return a=+a,c=c>>>0,I||Ar(n,a,c,8,17976931348623157e292,-17976931348623157e292),e.write(n,a,c,w,52,8),c+8}s.prototype.writeDoubleLE=function(n,a,c){return ye(this,n,a,!0,c)},s.prototype.writeDoubleBE=function(n,a,c){return ye(this,n,a,!1,c)},s.prototype.copy=function(n,a,c,w){if(!s.isBuffer(n))throw new TypeError("argument should be a Buffer");if(c||(c=0),!w&&w!==0&&(w=this.length),a>=n.length&&(a=n.length),a||(a=0),w>0&&w<c&&(w=c),w===c||n.length===0||this.length===0)return 0;if(a<0)throw new RangeError("targetStart out of bounds");if(c<0||c>=this.length)throw new RangeError("Index out of range");if(w<0)throw new RangeError("sourceEnd out of bounds");w>this.length&&(w=this.length),n.length-a<w-c&&(w=n.length-a+c);let I=w-c;return this===n&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(a,c,w):Uint8Array.prototype.set.call(n,this.subarray(c,w),a),I},s.prototype.fill=function(n,a,c,w){if(typeof n=="string"){if(typeof a=="string"?(w=a,a=0,c=this.length):typeof c=="string"&&(w=c,c=this.length),w!==void 0&&typeof w!="string")throw new TypeError("encoding must be a string");if(typeof w=="string"&&!s.isEncoding(w))throw new TypeError("Unknown encoding: "+w);if(n.length===1){let P=n.charCodeAt(0);(w==="utf8"&&P<128||w==="latin1")&&(n=P)}}else typeof n=="number"?n=n&255:typeof n=="boolean"&&(n=Number(n));if(a<0||this.length<a||this.length<c)throw new RangeError("Out of range index");if(c<=a)return this;a=a>>>0,c=c===void 0?this.length:c>>>0,n||(n=0);let I;if(typeof n=="number")for(I=a;I<c;++I)this[I]=n;else{let P=s.isBuffer(n)?n:s.from(n,w),M=P.length;if(M===0)throw new TypeError('The value "'+n+'" is invalid for argument "value"');for(I=0;I<c-a;++I)this[I+a]=P[I%M]}return this};var $t={};function Br(n,a,c){$t[n]=class extends c{constructor(){super(),Object.defineProperty(this,"message",{value:a.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${n}]`,this.stack,delete this.name}get code(){return n}set code(w){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:w,writable:!0})}toString(){return`${this.name} [${n}]: ${this.message}`}}}Br("ERR_BUFFER_OUT_OF_BOUNDS",function(n){return n?`${n} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),Br("ERR_INVALID_ARG_TYPE",function(n,a){return`The "${n}" argument must be of type number. Received type ${typeof a}`},TypeError),Br("ERR_OUT_OF_RANGE",function(n,a,c){let w=`The value of "${n}" is out of range.`,I=c;return Number.isInteger(c)&&Math.abs(c)>2**32?I=br(String(c)):typeof c=="bigint"&&(I=String(c),(c>BigInt(2)**BigInt(32)||c<-(BigInt(2)**BigInt(32)))&&(I=br(I)),I+="n"),w+=` It must be ${a}. Received ${I}`,w},RangeError);function br(n){let a="",c=n.length,w=n[0]==="-"?1:0;for(;c>=w+4;c-=3)a=`_${n.slice(c-3,c)}${a}`;return`${n.slice(0,c)}${a}`}function Je(n,a,c){ar(a,"offset"),(n[a]===void 0||n[a+c]===void 0)&&Er(a,n.length-(c+1))}function ge(n,a,c,w,I,P){if(n>c||n<a){let M=typeof a=="bigint"?"n":"",it;throw P>3?a===0||a===BigInt(0)?it=`>= 0${M} and < 2${M} ** ${(P+1)*8}${M}`:it=`>= -(2${M} ** ${(P+1)*8-1}${M}) and < 2 ** ${(P+1)*8-1}${M}`:it=`>= ${a}${M} and <= ${c}${M}`,new $t.ERR_OUT_OF_RANGE("value",it,n)}Je(w,I,P)}function ar(n,a){if(typeof n!="number")throw new $t.ERR_INVALID_ARG_TYPE(a,"number",n)}function Er(n,a,c){throw Math.floor(n)!==n?(ar(n,c),new $t.ERR_OUT_OF_RANGE(c||"offset","an integer",n)):a<0?new $t.ERR_BUFFER_OUT_OF_BOUNDS:new $t.ERR_OUT_OF_RANGE(c||"offset",`>= ${c?1:0} and <= ${a}`,n)}var Nr=/[^+/0-9A-Za-z-_]/g;function ht(n){if(n=n.split("=")[0],n=n.trim().replace(Nr,""),n.length<2)return"";for(;n.length%4!==0;)n=n+"=";return n}function Xt(n,a){a=a||1/0;let c,w=n.length,I=null,P=[];for(let M=0;M<w;++M){if(c=n.charCodeAt(M),c>55295&&c<57344){if(!I){if(c>56319){(a-=3)>-1&&P.push(239,191,189);continue}else if(M+1===w){(a-=3)>-1&&P.push(239,191,189);continue}I=c;continue}if(c<56320){(a-=3)>-1&&P.push(239,191,189),I=c;continue}c=(I-55296<<10|c-56320)+65536}else I&&(a-=3)>-1&&P.push(239,191,189);if(I=null,c<128){if((a-=1)<0)break;P.push(c)}else if(c<2048){if((a-=2)<0)break;P.push(c>>6|192,c&63|128)}else if(c<65536){if((a-=3)<0)break;P.push(c>>12|224,c>>6&63|128,c&63|128)}else if(c<1114112){if((a-=4)<0)break;P.push(c>>18|240,c>>12&63|128,c>>6&63|128,c&63|128)}else throw new Error("Invalid code point")}return P}function Ye(n){let a=[];for(let c=0;c<n.length;++c)a.push(n.charCodeAt(c)&255);return a}function ha(n,a){let c,w,I,P=[];for(let M=0;M<n.length&&!((a-=2)<0);++M)c=n.charCodeAt(M),w=c>>8,I=c%256,P.push(I),P.push(w);return P}function io(n){return t.toByteArray(ht(n))}function ve(n,a,c,w){let I;for(I=0;I<w&&!(I+c>=a.length||I>=n.length);++I)a[I+c]=n[I];return I}function Vt(n,a){return n instanceof a||n!=null&&n.constructor!=null&&n.constructor.name!=null&&n.constructor.name===a.name}function $e(n){return n!==n}var da=function(){let n="0123456789abcdef",a=new Array(256);for(let c=0;c<16;++c){let w=c*16;for(let I=0;I<16;++I)a[w+I]=n[c]+n[I]}return a}();function sr(n){return typeof BigInt>"u"?ya:n}function ya(){throw new Error("BigInt not supported")}}),Te,Rn,G,Y,vt,X=Ct(()=>{"use strict";Te=globalThis,Rn=globalThis.setImmediate??(r=>setTimeout(r,0)),G=typeof globalThis.Buffer=="function"&&typeof globalThis.Buffer.allocUnsafe=="function"?globalThis.Buffer:au().Buffer,Y=globalThis.process??{},Y.env??(Y.env={}),Y.nextTick??(Y.nextTick=r=>setTimeout(r,0)),vt=globalThis.crypto??{},vt.subtle??(vt.subtle={})}),kr=J((r,t)=>{"use strict";X();var e=typeof Reflect=="object"?Reflect:null,o=e&&typeof e.apply=="function"?e.apply:function(_,k,R){return Function.prototype.apply.call(_,k,R)},i;e&&typeof e.ownKeys=="function"?i=e.ownKeys:Object.getOwnPropertySymbols?i=function(_){return Object.getOwnPropertyNames(_).concat(Object.getOwnPropertySymbols(_))}:i=function(_){return Object.getOwnPropertyNames(_)};function u(_){console&&console.warn&&console.warn(_)}var l=Number.isNaN||function(_){return _!==_};function s(){s.init.call(this)}t.exports=s,t.exports.once=E,s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var g=10;function v(_){if(typeof _!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof _)}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return g},set:function(_){if(typeof _!="number"||_<0||l(_))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+_+".");g=_}}),s.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(_){if(typeof _!="number"||_<0||l(_))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+_+".");return this._maxListeners=_,this};function m(_){return _._maxListeners===void 0?s.defaultMaxListeners:_._maxListeners}s.prototype.getMaxListeners=function(){return m(this)},s.prototype.emit=function(_){for(var k=[],R=1;R<arguments.length;R++)k.push(arguments[R]);var S=_==="error",T=this._events;if(T!==void 0)S=S&&T.error===void 0;else if(!S)return!1;if(S){var L;if(k.length>0&&(L=k[0]),L instanceof Error)throw L;var W=new Error("Unhandled error."+(L?" ("+L.message+")":""));throw W.context=L,W}var Q=T[_];if(Q===void 0)return!1;if(typeof Q=="function")o(Q,this,k);else for(var B=Q.length,z=x(Q,B),R=0;R<B;++R)o(z[R],this,k);return!0};function d(_,k,R,S){var T,L,W;if(v(R),L=_._events,L===void 0?(L=_._events=Object.create(null),_._eventsCount=0):(L.newListener!==void 0&&(_.emit("newListener",k,R.listener?R.listener:R),L=_._events),W=L[k]),W===void 0)W=L[k]=R,++_._eventsCount;else if(typeof W=="function"?W=L[k]=S?[R,W]:[W,R]:S?W.unshift(R):W.push(R),T=m(_),T>0&&W.length>T&&!W.warned){W.warned=!0;var Q=new Error("Possible EventEmitter memory leak detected. "+W.length+" "+String(k)+" listeners added. Use emitter.setMaxListeners() to increase limit");Q.name="MaxListenersExceededWarning",Q.emitter=_,Q.type=k,Q.count=W.length,u(Q)}return _}s.prototype.addListener=function(_,k){return d(this,_,k,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(_,k){return d(this,_,k,!0)};function f(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function y(_,k,R){var S={fired:!1,wrapFn:void 0,target:_,type:k,listener:R},T=f.bind(S);return T.listener=R,S.wrapFn=T,T}s.prototype.once=function(_,k){return v(k),this.on(_,y(this,_,k)),this},s.prototype.prependOnceListener=function(_,k){return v(k),this.prependListener(_,y(this,_,k)),this},s.prototype.removeListener=function(_,k){var R,S,T,L,W;if(v(k),S=this._events,S===void 0)return this;if(R=S[_],R===void 0)return this;if(R===k||R.listener===k)--this._eventsCount===0?this._events=Object.create(null):(delete S[_],S.removeListener&&this.emit("removeListener",_,R.listener||k));else if(typeof R!="function"){for(T=-1,L=R.length-1;L>=0;L--)if(R[L]===k||R[L].listener===k){W=R[L].listener,T=L;break}if(T<0)return this;T===0?R.shift():A(R,T),R.length===1&&(S[_]=R[0]),S.removeListener!==void 0&&this.emit("removeListener",_,W||k)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(_){var k,R,S;if(R=this._events,R===void 0)return this;if(R.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):R[_]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete R[_]),this;if(arguments.length===0){var T=Object.keys(R),L;for(S=0;S<T.length;++S)L=T[S],L!=="removeListener"&&this.removeAllListeners(L);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(k=R[_],typeof k=="function")this.removeListener(_,k);else if(k!==void 0)for(S=k.length-1;S>=0;S--)this.removeListener(_,k[S]);return this};function p(_,k,R){var S=_._events;if(S===void 0)return[];var T=S[k];return T===void 0?[]:typeof T=="function"?R?[T.listener||T]:[T]:R?C(T):x(T,T.length)}s.prototype.listeners=function(_){return p(this,_,!0)},s.prototype.rawListeners=function(_){return p(this,_,!1)},s.listenerCount=function(_,k){return typeof _.listenerCount=="function"?_.listenerCount(k):h.call(_,k)},s.prototype.listenerCount=h;function h(_){var k=this._events;if(k!==void 0){var R=k[_];if(typeof R=="function")return 1;if(R!==void 0)return R.length}return 0}s.prototype.eventNames=function(){return this._eventsCount>0?i(this._events):[]};function x(_,k){for(var R=new Array(k),S=0;S<k;++S)R[S]=_[S];return R}function A(_,k){for(;k+1<_.length;k++)_[k]=_[k+1];_.pop()}function C(_){for(var k=new Array(_.length),R=0;R<k.length;++R)k[R]=_[R].listener||_[R];return k}function E(_,k){return new Promise(function(R,S){function T(W){_.removeListener(k,L),S(W)}function L(){typeof _.removeListener=="function"&&_.removeListener("error",T),R([].slice.call(arguments))}O(_,k,L,{once:!0}),k!=="error"&&N(_,T,{once:!0})})}function N(_,k,R){typeof _.on=="function"&&O(_,"error",k,R)}function O(_,k,R,S){if(typeof _.on=="function")S.once?_.once(k,R):_.on(k,R);else if(typeof _.addEventListener=="function")_.addEventListener(k,function T(L){S.once&&_.removeEventListener(k,T),R(L)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof _)}});function Pe(r){let t=1779033703,e=3144134277,o=1013904242,i=2773480762,u=1359893119,l=2600822924,s=528734635,g=1541459225,v=0,m=0,d=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],f=(C,E)=>C>>>E|C<<32-E,y=new Uint32Array(64),p=new Uint8Array(64),h=()=>{for(let T=0,L=0;T<16;T++,L+=4)y[T]=p[L]<<24|p[L+1]<<16|p[L+2]<<8|p[L+3];for(let T=16;T<64;T++){let L=f(y[T-15],7)^f(y[T-15],18)^y[T-15]>>>3,W=f(y[T-2],17)^f(y[T-2],19)^y[T-2]>>>10;y[T]=y[T-16]+L+y[T-7]+W|0}let C=t,E=e,N=o,O=i,_=u,k=l,R=s,S=g;for(let T=0;T<64;T++){let L=f(_,6)^f(_,11)^f(_,25),W=_&k^~_&R,Q=S+L+W+d[T]+y[T]|0,B=f(C,2)^f(C,13)^f(C,22),z=C&E^C&N^E&N,V=B+z|0;S=R,R=k,k=_,_=O+Q|0,O=N,N=E,E=C,C=Q+V|0}t=t+C|0,e=e+E|0,o=o+N|0,i=i+O|0,u=u+_|0,l=l+k|0,s=s+R|0,g=g+S|0,m=0},x=C=>{typeof C=="string"&&(C=new TextEncoder().encode(C));for(let E=0;E<C.length;E++)p[m++]=C[E],m===64&&h();v+=C.length},A=()=>{if(p[m++]=128,m==64&&h(),m+8>64){for(;m<64;)p[m++]=0;h()}for(;m<58;)p[m++]=0;let C=v*8;p[m++]=C/1099511627776&255,p[m++]=C/4294967296&255,p[m++]=C>>>24,p[m++]=C>>>16&255,p[m++]=C>>>8&255,p[m++]=C&255,h();let E=new Uint8Array(32);return E[0]=t>>>24,E[1]=t>>>16&255,E[2]=t>>>8&255,E[3]=t&255,E[4]=e>>>24,E[5]=e>>>16&255,E[6]=e>>>8&255,E[7]=e&255,E[8]=o>>>24,E[9]=o>>>16&255,E[10]=o>>>8&255,E[11]=o&255,E[12]=i>>>24,E[13]=i>>>16&255,E[14]=i>>>8&255,E[15]=i&255,E[16]=u>>>24,E[17]=u>>>16&255,E[18]=u>>>8&255,E[19]=u&255,E[20]=l>>>24,E[21]=l>>>16&255,E[22]=l>>>8&255,E[23]=l&255,E[24]=s>>>24,E[25]=s>>>16&255,E[26]=s>>>8&255,E[27]=s&255,E[28]=g>>>24,E[29]=g>>>16&255,E[30]=g>>>8&255,E[31]=g&255,E};return r===void 0?{add:x,digest:A}:(x(r),A())}var su=Ct(()=>{"use strict";X()}),Un={};Nt(Un,{createHash:()=>fu,createHmac:()=>pu,randomBytes:()=>uu});function uu(r){return vt.getRandomValues(G.alloc(r))}function fu(r){if(r!=="sha256")throw new Error("Only sha256 is supported");return{update:function(t){return{digest:function(){return G.from(Pe(t))}}}}}function pu(r,t){if(r!=="sha256")throw new Error("Only sha256 is supported");return{update:function(e){return{digest:function(){typeof t=="string"&&(t=new TextEncoder().encode(t)),typeof e=="string"&&(e=new TextEncoder().encode(e));let o=t.length;if(o>64)t=Pe(t);else if(o<64){let g=new Uint8Array(64);g.set(t),t=g}let i=new Uint8Array(64),u=new Uint8Array(64);for(let g=0;g<64;g++)i[g]=54^t[g],u[g]=92^t[g];let l=new Uint8Array(e.length+64);l.set(i,0),l.set(e,64);let s=new Uint8Array(64+32);return s.set(u,0),s.set(Pe(l),64),G.from(Pe(s))}}}}}var jo=Ct(()=>{X(),su()}),Fo=J(r=>{"use strict";X(),r.parse=function(o,i){return new t(o,i).parse()};var t=class{constructor(o,i){this.source=o,this.transform=i||e,this.position=0,this.entries=[],this.recorded=[],this.dimension=0}isEof(){return this.position>=this.source.length}nextCharacter(){var o=this.source[this.position++];return o==="\\"?{value:this.source[this.position++],escaped:!0}:{value:o,escaped:!1}}record(o){this.recorded.push(o)}newEntry(o){var i;(this.recorded.length>0||o)&&(i=this.recorded.join(""),i==="NULL"&&!o&&(i=null),i!==null&&(i=this.transform(i)),this.entries.push(i),this.recorded=[])}consumeDimensions(){if(this.source[0]==="[")for(;!this.isEof();){var o=this.nextCharacter();if(o.value==="=")break}}parse(o){var i,u,l;for(this.consumeDimensions();!this.isEof();)if(i=this.nextCharacter(),i.value==="{"&&!l)this.dimension++,this.dimension>1&&(u=new t(this.source.substr(this.position-1),this.transform),this.entries.push(u.parse(!0)),this.position+=u.position-2);else if(i.value==="}"&&!l){if(this.dimension--,!this.dimension&&(this.newEntry(),o))return this.entries}else i.value==='"'&&!i.escaped?(l&&this.newEntry(!0),l=!l):i.value===","&&!l?this.newEntry():this.record(i.value);if(this.dimension!==0)throw new Error("array dimension not balanced");return this.entries}};function e(o){return o}}),Qo=J((r,t)=>{X();var e=Fo();t.exports={create:function(o,i){return{parse:function(){return e.parse(o,i)}}}}}),cu=J((r,t)=>{"use strict";X();var e=/(\d{1,})-(\d{2})-(\d{2}) (\d{2}):(\d{2}):(\d{2})(\.\d{1,})?.*?( BC)?$/,o=/^(\d{1,})-(\d{2})-(\d{2})( BC)?$/,i=/([Z+-])(\d{2})?:?(\d{2})?:?(\d{2})?/,u=/^-?infinity$/;t.exports=function(m){if(u.test(m))return Number(m.replace("i","I"));var d=e.exec(m);if(!d)return l(m)||null;var f=!!d[8],y=parseInt(d[1],10);f&&(y=g(y));var p=parseInt(d[2],10)-1,h=d[3],x=parseInt(d[4],10),A=parseInt(d[5],10),C=parseInt(d[6],10),E=d[7];E=E?1e3*parseFloat(E):0;var N,O=s(m);return O!=null?(N=new Date(Date.UTC(y,p,h,x,A,C,E)),v(y)&&N.setUTCFullYear(y),O!==0&&N.setTime(N.getTime()-O)):(N=new Date(y,p,h,x,A,C,E),v(y)&&N.setFullYear(y)),N};function l(m){var d=o.exec(m);if(d){var f=parseInt(d[1],10),y=!!d[4];y&&(f=g(f));var p=parseInt(d[2],10)-1,h=d[3],x=new Date(f,p,h);return v(f)&&x.setFullYear(f),x}}function s(m){if(m.endsWith("+00"))return 0;var d=i.exec(m.split(" ")[1]);if(d){var f=d[1];if(f==="Z")return 0;var y=f==="-"?-1:1,p=parseInt(d[2],10)*3600+parseInt(d[3]||0,10)*60+parseInt(d[4]||0,10);return p*y*1e3}}function g(m){return-(m-1)}function v(m){return m>=0&&m<100}}),lu=J((r,t)=>{X(),t.exports=o;var e=Object.prototype.hasOwnProperty;function o(i){for(var u=1;u<arguments.length;u++){var l=arguments[u];for(var s in l)e.call(l,s)&&(i[s]=l[s])}return i}}),mu=J((r,t)=>{"use strict";X();var e=lu();t.exports=o;function o(C){if(!(this instanceof o))return new o(C);e(this,A(C))}var i=["seconds","minutes","hours","days","months","years"];o.prototype.toPostgres=function(){var C=i.filter(this.hasOwnProperty,this);return this.milliseconds&&C.indexOf("seconds")<0&&C.push("seconds"),C.length===0?"0":C.map(function(E){var N=this[E]||0;return E==="seconds"&&this.milliseconds&&(N=(N+this.milliseconds/1e3).toFixed(6).replace(/\.?0+$/,"")),N+" "+E},this).join(" ")};var u={years:"Y",months:"M",days:"D",hours:"H",minutes:"M",seconds:"S"},l=["years","months","days"],s=["hours","minutes","seconds"];o.prototype.toISOString=o.prototype.toISO=function(){var C=l.map(N,this).join(""),E=s.map(N,this).join("");return"P"+C+"T"+E;function N(O){var _=this[O]||0;return O==="seconds"&&this.milliseconds&&(_=(_+this.milliseconds/1e3).toFixed(6).replace(/0+$/,"")),_+u[O]}};var g="([+-]?\\d+)",v=g+"\\s+years?",m=g+"\\s+mons?",d=g+"\\s+days?",f="([+-])?([\\d]*):(\\d\\d):(\\d\\d)\\.?(\\d{1,6})?",y=new RegExp([v,m,d,f].map(function(C){return"("+C+")?"}).join("\\s*")),p={years:2,months:4,days:6,hours:9,minutes:10,seconds:11,milliseconds:12},h=["hours","minutes","seconds","milliseconds"];function x(C){var E=C+"000000".slice(C.length);return parseInt(E,10)/1e3}function A(C){if(!C)return{};var E=y.exec(C),N=E[8]==="-";return Object.keys(p).reduce(function(O,_){var k=p[_],R=E[k];return!R||(R=_==="milliseconds"?x(R):parseInt(R,10),!R)||(N&&~h.indexOf(_)&&(R*=-1),O[_]=R),O},{})}}),hu=J((r,t)=>{"use strict";X(),t.exports=function(e){if(/^\\x/.test(e))return new G(e.substr(2),"hex");for(var o="",i=0;i<e.length;)if(e[i]!=="\\")o+=e[i],++i;else if(/[0-7]{3}/.test(e.substr(i+1,3)))o+=String.fromCharCode(parseInt(e.substr(i+1,3),8)),i+=4;else{for(var u=1;i+u<e.length&&e[i+u]==="\\";)u++;for(var l=0;l<Math.floor(u/2);++l)o+="\\";i+=Math.floor(u/2)*2}return new G(o,"binary")}}),du=J((r,t)=>{X();var e=Fo(),o=Qo(),i=cu(),u=mu(),l=hu();function s(S){return function(T){return T===null?T:S(T)}}function g(S){return S===null?S:S==="TRUE"||S==="t"||S==="true"||S==="y"||S==="yes"||S==="on"||S==="1"}function v(S){return S?e.parse(S,g):null}function m(S){return parseInt(S,10)}function d(S){return S?e.parse(S,s(m)):null}function f(S){return S?e.parse(S,s(function(T){return N(T).trim()})):null}var y=function(S){if(!S)return null;var T=o.create(S,function(L){return L!==null&&(L=_(L)),L});return T.parse()},p=function(S){if(!S)return null;var T=o.create(S,function(L){return L!==null&&(L=parseFloat(L)),L});return T.parse()},h=function(S){if(!S)return null;var T=o.create(S);return T.parse()},x=function(S){if(!S)return null;var T=o.create(S,function(L){return L!==null&&(L=i(L)),L});return T.parse()},A=function(S){if(!S)return null;var T=o.create(S,function(L){return L!==null&&(L=u(L)),L});return T.parse()},C=function(S){return S?e.parse(S,s(l)):null},E=function(S){return parseInt(S,10)},N=function(S){var T=String(S);return/^\d+$/.test(T)?T:S},O=function(S){return S?e.parse(S,s(JSON.parse)):null},_=function(S){return S[0]!=="("?null:(S=S.substring(1,S.length-1).split(","),{x:parseFloat(S[0]),y:parseFloat(S[1])})},k=function(S){if(S[0]!=="<"&&S[1]!=="(")return null;for(var T="(",L="",W=!1,Q=2;Q<S.length-1;Q++){if(W||(T+=S[Q]),S[Q]===")"){W=!0;continue}else if(!W)continue;S[Q]!==","&&(L+=S[Q])}var B=_(T);return B.radius=parseFloat(L),B},R=function(S){S(20,N),S(21,E),S(23,E),S(26,E),S(700,parseFloat),S(701,parseFloat),S(16,g),S(1082,i),S(1114,i),S(1184,i),S(600,_),S(651,h),S(718,k),S(1e3,v),S(1001,C),S(1005,d),S(1007,d),S(1028,d),S(1016,f),S(1017,y),S(1021,p),S(1022,p),S(1231,p),S(1014,h),S(1015,h),S(1008,h),S(1009,h),S(1040,h),S(1041,h),S(1115,x),S(1182,x),S(1185,x),S(1186,u),S(1187,A),S(17,l),S(114,JSON.parse.bind(JSON)),S(3802,JSON.parse.bind(JSON)),S(199,O),S(3807,O),S(3907,h),S(2951,h),S(791,h),S(1183,h),S(1270,h)};t.exports={init:R}}),yu=J((r,t)=>{"use strict";X();var e=1e6;function o(i){var u=i.readInt32BE(0),l=i.readUInt32BE(4),s="";u<0&&(u=~u+(l===0),l=~l+1>>>0,s="-");var g="",v,m,d,f,y,p;{if(v=u%e,u=u/e>>>0,m=4294967296*v+l,l=m/e>>>0,d=""+(m-e*l),l===0&&u===0)return s+d+g;for(f="",y=6-d.length,p=0;p<y;p++)f+="0";g=f+d+g}{if(v=u%e,u=u/e>>>0,m=4294967296*v+l,l=m/e>>>0,d=""+(m-e*l),l===0&&u===0)return s+d+g;for(f="",y=6-d.length,p=0;p<y;p++)f+="0";g=f+d+g}{if(v=u%e,u=u/e>>>0,m=4294967296*v+l,l=m/e>>>0,d=""+(m-e*l),l===0&&u===0)return s+d+g;for(f="",y=6-d.length,p=0;p<y;p++)f+="0";g=f+d+g}return v=u%e,m=4294967296*v+l,d=""+m%e,s+d+g}t.exports=o}),gu=J((r,t)=>{X();var e=yu(),o=function(h,x,A,C,E){A=A||0,C=C||!1,E=E||function(W,Q,B){return W*Math.pow(2,B)+Q};var N=A>>3,O=function(W){return C?~W&255:W},_=255,k=8-A%8;x<k&&(_=255<<8-x&255,k=x),A&&(_=_>>A%8);var R=0;A%8+x>=8&&(R=E(0,O(h[N])&_,k));for(var S=x+A>>3,T=N+1;T<S;T++)R=E(R,O(h[T]),8);var L=(x+A)%8;return L>0&&(R=E(R,O(h[S])>>8-L,L)),R},i=function(h,x,A){var C=Math.pow(2,A-1)-1,E=o(h,1),N=o(h,A,1);if(N===0)return 0;var O=1,_=function(R,S,T){R===0&&(R=1);for(var L=1;L<=T;L++)O/=2,(S&1<<T-L)>0&&(R+=O);return R},k=o(h,x,A+1,!1,_);return N==Math.pow(2,A+1)-1?k===0?E===0?1/0:-1/0:NaN:(E===0?1:-1)*Math.pow(2,N-C)*k},u=function(h){return o(h,1)==1?-1*(o(h,15,1,!0)+1):o(h,15,1)},l=function(h){return o(h,1)==1?-1*(o(h,31,1,!0)+1):o(h,31,1)},s=function(h){return i(h,23,8)},g=function(h){return i(h,52,11)},v=function(h){var x=o(h,16,32);if(x==49152)return NaN;for(var A=Math.pow(1e4,o(h,16,16)),C=0,E=[],N=o(h,16),O=0;O<N;O++)C+=o(h,16,64+16*O)*A,A/=1e4;var _=Math.pow(10,o(h,16,48));return(x===0?1:-1)*Math.round(C*_)/_},m=function(h,x){var A=o(x,1),C=o(x,63,1),E=new Date((A===0?1:-1)*C/1e3+9466848e5);return h||E.setTime(E.getTime()+E.getTimezoneOffset()*6e4),E.usec=C%1e3,E.getMicroSeconds=function(){return this.usec},E.setMicroSeconds=function(N){this.usec=N},E.getUTCMicroSeconds=function(){return this.usec},E},d=function(h){for(var x=o(h,32),A=o(h,32,32),C=o(h,32,64),E=96,N=[],O=0;O<x;O++)N[O]=o(h,32,E),E+=32,E+=32;var _=function(R){var S=o(h,32,E);if(E+=32,S==4294967295)return null;var T;if(R==23||R==20)return T=o(h,S*8,E),E+=S*8,T;if(R==25)return T=h.toString(this.encoding,E>>3,(E+=S<<3)>>3),T;console.log("ERROR: ElementType not implemented: "+R)},k=function(R,S){var T=[],L;if(R.length>1){var W=R.shift();for(L=0;L<W;L++)T[L]=k(R,S);R.unshift(W)}else for(L=0;L<R[0];L++)T[L]=_(S);return T};return k(N,C)},f=function(h){return h.toString("utf8")},y=function(h){return h===null?null:o(h,8)>0},p=function(h){h(20,e),h(21,u),h(23,l),h(26,l),h(1700,v),h(700,s),h(701,g),h(16,y),h(1114,m.bind(null,!1)),h(1184,m.bind(null,!0)),h(1e3,d),h(1007,d),h(1016,d),h(1008,d),h(1009,d),h(25,f)};t.exports={init:p}}),vu=J((r,t)=>{X(),t.exports={BOOL:16,BYTEA:17,CHAR:18,INT8:20,INT2:21,INT4:23,REGPROC:24,TEXT:25,OID:26,TID:27,XID:28,CID:29,JSON:114,XML:142,PG_NODE_TREE:194,SMGR:210,PATH:602,POLYGON:604,CIDR:650,FLOAT4:700,FLOAT8:701,ABSTIME:702,RELTIME:703,TINTERVAL:704,CIRCLE:718,MACADDR8:774,MONEY:790,MACADDR:829,INET:869,ACLITEM:1033,BPCHAR:1042,VARCHAR:1043,DATE:1082,TIME:1083,TIMESTAMP:1114,TIMESTAMPTZ:1184,INTERVAL:1186,TIMETZ:1266,BIT:1560,VARBIT:1562,NUMERIC:1700,REFCURSOR:1790,REGPROCEDURE:2202,REGOPER:2203,REGOPERATOR:2204,REGCLASS:2205,REGTYPE:2206,UUID:2950,TXID_SNAPSHOT:2970,PG_LSN:3220,PG_NDISTINCT:3361,PG_DEPENDENCIES:3402,TSVECTOR:3614,TSQUERY:3615,GTSVECTOR:3642,REGCONFIG:3734,REGDICTIONARY:3769,JSONB:3802,REGNAMESPACE:4089,REGROLE:4096}}),Oe=J(r=>{X();var t=du(),e=gu(),o=Qo(),i=vu();r.getTypeParser=s,r.setTypeParser=g,r.arrayParser=o,r.builtins=i;var u={text:{},binary:{}};function l(v){return String(v)}function s(v,m){return m=m||"text",u[m]&&u[m][v]||l}function g(v,m,d){typeof m=="function"&&(d=m,m="text"),u[m][v]=d}t.init(function(v,m){u.text[v]=m}),e.init(function(v,m){u.binary[v]=m})}),Be=J((r,t)=>{"use strict";X(),t.exports={host:"localhost",user:Y.platform==="win32"?Y.env.USERNAME:Y.env.USER,database:void 0,password:null,connectionString:void 0,port:5432,rows:0,binary:!1,max:10,idleTimeoutMillis:3e4,client_encoding:"",ssl:!1,application_name:void 0,fallback_application_name:void 0,options:void 0,parseInputDatesAsUTC:!1,statement_timeout:!1,lock_timeout:!1,idle_in_transaction_session_timeout:!1,query_timeout:!1,connect_timeout:0,keepalives:1,keepalives_idle:0};var e=Oe(),o=e.getTypeParser(20,"text"),i=e.getTypeParser(1016,"text");t.exports.__defineSetter__("parseInt8",function(u){e.setTypeParser(20,"text",u?e.getTypeParser(23,"text"):o),e.setTypeParser(1016,"text",u?e.getTypeParser(1007,"text"):i)})}),Cn=J((r,t)=>{"use strict";X();var e=(jo(),xt(Un)),o=Be();function i(p){var h=p.replace(/\\/g,"\\\\").replace(/"/g,'\\"');return'"'+h+'"'}function u(p){for(var h="{",x=0;x<p.length;x++)x>0&&(h=h+","),p[x]===null||typeof p[x]>"u"?h=h+"NULL":Array.isArray(p[x])?h=h+u(p[x]):p[x]instanceof G?h+="\\\\x"+p[x].toString("hex"):h+=i(l(p[x]));return h=h+"}",h}var l=function(p,h){if(p==null)return null;if(p instanceof G)return p;if(ArrayBuffer.isView(p)){var x=G.from(p.buffer,p.byteOffset,p.byteLength);return x.length===p.byteLength?x:x.slice(p.byteOffset,p.byteOffset+p.byteLength)}return p instanceof Date?o.parseInputDatesAsUTC?m(p):v(p):Array.isArray(p)?u(p):typeof p=="object"?s(p,h):p.toString()};function s(p,h){if(p&&typeof p.toPostgres=="function"){if(h=h||[],h.indexOf(p)!==-1)throw new Error('circular reference detected while preparing "'+p+'" for query');return h.push(p),l(p.toPostgres(l),h)}return JSON.stringify(p)}function g(p,h){for(p=""+p;p.length<h;)p="0"+p;return p}function v(p){var h=-p.getTimezoneOffset(),x=p.getFullYear(),A=x<1;A&&(x=Math.abs(x)+1);var C=g(x,4)+"-"+g(p.getMonth()+1,2)+"-"+g(p.getDate(),2)+"T"+g(p.getHours(),2)+":"+g(p.getMinutes(),2)+":"+g(p.getSeconds(),2)+"."+g(p.getMilliseconds(),3);return h<0?(C+="-",h*=-1):C+="+",C+=g(Math.floor(h/60),2)+":"+g(h%60,2),A&&(C+=" BC"),C}function m(p){var h=p.getUTCFullYear(),x=h<1;x&&(h=Math.abs(h)+1);var A=g(h,4)+"-"+g(p.getUTCMonth()+1,2)+"-"+g(p.getUTCDate(),2)+"T"+g(p.getUTCHours(),2)+":"+g(p.getUTCMinutes(),2)+":"+g(p.getUTCSeconds(),2)+"."+g(p.getUTCMilliseconds(),3);return A+="+00:00",x&&(A+=" BC"),A}function d(p,h,x){return p=typeof p=="string"?{text:p}:p,h&&(typeof h=="function"?p.callback=h:p.values=h),x&&(p.callback=x),p}var f=function(p){return e.createHash("md5").update(p,"utf-8").digest("hex")},y=function(p,h,x){var A=f(h+p),C=f(G.concat([G.from(A),x]));return"md5"+C};t.exports={prepareValue:function(p){return l(p)},normalizeQueryConfig:d,postgresMd5PasswordHash:y,md5:f}}),xu=J((r,t)=>{"use strict";X();var e=(jo(),xt(Un));function o(p){if(p.indexOf("SCRAM-SHA-256")===-1)throw new Error("SASL: Only mechanism SCRAM-SHA-256 is currently supported");let h=e.randomBytes(18).toString("base64");return{mechanism:"SCRAM-SHA-256",clientNonce:h,response:"n,,n=*,r="+h,message:"SASLInitialResponse"}}function i(p,h,x){if(p.message!=="SASLInitialResponse")throw new Error("SASL: Last message was not SASLInitialResponse");if(typeof h!="string")throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: client password must be a string");if(h==="")throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: client password must be a non-empty string");if(typeof x!="string")throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: serverData must be a string");let A=v(x);if(A.nonce.startsWith(p.clientNonce)){if(A.nonce.length===p.clientNonce.length)throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce is too short")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce does not start with client nonce");var C=G.from(A.salt,"base64"),E=e.pbkdf2Sync(h,C,A.iteration,32,"sha256"),N=y(E,"Client Key"),O=f(N),_="n=*,r="+p.clientNonce,k="r="+A.nonce+",s="+A.salt+",i="+A.iteration,R="c=biws,r="+A.nonce,S=_+","+k+","+R,T=y(O,S),L=d(N,T),W=L.toString("base64"),Q=y(E,"Server Key"),B=y(Q,S);p.message="SASLResponse",p.serverSignature=B.toString("base64"),p.response=R+",p="+W}function u(p,h){if(p.message!=="SASLResponse")throw new Error("SASL: Last message was not SASLResponse");if(typeof h!="string")throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: serverData must be a string");let{serverSignature:x}=m(h);if(x!==p.serverSignature)throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature does not match")}function l(p){if(typeof p!="string")throw new TypeError("SASL: text must be a string");return p.split("").map((h,x)=>p.charCodeAt(x)).every(h=>h>=33&&h<=43||h>=45&&h<=126)}function s(p){return/^(?:[a-zA-Z0-9+/]{4})*(?:[a-zA-Z0-9+/]{2}==|[a-zA-Z0-9+/]{3}=)?$/.test(p)}function g(p){if(typeof p!="string")throw new TypeError("SASL: attribute pairs text must be a string");return new Map(p.split(",").map(h=>{if(!/^.=/.test(h))throw new Error("SASL: Invalid attribute pair entry");let x=h[0],A=h.substring(2);return[x,A]}))}function v(p){let h=g(p),x=h.get("r");if(x){if(!l(x))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce must only contain printable characters")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce missing");let A=h.get("s");if(A){if(!s(A))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt must be base64")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt missing");let C=h.get("i");if(C){if(!/^[1-9][0-9]*$/.test(C))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: invalid iteration count")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: iteration missing");let E=parseInt(C,10);return{nonce:x,salt:A,iteration:E}}function m(p){let h=g(p).get("v");if(h){if(!s(h))throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature must be base64")}else throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature is missing");return{serverSignature:h}}function d(p,h){if(!G.isBuffer(p))throw new TypeError("first argument must be a Buffer");if(!G.isBuffer(h))throw new TypeError("second argument must be a Buffer");if(p.length!==h.length)throw new Error("Buffer lengths must match");if(p.length===0)throw new Error("Buffers cannot be empty");return G.from(p.map((x,A)=>p[A]^h[A]))}function f(p){return e.createHash("sha256").update(p).digest()}function y(p,h){return e.createHmac("sha256",p).update(h).digest()}t.exports={startSession:o,continueSession:i,finalizeSession:u}}),Ln={};Nt(Ln,{join:()=>_u});function _u(...r){return r.join("/")}var Ko=Ct(()=>{X()}),kn={};Nt(kn,{stat:()=>wu});function wu(r,t){t(new Error("No filesystem"))}var Ho=Ct(()=>{X()}),Pn={};Nt(Pn,{default:()=>Xo});var Xo,Vo=Ct(()=>{X(),Xo={}}),zo={};Nt(zo,{StringDecoder:()=>Go});var Go,Su=Ct(()=>{X(),Go=class{constructor(r){this.td=new TextDecoder(r)}write(r){return this.td.decode(r,{stream:!0})}end(r){return this.td.decode(r)}}}),Au=J((r,t)=>{"use strict";X();var{Transform:e}=(Vo(),xt(Pn)),{StringDecoder:o}=(Su(),xt(zo)),i=Symbol("last"),u=Symbol("decoder");function l(d,f,y){let p;if(this.overflow){if(p=this[u].write(d).split(this.matcher),p.length===1)return y();p.shift(),this.overflow=!1}else this[i]+=this[u].write(d),p=this[i].split(this.matcher);this[i]=p.pop();for(let h=0;h<p.length;h++)try{g(this,this.mapper(p[h]))}catch(x){return y(x)}if(this.overflow=this[i].length>this.maxLength,this.overflow&&!this.skipOverflow){y(new Error("maximum buffer reached"));return}y()}function s(d){if(this[i]+=this[u].end(),this[i])try{g(this,this.mapper(this[i]))}catch(f){return d(f)}d()}function g(d,f){f!==void 0&&d.push(f)}function v(d){return d}function m(d,f,y){switch(d=d||/\r?\n/,f=f||v,y=y||{},arguments.length){case 1:typeof d=="function"?(f=d,d=/\r?\n/):typeof d=="object"&&!(d instanceof RegExp)&&(y=d,d=/\r?\n/);break;case 2:typeof d=="function"?(y=f,f=d,d=/\r?\n/):typeof f=="object"&&(y=f,f=v)}y=Object.assign({},y),y.autoDestroy=!0,y.transform=l,y.flush=s,y.readableObjectMode=!0;let p=new e(y);return p[i]="",p[u]=new o("utf8"),p.matcher=d,p.mapper=f,p.maxLength=y.maxLength,p.skipOverflow=y.skipOverflow||!1,p.overflow=!1,p._destroy=function(h,x){this._writableState.errorEmitted=!1,x(h)},p}t.exports=m}),Ne={};Nt(Ne,{default:()=>Jo});var Jo,Tn=Ct(()=>{X(),Jo={}}),bu=J((r,t)=>{"use strict";X();var e=(Ko(),xt(Ln)),o=(Vo(),xt(Pn)).Stream,i=Au(),u=(Tn(),xt(Ne)),l=5432,s=Y.platform==="win32",g=Y.stderr,v=56,m=7,d=61440,f=32768;function y(O){return(O&d)==f}var p=["host","port","database","user","password"],h=p.length,x=p[h-1];function A(){var O=g instanceof o&&g.writable===!0;if(O){var _=Array.prototype.slice.call(arguments).concat(`
`);g.write(u.format.apply(u,_))}}Object.defineProperty(t.exports,"isWin",{get:function(){return s},set:function(O){s=O}}),t.exports.warnTo=function(O){var _=g;return g=O,_},t.exports.getFileName=function(O){var _=O||Y.env,k=_.PGPASSFILE||(s?e.join(_.APPDATA||"./","postgresql","pgpass.conf"):e.join(_.HOME||"./",".pgpass"));return k},t.exports.usePgPass=function(O,_){return Object.prototype.hasOwnProperty.call(Y.env,"PGPASSWORD")?!1:s?!0:(_=_||"<unkn>",y(O.mode)?O.mode&(v|m)?(A('WARNING: password file "%s" has group or world access; permissions should be u=rw (0600) or less',_),!1):!0:(A('WARNING: password file "%s" is not a plain file',_),!1))};var C=t.exports.match=function(O,_){return p.slice(0,-1).reduce(function(k,R,S){return S==1&&Number(O[R]||l)===Number(_[R])?k&&!0:k&&(_[R]==="*"||_[R]===O[R])},!0)};t.exports.getPassword=function(O,_,k){var R,S=_.pipe(i());function T(Q){var B=E(Q);B&&N(B)&&C(O,B)&&(R=B[x],S.end())}var L=function(){_.destroy(),k(R)},W=function(Q){_.destroy(),A("WARNING: error on reading file: %s",Q),k(void 0)};_.on("error",W),S.on("data",T).on("end",L).on("error",W)};var E=t.exports.parseLine=function(O){if(O.length<11||O.match(/^\s+#/))return null;for(var _="",k="",R=0,S=0,T=0,L={},W=!1,Q=function(z,V,j){var $=O.substring(V,j);Object.hasOwnProperty.call(Y.env,"PGPASS_NO_DEESCAPE")||($=$.replace(/\\([:\\])/g,"$1")),L[p[z]]=$},B=0;B<O.length-1;B+=1){if(_=O.charAt(B+1),k=O.charAt(B),W=R==h-1,W){Q(R,S);break}B>=0&&_==":"&&k!=="\\"&&(Q(R,S,B+1),S=B+2,R+=1)}return L=Object.keys(L).length===h?L:null,L},N=t.exports.isValidEntry=function(O){for(var _={0:function(L){return L.length>0},1:function(L){return L==="*"?!0:(L=Number(L),isFinite(L)&&L>0&&L<9007199254740992&&Math.floor(L)===L)},2:function(L){return L.length>0},3:function(L){return L.length>0},4:function(L){return L.length>0}},k=0;k<p.length;k+=1){var R=_[k],S=O[p[k]]||"",T=R(S);if(!T)return!1}return!0}}),Eu=J((r,t)=>{"use strict";X();var e=(Ko(),xt(Ln)),o=(Ho(),xt(kn)),i=bu();t.exports=function(u,l){var s=i.getFileName();o.stat(s,function(g,v){if(g||!i.usePgPass(v,s))return l(void 0);var m=o.createReadStream(s);i.getPassword(u,m,l)})},t.exports.warnTo=i.warnTo}),Yo=J((r,t)=>{"use strict";X();var e=Oe();function o(i){this._types=i||e,this.text={},this.binary={}}o.prototype.getOverrides=function(i){switch(i){case"text":return this.text;case"binary":return this.binary;default:return{}}},o.prototype.setTypeParser=function(i,u,l){typeof u=="function"&&(l=u,u="text"),this.getOverrides(u)[i]=l},o.prototype.getTypeParser=function(i,u){return u=u||"text",this.getOverrides(u)[i]||this._types.getTypeParser(i,u)},t.exports=o}),$o={};Nt($o,{default:()=>Zo});var Zo,Iu=Ct(()=>{X(),Zo={}}),ti={};Nt(ti,{parse:()=>Ru});function Ru(r,t=!1){let{protocol:e}=new URL(r),o="http:"+r.substring(e.length),{username:i,password:u,hostname:l,port:s,pathname:g,search:v,searchParams:m,hash:d}=new URL(o);u=decodeURIComponent(u);let f=i+":"+u,y=t?Object.fromEntries(m.entries()):v;return{href:r,protocol:e,auth:f,username:i,password:u,hostname:l,port:s,pathname:g,search:v,query:y,hash:d}}var Uu=Ct(()=>{X()}),Cu=J((r,t)=>{"use strict";X();var e=(Uu(),xt(ti)),o=(Ho(),xt(kn));function i(u){if(u.charAt(0)==="/"){var s=u.split(" ");return{host:s[0],database:s[1]}}var l=e.parse(/ |%[^a-f0-9]|%[a-f0-9][^a-f0-9]/i.test(u)?encodeURI(u).replace(/\%25(\d\d)/g,"%$1"):u,!0),s=l.query;for(var g in s)Array.isArray(s[g])&&(s[g]=s[g][s[g].length-1]);var v=(l.auth||":").split(":");if(s.user=v[0],s.password=v.splice(1).join(":"),s.port=l.port,l.protocol=="socket:")return s.host=decodeURI(l.pathname),s.database=l.query.db,s.client_encoding=l.query.encoding,s;s.host||(s.host=l.hostname);var m=l.pathname;if(!s.host&&m&&/^%2f/i.test(m)){var d=m.split("/");s.host=decodeURIComponent(d[0]),m=d.splice(1).join("/")}switch(m&&m.charAt(0)==="/"&&(m=m.slice(1)||null),s.database=m&&decodeURI(m),(s.ssl==="true"||s.ssl==="1")&&(s.ssl=!0),s.ssl==="0"&&(s.ssl=!1),(s.sslcert||s.sslkey||s.sslrootcert||s.sslmode)&&(s.ssl={}),s.sslcert&&(s.ssl.cert=o.readFileSync(s.sslcert).toString()),s.sslkey&&(s.ssl.key=o.readFileSync(s.sslkey).toString()),s.sslrootcert&&(s.ssl.ca=o.readFileSync(s.sslrootcert).toString()),s.sslmode){case"disable":{s.ssl=!1;break}case"prefer":case"require":case"verify-ca":case"verify-full":break;case"no-verify":{s.ssl.rejectUnauthorized=!1;break}}return s}t.exports=i,i.parse=i}),ri=J((r,t)=>{"use strict";X();var e=(Iu(),xt($o)),o=Be(),i=Cu().parse,u=function(m,d,f){return f===void 0?f=Y.env["PG"+m.toUpperCase()]:f===!1||(f=Y.env[f]),d[m]||f||o[m]},l=function(){switch(Y.env.PGSSLMODE){case"disable":return!1;case"prefer":case"require":case"verify-ca":case"verify-full":return!0;case"no-verify":return{rejectUnauthorized:!1}}return o.ssl},s=function(m){return"'"+(""+m).replace(/\\/g,"\\\\").replace(/'/g,"\\'")+"'"},g=function(m,d,f){var y=d[f];y!=null&&m.push(f+"="+s(y))},v=class{constructor(m){m=typeof m=="string"?i(m):m||{},m.connectionString&&(m=Object.assign({},m,i(m.connectionString))),this.user=u("user",m),this.database=u("database",m),this.database===void 0&&(this.database=this.user),this.port=parseInt(u("port",m),10),this.host=u("host",m),Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:u("password",m)}),this.binary=u("binary",m),this.options=u("options",m),this.ssl=typeof m.ssl>"u"?l():m.ssl,typeof this.ssl=="string"&&this.ssl==="true"&&(this.ssl=!0),this.ssl==="no-verify"&&(this.ssl={rejectUnauthorized:!1}),this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this.client_encoding=u("client_encoding",m),this.replication=u("replication",m),this.isDomainSocket=!(this.host||"").indexOf("/"),this.application_name=u("application_name",m,"PGAPPNAME"),this.fallback_application_name=u("fallback_application_name",m,!1),this.statement_timeout=u("statement_timeout",m,!1),this.lock_timeout=u("lock_timeout",m,!1),this.idle_in_transaction_session_timeout=u("idle_in_transaction_session_timeout",m,!1),this.query_timeout=u("query_timeout",m,!1),m.connectionTimeoutMillis===void 0?this.connect_timeout=Y.env.PGCONNECT_TIMEOUT||0:this.connect_timeout=Math.floor(m.connectionTimeoutMillis/1e3),m.keepAlive===!1?this.keepalives=0:m.keepAlive===!0&&(this.keepalives=1),typeof m.keepAliveInitialDelayMillis=="number"&&(this.keepalives_idle=Math.floor(m.keepAliveInitialDelayMillis/1e3))}getLibpqConnectionString(m){var d=[];g(d,this,"user"),g(d,this,"password"),g(d,this,"port"),g(d,this,"application_name"),g(d,this,"fallback_application_name"),g(d,this,"connect_timeout"),g(d,this,"options");var f=typeof this.ssl=="object"?this.ssl:this.ssl?{sslmode:this.ssl}:{};if(g(d,f,"sslmode"),g(d,f,"sslca"),g(d,f,"sslkey"),g(d,f,"sslcert"),g(d,f,"sslrootcert"),this.database&&d.push("dbname="+s(this.database)),this.replication&&d.push("replication="+s(this.replication)),this.host&&d.push("host="+s(this.host)),this.isDomainSocket)return m(null,d.join(" "));this.client_encoding&&d.push("client_encoding="+s(this.client_encoding)),e.lookup(this.host,function(y,p){return y?m(y,null):(d.push("hostaddr="+s(p)),m(null,d.join(" ")))})}};t.exports=v}),Lu=J((r,t)=>{"use strict";X();var e=Oe(),o=/^([A-Za-z]+)(?: (\d+))?(?: (\d+))?/,i=class{constructor(u,l){this.command=null,this.rowCount=null,this.oid=null,this.rows=[],this.fields=[],this._parsers=void 0,this._types=l,this.RowCtor=null,this.rowAsArray=u==="array",this.rowAsArray&&(this.parseRow=this._parseRowAsArray)}addCommandComplete(u){var l;u.text?l=o.exec(u.text):l=o.exec(u.command),l&&(this.command=l[1],l[3]?(this.oid=parseInt(l[2],10),this.rowCount=parseInt(l[3],10)):l[2]&&(this.rowCount=parseInt(l[2],10)))}_parseRowAsArray(u){for(var l=new Array(u.length),s=0,g=u.length;s<g;s++){var v=u[s];v!==null?l[s]=this._parsers[s](v):l[s]=null}return l}parseRow(u){for(var l={},s=0,g=u.length;s<g;s++){var v=u[s],m=this.fields[s].name;v!==null?l[m]=this._parsers[s](v):l[m]=null}return l}addRow(u){this.rows.push(u)}addFields(u){this.fields=u,this.fields.length&&(this._parsers=new Array(u.length));for(var l=0;l<u.length;l++){var s=u[l];this._types?this._parsers[l]=this._types.getTypeParser(s.dataTypeID,s.format||"text"):this._parsers[l]=e.getTypeParser(s.dataTypeID,s.format||"text")}}};t.exports=i}),ku=J((r,t)=>{"use strict";X();var{EventEmitter:e}=kr(),o=Lu(),i=Cn(),u=class extends e{constructor(l,s,g){super(),l=i.normalizeQueryConfig(l,s,g),this.text=l.text,this.values=l.values,this.rows=l.rows,this.types=l.types,this.name=l.name,this.binary=l.binary,this.portal=l.portal||"",this.callback=l.callback,this._rowMode=l.rowMode,Y.domain&&l.callback&&(this.callback=Y.domain.bind(l.callback)),this._result=new o(this._rowMode,this.types),this._results=this._result,this.isPreparedStatement=!1,this._canceledDueToError=!1,this._promise=null}requiresPreparation(){return this.name||this.rows?!0:!this.text||!this.values?!1:this.values.length>0}_checkForMultirow(){this._result.command&&(Array.isArray(this._results)||(this._results=[this._result]),this._result=new o(this._rowMode,this.types),this._results.push(this._result))}handleRowDescription(l){this._checkForMultirow(),this._result.addFields(l.fields),this._accumulateRows=this.callback||!this.listeners("row").length}handleDataRow(l){let s;if(!this._canceledDueToError){try{s=this._result.parseRow(l.fields)}catch(g){this._canceledDueToError=g;return}this.emit("row",s,this._result),this._accumulateRows&&this._result.addRow(s)}}handleCommandComplete(l,s){this._checkForMultirow(),this._result.addCommandComplete(l),this.rows&&s.sync()}handleEmptyQuery(l){this.rows&&l.sync()}handleError(l,s){if(this._canceledDueToError&&(l=this._canceledDueToError,this._canceledDueToError=!1),this.callback)return this.callback(l);this.emit("error",l)}handleReadyForQuery(l){if(this._canceledDueToError)return this.handleError(this._canceledDueToError,l);if(this.callback)try{this.callback(null,this._results)}catch(s){Y.nextTick(()=>{throw s})}this.emit("end",this._results)}submit(l){if(typeof this.text!="string"&&typeof this.name!="string")return new Error("A query must have either text or a name. Supplying neither is unsupported.");let s=l.parsedStatements[this.name];return this.text&&s&&this.text!==s?new Error(`Prepared statements must be unique - '${this.name}' was used for a different statement`):this.values&&!Array.isArray(this.values)?new Error("Query values must be an array"):(this.requiresPreparation()?this.prepare(l):l.query(this.text),null)}hasBeenParsed(l){return this.name&&l.parsedStatements[this.name]}handlePortalSuspended(l){this._getRows(l,this.rows)}_getRows(l,s){l.execute({portal:this.portal,rows:s}),s?l.flush():l.sync()}prepare(l){this.isPreparedStatement=!0,this.hasBeenParsed(l)||l.parse({text:this.text,name:this.name,types:this.types});try{l.bind({portal:this.portal,statement:this.name,values:this.values,binary:this.binary,valueMapper:i.prepareValue})}catch(s){this.handleError(s,l);return}l.describe({type:"P",name:this.portal||""}),this._getRows(l,this.rows)}handleCopyInResponse(l){l.sendCopyFail("No source stream defined")}handleCopyData(l,s){}};t.exports=u});function Rt(...r){if(r.length===1&&r[0]instanceof Uint8Array)return r[0];let t=r.reduce((i,u)=>i+u.length,0),e=new Uint8Array(t),o=0;for(let i of r)e.set(i,o),o+=i.length;return e}function ne(r,t){let e=r.length;if(e!==t.length)return!1;for(let o=0;o<e;o++)if(r[o]!==t[o])return!1;return!0}function Pu(r,t,e,o=!0){let i=new Ht(1024);i.writeUint8(22,0),i.writeUint16(769,0);let u=i.writeLengthUint16();i.writeUint8(1,0);let l=i.writeLengthUint24();i.writeUint16(771,0),vt.getRandomValues(i.subarray(32));let s=i.writeLengthUint8(0);i.writeBytes(e),s();let g=i.writeLengthUint16(0);i.writeUint16(4865,0),g();let v=i.writeLengthUint8(0);i.writeUint8(0,0),v();let m=i.writeLengthUint16(0);if(o){i.writeUint16(0,0);let _=i.writeLengthUint16(0),k=i.writeLengthUint16(0);i.writeUint8(0,0);let R=i.writeLengthUint16(0);i.writeUTF8String(r),R(),k(),_()}i.writeUint16(11,0);let d=i.writeLengthUint16(0),f=i.writeLengthUint8(0);i.writeUint8(0,0),f(),d(),i.writeUint16(10,0);let y=i.writeLengthUint16(0),p=i.writeLengthUint16(0);i.writeUint16(23,0),p(),y(),i.writeUint16(13,0);let h=i.writeLengthUint16(0),x=i.writeLengthUint16(0);i.writeUint16(1027,0),i.writeUint16(2052,0),x(),h(),i.writeUint16(43,0);let A=i.writeLengthUint16(0),C=i.writeLengthUint8(0);i.writeUint16(772,0),C(),A(),i.writeUint16(51,0);let E=i.writeLengthUint16(0),N=i.writeLengthUint16(0);i.writeUint16(23,0);let O=i.writeLengthUint16(0);return i.writeBytes(new Uint8Array(t)),O(),N(),E(),m(),l(),u(),i}function dr(r,t=""){return[...r].map(e=>e.toString(16).padStart(2,"0")).join(t)}function Tu(r,t){let e,o,[i]=r.expectLength(r.remaining());r.expectUint8(2,0);let[u]=r.expectLengthUint24(0);r.expectUint16(771,0);let l=r.readBytes(32);if(ne(l,[207,33,173,116,229,154,97,17,190,29,140,2,30,101,184,145,194,162,17,22,122,187,140,94,7,158,9,226,200,168,51,156]))throw new Error("Unexpected HelloRetryRequest");r.expectUint8(t.length,0),r.expectBytes(t,0),r.expectUint16(4865,0),r.expectUint8(0,0);let[s,g]=r.expectLengthUint16(0);for(;g()>0;){let v=r.readUint16(0),[m]=r.expectLengthUint16(0);if(v===43)r.expectUint16(772,0),o=!0;else if(v===51)r.expectUint16(23,0),r.expectUint16(65),e=r.readBytes(65);else throw new Error(`Unexpected extension 0x${dr([v])}`);m()}if(s(),u(),i(),o!==!0)throw new Error("No TLS version provided");if(e===void 0)throw new Error("No key provided");return e}async function xn(r,t,e=Fr){let o=await r(5);if(o===void 0)return;if(o.length<5)throw new Error("TLS record header truncated");let i=new Ht(o),u=i.readUint8();if(u<20||u>24)throw new Error(`Illegal TLS record type 0x${u.toString(16)}`);if(t!==void 0&&u!==t)throw new Error(`Unexpected TLS record type 0x${u.toString(16).padStart(2,"0")} (expected 0x${t.toString(16).padStart(2,"0")})`);let l=i.readUint16(0);if([769,770,771].indexOf(l)<0)throw new Error(`Unsupported TLS record version 0x${l.toString(16).padStart(4,"0")}`);let s=i.readUint16(0);if(s>e)throw new Error(`Record too long: ${s} bytes`);let g=await r(s);if(g===void 0||g.length<s)throw new Error("TLS record content truncated");return{headerData:o,header:i,type:u,version:l,length:s,content:g}}async function _n(r,t,e){let o=await xn(r,23,oi);if(o===void 0)return;let i=new Ht(o.content),[u]=i.expectLength(i.remaining());i.skip(o.length-16,0),i.skip(16,0),u();let l=await t.process(o.content,16,o.headerData),s=l.length-1;for(;l[s]===0;)s-=1;if(s<0)throw new Error("Decrypted message has no record type indicator (all zeroes)");let g=l[s],v=l.subarray(0,s);if(!(g===21&&v.length===2&&v[0]===1&&v[1]===0)){if(g===22&&v[0]===4)return _n(r,t,e);if(e!==void 0&&g!==e)throw new Error(`Unexpected TLS record type 0x${g.toString(16).padStart(2,"0")} (expected 0x${e.toString(16).padStart(2,"0")})`);return v}}async function Ou(r,t,e){let o=Rt(r,[e]),i=5,u=o.length+16,l=new Ht(i+u);l.writeUint8(23,0),l.writeUint16(771,0),l.writeUint16(u,`${u} bytes follow`);let[s]=l.expectLength(u),g=l.array(),v=await t.process(o,16,g);return l.writeBytes(v.subarray(0,v.length-16)),l.writeBytes(v.subarray(v.length-16)),s(),l.array()}async function Po(r,t,e){let o=Math.ceil(r.length/Fr),i=[];for(let u=0;u<o;u++){let l=r.subarray(u*Fr,(u+1)*Fr),s=await Ou(l,t,e);i.push(s)}return i}async function wn(r,t,e){let o=await Z.importKey("raw",r,{name:"HMAC",hash:{name:`SHA-${e}`}},!1,["sign"]);var i=new Uint8Array(await Z.sign("HMAC",o,t));return i}async function Bu(r,t,e,o){let i=o>>3,u=Math.ceil(e/i),l=new Uint8Array(u*i),s=await Z.importKey("raw",r,{name:"HMAC",hash:{name:`SHA-${o}`}},!1,["sign"]),g=new Uint8Array(0);for(let v=0;v<u;v++){let m=Rt(g,t,[v+1]),d=await Z.sign("HMAC",s,m),f=new Uint8Array(d);l.set(f,i*v),g=f}return l.subarray(0,e)}async function Ut(r,t,e,o,i){let u=Sn.encode(t),l=Rt([(o&65280)>>8,o&255],[An.length+u.length],An,u,[e.length],e);return Bu(r,l,o,i)}async function Nu(r,t,e,o,i){let u=o>>3,l=new Uint8Array(u),s=await Z.importKey("raw",r,{name:"ECDH",namedCurve:"P-256"},!1,[]),g=await Z.deriveBits({name:"ECDH",public:s},t,256),v=new Uint8Array(g),m=await Z.digest("SHA-256",e),d=new Uint8Array(m),f=await wn(new Uint8Array(1),l,o),y=await Z.digest(`SHA-${o}`,new Uint8Array(0)),p=new Uint8Array(y),h=await Ut(f,"derived",p,u,o),x=await wn(h,v,o),A=await Ut(x,"c hs traffic",d,u,o),C=await Ut(x,"s hs traffic",d,u,o),E=await Ut(A,"key",new Uint8Array(0),i,o),N=await Ut(C,"key",new Uint8Array(0),i,o),O=await Ut(A,"iv",new Uint8Array(0),12,o),_=await Ut(C,"iv",new Uint8Array(0),12,o);return{serverHandshakeKey:N,serverHandshakeIV:_,clientHandshakeKey:E,clientHandshakeIV:O,handshakeSecret:x,clientSecret:A,serverSecret:C}}async function Mu(r,t,e,o){let i=e>>3,u=new Uint8Array(i),l=await Z.digest(`SHA-${e}`,new Uint8Array(0)),s=new Uint8Array(l),g=await Ut(r,"derived",s,i,e),v=await wn(g,u,e),m=await Ut(v,"c ap traffic",t,i,e),d=await Ut(v,"s ap traffic",t,i,e),f=await Ut(m,"key",new Uint8Array(0),o,e),y=await Ut(d,"key",new Uint8Array(0),o,e),p=await Ut(m,"iv",new Uint8Array(0),12,e),h=await Ut(d,"iv",new Uint8Array(0),12,e);return{serverApplicationKey:y,serverApplicationIV:h,clientApplicationKey:f,clientApplicationIV:p}}function Re(r){return r>64&&r<91?r-65:r>96&&r<123?r-71:r>47&&r<58?r+4:r===43?62:r===47?63:r===61?64:void 0}function Du(r){let t=r.length,e=0,o=0,i=64,u=64,l=64,s=64,g=new Uint8Array(t*.75);for(;e<t;)i=Re(r.charCodeAt(e++)),u=Re(r.charCodeAt(e++)),l=Re(r.charCodeAt(e++)),s=Re(r.charCodeAt(e++)),g[o++]=i<<2|u>>4,g[o++]=(u&15)<<4|l>>2,g[o++]=(l&3)<<6|s;let v=u===64?0:l===64?2:s===64?1:0;return g.subarray(0,o-v)}function Wu(r){let{length:t}=r;if(t>4)throw new Error(`Bit string length ${t} would overflow JS bit operators`);let e=0,o=0;for(let i=r.length-1;i>=0;i--)e|=r[i]<<o,o+=8;return e}function To(r,t){let e={};r.expectUint8(bt,0);let[o,i]=r.expectASN1Length(0);for(;i()>0;){r.expectUint8(ii,0);let[u]=r.expectASN1Length(0);r.expectUint8(bt,0);let[l]=r.expectASN1Length(0);r.expectUint8(Lr,0);let s=r.readASN1OID(),g=ui[s]??s,v=r.readUint8();if(v!==ai&&v!==si)throw new Error(`Unexpected item type in certificate ${t}: 0x${dr([v])}`);let[m,d]=r.expectASN1Length(0),f=r.readUTF8String(d());if(m(),l(),u(),e[g]!==void 0)throw new Error(`Duplicate OID ${g} in certificate ${t}`);e[g]=f}return o(),e}function qu(r,t=0){let e=[],[o,i]=r.expectASN1Length(0);for(;i()>0;){let u=r.readUint8(0),[l,s]=r.expectASN1Length(0),g;u===(t|2)?g=r.readUTF8String(s()):g=r.readBytes(s()),e.push({name:g,type:u}),l()}return o(),e}function ju(r){let t={"1.2.840.113549.1.1.1":{name:"RSAES-PKCS1-v1_5"},"1.2.840.113549.1.1.5":{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-1"}},"1.2.840.113549.1.1.11":{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},"1.2.840.113549.1.1.12":{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-384"}},"1.2.840.113549.1.1.13":{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-512"}},"1.2.840.113549.1.1.10":{name:"RSA-PSS"},"1.2.840.113549.1.1.7":{name:"RSA-OAEP"},"1.2.840.10045.2.1":{name:"ECDSA",hash:{name:"SHA-1"}},"1.2.840.10045.4.1":{name:"ECDSA",hash:{name:"SHA-1"}},"1.2.840.10045.4.3.2":{name:"ECDSA",hash:{name:"SHA-256"}},"1.2.840.10045.4.3.3":{name:"ECDSA",hash:{name:"SHA-384"}},"1.2.840.10045.4.3.4":{name:"ECDSA",hash:{name:"SHA-512"}},"1.3.133.16.840.63.0.2":{name:"ECDH",kdf:"SHA-1"},"1.3.132.1.11.1":{name:"ECDH",kdf:"SHA-256"},"1.3.132.1.11.2":{name:"ECDH",kdf:"SHA-384"},"1.3.132.1.11.3":{name:"ECDH",kdf:"SHA-512"},"2.16.840.1.101.3.4.1.2":{name:"AES-CBC",length:128},"2.16.840.1.101.3.4.1.22":{name:"AES-CBC",length:192},"2.16.840.1.101.3.4.1.42":{name:"AES-CBC",length:256},"2.16.840.1.101.3.4.1.6":{name:"AES-GCM",length:128},"2.16.840.1.101.3.4.1.26":{name:"AES-GCM",length:192},"2.16.840.1.101.3.4.1.46":{name:"AES-GCM",length:256},"2.16.840.1.101.3.4.1.4":{name:"AES-CFB",length:128},"2.16.840.1.101.3.4.1.24":{name:"AES-CFB",length:192},"2.16.840.1.101.3.4.1.44":{name:"AES-CFB",length:256},"2.16.840.1.101.3.4.1.5":{name:"AES-KW",length:128},"2.16.840.1.101.3.4.1.25":{name:"AES-KW",length:192},"2.16.840.1.101.3.4.1.45":{name:"AES-KW",length:256},"1.2.840.113549.2.7":{name:"HMAC",hash:{name:"SHA-1"}},"1.2.840.113549.2.9":{name:"HMAC",hash:{name:"SHA-256"}},"1.2.840.113549.2.10":{name:"HMAC",hash:{name:"SHA-384"}},"1.2.840.113549.2.11":{name:"HMAC",hash:{name:"SHA-512"}},"1.2.840.113549.1.9.16.3.5":{name:"DH"},"1.3.14.3.2.26":{name:"SHA-1"},"2.16.840.1.101.3.4.2.1":{name:"SHA-256"},"2.16.840.1.101.3.4.2.2":{name:"SHA-384"},"2.16.840.1.101.3.4.2.3":{name:"SHA-512"},"1.2.840.113549.1.5.12":{name:"PBKDF2"},"1.2.840.10045.3.1.7":{name:"P-256"},"1.3.132.0.34":{name:"P-384"},"1.3.132.0.35":{name:"P-521"}}[r];if(t===void 0)throw new Error(`Unsupported algorithm identifier: ${r}`);return t}function ei(r,t=[]){return Object.values(r).forEach(e=>{typeof e=="string"?t=[...t,e]:t=ei(e,t)}),t}function Fu(r){return ei(r).join(" / ")}async function ni(r,t,e,o,i){r.expectUint8(bt,0);let[u]=r.expectASN1Length(0);r.expectUint8(re,0);let[l,s]=r.expectASN1Length(0),g=r.readBytes(s());l(),r.expectUint8(re,0);let[v,m]=r.expectASN1Length(0),d=r.readBytes(m());v(),u();let f=(x,A)=>x.length>A?x.subarray(x.length-A):x.length<A?Rt(new Uint8Array(A-x.length),x):x,y=o==="P-256"?32:48,p=Rt(f(g,y),f(d,y)),h=await Z.importKey("spki",t,{name:"ECDSA",namedCurve:o},!1,["verify"]);if(await Z.verify({name:"ECDSA",hash:i},h,p,e)!==!0)throw new Error("ECDSA-SECP256R1-SHA256 certificate verify failed")}async function Qu(r,t,e){for(let u of t);let o=t[0];if(o.subjectAltNameMatchingHost(r)===void 0)throw new Error(`No matching subjectAltName for ${r}`);if(!o.isValidAtMoment())throw new Error("End-user certificate is not valid now");if(!o.extKeyUsage?.serverTls)throw new Error("End-user certificate has no TLS server extKeyUsage");let i=!1;for(let u of e);for(let u=0,l=t.length;u<l;u++){let s=t[u],g=s.authorityKeyIdentifier;if(g===void 0)throw new Error("Certificates without an authorityKeyIdentifier are not supported");let v=e.find(f=>f.subjectKeyIdentifier!==void 0&&ne(f.subjectKeyIdentifier,g));if(v===void 0&&(v=t[u+1]),v===void 0)throw new Error("Ran out of certificates before reaching trusted root");let m=v instanceof On;if(v.isValidAtMoment()!==!0)throw new Error("Signing certificate is not valid now");if(v.keyUsage?.usages.has("digitalSignature")!==!0)throw new Error("Signing certificate keyUsage does not include digital signatures");if(v.basicConstraints?.ca!==!0)throw new Error("Signing certificate basicConstraints do not indicate a CA certificate");let{pathLength:d}=v.basicConstraints;if(d!==void 0&&d<u)throw new Error("Exceeded certificate path length");if(s.algorithm==="1.2.840.10045.4.3.2"||s.algorithm==="1.2.840.10045.4.3.3"){let f=s.algorithm==="1.2.840.10045.4.3.2"?"SHA-256":"SHA-384",y=v.publicKey.identifiers,p=y.includes("1.2.840.10045.3.1.7")?"P-256":y.includes("1.3.132.0.34")?"P-384":void 0;if(p===void 0)throw new Error("Unsupported signing key curve");let h=new te(s.signature);await ni(h,v.publicKey.all,s.signedData,p,f)}else if(s.algorithm==="1.2.840.113549.1.1.11"||s.algorithm==="1.2.840.113549.1.1.12"){let f=s.algorithm==="1.2.840.113549.1.1.11"?"SHA-256":"SHA-384",y=await Z.importKey("spki",v.publicKey.all,{name:"RSASSA-PKCS1-v1_5",hash:f},!1,["verify"]);if(await Z.verify({name:"RSASSA-PKCS1-v1_5"},y,s.signature,s.signedData)!==!0)throw new Error("RSASSA_PKCS1-v1_5-SHA256 certificate verify failed")}else throw new Error("Unsupported signing algorithm");if(m){i=!0;break}}return i}async function Ku(r,t,e,o,i){let u=new te(await t());u.expectUint8(8,0);let[l]=u.expectLengthUint24(),[s,g]=u.expectLengthUint16(0);for(;g()>0;){let j=u.readUint16(0);if(j===0)u.expectUint16(0,0);else if(j===10){let[$,ot]=u.expectLengthUint16("groups data");u.skip(ot(),0),$()}else throw new Error(`Unsupported server encrypted extension type 0x${dr([j]).padStart(4,"0")}`)}s(),l(),u.remaining()===0&&u.extend(await t());let v=!1,m=u.readUint8();if(m===13){v=!0;let[j]=u.expectLengthUint24("certificate request data");u.expectUint8(0,0);let[$,ot]=u.expectLengthUint16("certificate request extensions");u.skip(ot(),0),$(),j(),u.remaining()===0&&u.extend(await t()),m=u.readUint8()}if(m!==11)throw new Error(`Unexpected handshake message type 0x${dr([m])}`);let[d]=u.expectLengthUint24(0);u.expectUint8(0,0);let[f,y]=u.expectLengthUint24(0),p=[];for(;y()>0;){let[j]=u.expectLengthUint24(0),$=new bn(u);p.push($),j();let[ot,ir]=u.expectLengthUint16(),pt=u.subarray(ir());ot()}if(f(),d(),p.length===0)throw new Error("No certificates supplied");let h=p[0],x=u.data.subarray(0,u.offset),A=Rt(o,x),C=await Z.digest("SHA-256",A),E=new Uint8Array(C),N=Rt(fi.encode(" ".repeat(64)+"TLS 1.3, server CertificateVerify"),[0],E);u.remaining()===0&&u.extend(await t()),u.expectUint8(15,0);let[O]=u.expectLengthUint24(0),_=u.readUint16();if(_===1027){let[j]=u.expectLengthUint16();await ni(u,h.publicKey.all,N,"P-256","SHA-256"),j()}else if(_===2052){let[j,$]=u.expectLengthUint16(),ot=u.subarray($());j();let ir=await Z.importKey("spki",h.publicKey.all,{name:"RSA-PSS",hash:"SHA-256"},!1,["verify"]);if(await Z.verify({name:"RSA-PSS",saltLength:32},ir,ot,N)!==!0)throw new Error("RSA-PSS-RSAE-SHA256 certificate verify failed")}else throw new Error(`Unsupported certificate verify signature type 0x${dr([_]).padStart(4,"0")}`);O();let k=u.data.subarray(0,u.offset),R=Rt(o,k),S=await Ut(e,"finished",new Uint8Array(0),32,256),T=await Z.digest("SHA-256",R),L=await Z.importKey("raw",S,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),W=await Z.sign("HMAC",L,T),Q=new Uint8Array(W);u.remaining()===0&&u.extend(await t()),u.expectUint8(20,0);let[B,z]=u.expectLengthUint24(0),V=u.readBytes(z());if(B(),u.remaining()!==0)throw new Error("Unexpected extra bytes in server handshake");if(ne(V,Q)!==!0)throw new Error("Invalid server verify hash");if(!await Qu(r,p,i))throw new Error("Validated certificate chain did not end in a trusted root");return[u.data,v]}async function Hu(r,t,e,o,i=!0,u,l,s){let g=await Z.generateKey({name:"ECDH",namedCurve:"P-256"},!0,["deriveKey","deriveBits"]),v=await Z.exportKey("raw",g.publicKey),m=new Uint8Array(32);vt.getRandomValues(m);let d=Pu(r,v,m,i).array(),f=u?Rt(u,d):d;if(o(f),l){let ht=await e(l.length);if(!ht||!ne(ht,l))throw new Error("Pre data did not match expectation")}let y=await xn(e,22);if(y===void 0)throw new Error("Connection closed while awaiting server hello");let p=new Ht(y.content),h=Tu(p,m),x=await xn(e,20);if(x===void 0)throw new Error("Connection closed awaiting server cipher change");let A=new Ht(x.content),[C]=A.expectLength(1);A.expectUint8(1,0),C();let E=d.subarray(5),N=y.content,O=Rt(E,N),_=await Nu(h,g.privateKey,O,256,16),k=await Z.importKey("raw",_.serverHandshakeKey,{name:"AES-GCM"},!1,["decrypt"]),R=new Zr("decrypt",k,_.serverHandshakeIV),S=await Z.importKey("raw",_.clientHandshakeKey,{name:"AES-GCM"},!1,["encrypt"]),T=new Zr("encrypt",S,_.clientHandshakeIV),L=async()=>{let ht=await _n(e,R,22);if(ht===void 0)throw new Error("Premature end of encrypted server handshake");return ht},[W,Q]=await Ku(r,L,_.serverSecret,O,t),B=new Ht(6);B.writeUint8(20,0),B.writeUint16(771,0);let z=B.writeLengthUint16();B.writeUint8(1,0),z();let V=B.array(),j=new Uint8Array(0);if(Q){let ht=new Ht(8);ht.writeUint8(11,0);let Xt=ht.writeLengthUint24("client certificate data");ht.writeUint8(0,0),ht.writeUint24(0,0),Xt(),j=ht.array()}let $=Rt(O,W,j),ot=await Z.digest("SHA-256",$),ir=new Uint8Array(ot),pt=await Ut(_.clientSecret,"finished",new Uint8Array(0),32,256),It=await Z.importKey("raw",pt,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),me=await Z.sign("HMAC",It,ir),he=new Uint8Array(me),Ar=new Ht(36);Ar.writeUint8(20,0);let de=Ar.writeLengthUint24(0);Ar.writeBytes(he),de();let ye=Ar.array(),$t=await Po(Rt(j,ye),T,22),Br=ir;if(j.length>0){let ht=$.subarray(0,$.length-j.length),Xt=await Z.digest("SHA-256",ht);Br=new Uint8Array(Xt)}let br=await Mu(_.handshakeSecret,Br,256,16),Je=await Z.importKey("raw",br.clientApplicationKey,{name:"AES-GCM"},!1,["encrypt"]),ge=new Zr("encrypt",Je,br.clientApplicationIV),ar=await Z.importKey("raw",br.serverApplicationKey,{name:"AES-GCM"},!1,["decrypt"]),Er=new Zr("decrypt",ar,br.serverApplicationIV),Nr=!1;return[()=>{if(!Nr){let ht=Rt(V,...$t);o(ht),Nr=!0}return _n(e,Er)},async ht=>{let Xt=await Po(ht,ge,23),Ye=Nr?Rt(...Xt):Rt(V,...$t,...Xt);o(Ye),Nr=!0}]}var Ue,gn,Oo,Ht,Xu,Fr,oi,Z,Sn,An,Bo,Zr,te,Ce,re,bt,ii,Lr,ai,si,vn,Le,hr,ke,No,qr,ui,Mo,bn,On,fi,pi,Vu=Ct(()=>{X(),Ue="\xB7\xB7 ",gn=new TextEncoder,Oo=new TextDecoder,Ht=class{constructor(r){F(this,"offset"),F(this,"dataView"),F(this,"data"),F(this,"comments"),F(this,"indents"),F(this,"indent"),this.offset=0,this.data=typeof r=="number"?new Uint8Array(r):r,this.dataView=new DataView(this.data.buffer,this.data.byteOffset,this.data.byteLength),this.comments={},this.indents={},this.indent=0}extend(r){let t=typeof r=="number"?new Uint8Array(r):r;this.data=Rt(this.data,t),this.dataView=new DataView(this.data.buffer,this.data.byteOffset,this.data.byteLength)}remaining(){return this.data.length-this.offset}subarray(r){return this.data.subarray(this.offset,this.offset+=r)}skip(r,t){return this.offset+=r,t&&this.comment(t),this}comment(r,t=this.offset){throw new Error("No comments should be emitted outside of chatty mode")}readBytes(r){return this.data.slice(this.offset,this.offset+=r)}readUTF8String(r){let t=this.subarray(r);return Oo.decode(t)}readUTF8StringNullTerminated(){let r=this.offset;for(;this.data[r]!==0;)r++;let t=this.readUTF8String(r-this.offset);return this.expectUint8(0,"end of string"),t}readUint8(r){let t=this.dataView.getUint8(this.offset);return this.offset+=1,t}readUint16(r){let t=this.dataView.getUint16(this.offset);return this.offset+=2,t}readUint24(r){let t=this.readUint8(),e=this.readUint16();return(t<<16)+e}readUint32(r){let t=this.dataView.getUint32(this.offset);return this.offset+=4,t}expectBytes(r,t){let e=this.readBytes(r.length);if(!ne(e,r))throw new Error("Unexpected bytes")}expectUint8(r,t){let e=this.readUint8();if(e!==r)throw new Error(`Expected ${r}, got ${e}`)}expectUint16(r,t){let e=this.readUint16();if(e!==r)throw new Error(`Expected ${r}, got ${e}`)}expectUint24(r,t){let e=this.readUint24();if(e!==r)throw new Error(`Expected ${r}, got ${e}`)}expectUint32(r,t){let e=this.readUint32();if(e!==r)throw new Error(`Expected ${r}, got ${e}`)}expectLength(r,t=1){let e=this.offset,o=e+r;if(o>this.data.length)throw new Error("Expected length exceeds remaining data length");return this.indent+=t,this.indents[e]=this.indent,[()=>{if(this.indent-=t,this.indents[this.offset]=this.indent,this.offset!==o)throw new Error(`${r} bytes expected but ${this.offset-e} read`)},()=>o-this.offset]}expectLengthUint8(r){let t=this.readUint8();return this.expectLength(t)}expectLengthUint16(r){let t=this.readUint16();return this.expectLength(t)}expectLengthUint24(r){let t=this.readUint24();return this.expectLength(t)}expectLengthUint32(r){let t=this.readUint32();return this.expectLength(t)}expectLengthUint8Incl(r){let t=this.readUint8();return this.expectLength(t-1)}expectLengthUint16Incl(r){let t=this.readUint16();return this.expectLength(t-2)}expectLengthUint24Incl(r){let t=this.readUint24();return this.expectLength(t-3)}expectLengthUint32Incl(r){let t=this.readUint32();return this.expectLength(t-4)}writeBytes(r){return this.data.set(r,this.offset),this.offset+=r.length,this}writeUTF8String(r){let t=gn.encode(r);return this.writeBytes(t),this}writeUTF8StringNullTerminated(r){let t=gn.encode(r);return this.writeBytes(t),this.writeUint8(0),this}writeUint8(r,t){return this.dataView.setUint8(this.offset,r),this.offset+=1,this}writeUint16(r,t){return this.dataView.setUint16(this.offset,r),this.offset+=2,this}writeUint24(r,t){return this.writeUint8((r&16711680)>>16),this.writeUint16(r&65535,t),this}writeUint32(r,t){return this.dataView.setUint32(this.offset,r),this.offset+=4,this}_writeLengthGeneric(r,t,e){let o=this.offset;this.offset+=r;let i=this.offset;return this.indent+=1,this.indents[i]=this.indent,()=>{let u=this.offset-(t?o:i);if(r===1)this.dataView.setUint8(o,u);else if(r===2)this.dataView.setUint16(o,u);else if(r===3)this.dataView.setUint8(o,(u&16711680)>>16),this.dataView.setUint16(o+1,u&65535);else if(r===4)this.dataView.setUint32(o,u);else throw new Error(`Invalid length for length field: ${r}`);this.indent-=1,this.indents[this.offset]=this.indent}}writeLengthUint8(r){return this._writeLengthGeneric(1,!1,r)}writeLengthUint16(r){return this._writeLengthGeneric(2,!1,r)}writeLengthUint24(r){return this._writeLengthGeneric(3,!1,r)}writeLengthUint32(r){return this._writeLengthGeneric(4,!1,r)}writeLengthUint8Incl(r){return this._writeLengthGeneric(1,!0,r)}writeLengthUint16Incl(r){return this._writeLengthGeneric(2,!0,r)}writeLengthUint24Incl(r){return this._writeLengthGeneric(3,!0,r)}writeLengthUint32Incl(r){return this._writeLengthGeneric(4,!0,r)}array(){return this.data.subarray(0,this.offset)}commentedString(r=!1){let t=this.indents[0]!==void 0?Ue.repeat(this.indents[0]):"",e=this.indents[0]??0,o=r?this.data.length:this.offset;for(let i=0;i<o;i++){t+=this.data[i].toString(16).padStart(2,"0")+" ";let u=this.comments[i+1];this.indents[i+1]!==void 0&&(e=this.indents[i+1]),u&&(t+=` ${u}
${Ue.repeat(e)}`)}return t}},Xu=new RegExp(`  .+|^(${Ue})+`,"gm"),Fr=1<<14,oi=Fr+1+255,Z=vt.subtle,Sn=new TextEncoder,An=Sn.encode("tls13 "),Bo=1<<30,Zr=class{constructor(r,t,e){F(this,"mode"),F(this,"key"),F(this,"initialIv"),F(this,"ivLength"),F(this,"currentIv"),F(this,"currentIvDataView"),F(this,"initialIvLast32"),F(this,"recordsDecrypted",0),this.mode=r,this.key=t,this.initialIv=e,this.ivLength=e.length,this.currentIv=e.slice(),this.currentIvDataView=new DataView(this.currentIv.buffer,this.currentIv.byteOffset,this.currentIv.byteLength),this.initialIvLast32=this.currentIvDataView.getUint32(this.ivLength-4)}async process(r,t,e){if(this.recordsDecrypted===Bo)throw new Error("Cannot encrypt/decrypt any more records");let o=this.initialIvLast32^this.recordsDecrypted;this.currentIvDataView.setUint32(this.ivLength-4,o),this.recordsDecrypted+=1;let i=t<<3,u={name:"AES-GCM",iv:this.currentIv,tagLength:i,additionalData:e},l=await Z[this.mode](u,this.key,r);return new Uint8Array(l)}},te=class extends Ht{readASN1Length(r){let t=this.readUint8();if(t<128)return t;let e=t&127,o=0;if(e===1)return this.readUint8(o);if(e===2)return this.readUint16(o);if(e===3)return this.readUint24(o);if(e===4)return this.readUint32(o);throw new Error(`ASN.1 length fields are only supported up to 4 bytes (this one is ${e} bytes)`)}expectASN1Length(r){let t=this.readASN1Length(r);return this.expectLength(t)}readASN1OID(){let[r,t]=this.expectASN1Length(0),e=this.readUint8(),o=`${Math.floor(e/40)}.${e%40}`;for(;t()>0;){let i=0;for(;;){let u=this.readUint8();if(i<<=7,i+=u&127,u<128)break}o+=`.${i}`}return r(),o}readASN1Boolean(){let[r,t]=this.expectASN1Length(0),e=t();if(e!==1)throw new Error(`Boolean has weird length: ${e}`);let o=this.readUint8(),i;if(o===255)i=!0;else if(o===0)i=!1;else throw new Error(`Boolean has weird value: 0x${dr([o])}`);return r(),i}readASN1UTCTime(){let[r,t]=this.expectASN1Length(0),e=this.readUTF8String(t()).match(/^(\d\d)(\d\d)(\d\d)(\d\d)(\d\d)(\d\d)Z$/);if(!e)throw new Error("Unrecognised UTC time format in certificate validity");let[,o,i,u,l,s,g]=e,v=parseInt(o,10),m=v+(v>=50?1900:2e3),d=new Date(`${m}-${i}-${u}T${l}:${s}:${g}Z`);return r(),d}readASN1BitString(){let[r,t]=this.expectASN1Length(0),e=this.readUint8(0),o=t(),i=this.readBytes(o);if(e>7)throw new Error(`Invalid right pad value: ${e}`);if(e>0){let u=8-e;for(let l=o-1;l>0;l--)i[l]=255&i[l-1]<<u|i[l]>>>e;i[0]=i[0]>>>e}return r(),i}},Ce=1,re=2,bt=48,ii=49,Lr=6,ai=19,si=12,vn=23,Le=5,hr=4,ke=3,No=163,qr=128,ui={"2.5.4.6":"C","2.5.4.10":"O","2.5.4.11":"OU","2.5.4.3":"CN","2.5.4.7":"L","2.5.4.8":"ST","2.5.4.12":"T","2.5.4.42":"GN","2.5.4.43":"I","2.5.4.4":"SN","1.2.840.113549.1.9.1":"E-mail"},Mo=["digitalSignature","nonRepudiation","keyEncipherment","dataEncipherment","keyAgreement","keyCertSign","cRLSign","encipherOnly","decipherOnly"],bn=class{constructor(r){F(this,"serialNumber"),F(this,"algorithm"),F(this,"issuer"),F(this,"validityPeriod"),F(this,"subject"),F(this,"publicKey"),F(this,"signature"),F(this,"keyUsage"),F(this,"subjectAltNames"),F(this,"extKeyUsage"),F(this,"authorityKeyIdentifier"),F(this,"subjectKeyIdentifier"),F(this,"basicConstraints"),F(this,"signedData");let t=r instanceof te?r:new te(r);t.expectUint8(bt,0);let[e]=t.expectASN1Length(0),o=t.offset;t.expectUint8(bt,0);let[i]=t.expectASN1Length(0);t.expectBytes([160,3,2,1,2],0),t.expectUint8(re,0);let[u,l]=t.expectASN1Length(0);this.serialNumber=t.subarray(l()),u(),t.expectUint8(bt,0);let[s,g]=t.expectASN1Length(0);t.expectUint8(Lr,0),this.algorithm=t.readASN1OID(),g()>0&&(t.expectUint8(Le,0),t.expectUint8(0,0)),s(),this.issuer=To(t,"issuer"),t.expectUint8(bt,0);let[v]=t.expectASN1Length(0);t.expectUint8(vn,0);let m=t.readASN1UTCTime();t.expectUint8(vn,0);let d=t.readASN1UTCTime();this.validityPeriod={notBefore:m,notAfter:d},v(),this.subject=To(t,"subject");let f=t.offset;t.expectUint8(bt,0);let[y]=t.expectASN1Length(0);t.expectUint8(bt,0);let[p,h]=t.expectASN1Length(0),x=[];for(;h()>0;){let R=t.readUint8();if(R===Lr){let S=t.readASN1OID();x.push(S)}else R===Le&&t.expectUint8(0,0)}p(),t.expectUint8(ke,0);let A=t.readASN1BitString();this.publicKey={identifiers:x,data:A,all:t.data.subarray(f,t.offset)},y(),t.expectUint8(No,0);let[C]=t.expectASN1Length();t.expectUint8(bt,0);let[E,N]=t.expectASN1Length(0);for(;N()>0;){t.expectUint8(bt,0);let[R,S]=t.expectASN1Length();t.expectUint8(Lr,0);let T=t.readASN1OID();if(T==="2.5.29.17"){t.expectUint8(hr,0);let[L]=t.expectASN1Length(0);t.expectUint8(bt,0);let W=qu(t,qr);this.subjectAltNames=W.filter(Q=>Q.type===(2|qr)).map(Q=>Q.name),L()}else if(T==="2.5.29.15"){t.expectUint8(Ce,0);let L=t.readASN1Boolean();t.expectUint8(hr,0);let[W]=t.expectASN1Length(0);t.expectUint8(ke,0);let Q=t.readASN1BitString(),B=Wu(Q),z=new Set(Mo.filter((V,j)=>B&1<<j));W(),this.keyUsage={critical:L,usages:z}}else if(T==="2.5.29.37"){this.extKeyUsage={},t.expectUint8(hr,0);let[L]=t.expectASN1Length(0);t.expectUint8(bt,0);let[W,Q]=t.expectASN1Length(0);for(;Q()>0;){t.expectUint8(Lr,0);let B=t.readASN1OID();B==="1.3.6.1.5.5.7.3.1"&&(this.extKeyUsage.serverTls=!0),B==="1.3.6.1.5.5.7.3.2"&&(this.extKeyUsage.clientTls=!0)}W(),L()}else if(T==="2.5.29.35"){t.expectUint8(hr,0);let[L]=t.expectASN1Length(0);t.expectUint8(bt,0);let[W,Q]=t.expectASN1Length(0);for(;Q()>0;){let B=t.readUint8();if(B===(qr|0)){let[z,V]=t.expectASN1Length(0);this.authorityKeyIdentifier=t.readBytes(V()),z()}else if(B===(qr|1)||B===(qr|2)){let[z,V]=t.expectASN1Length(0);t.skip(V(),0),z()}else throw new Error("Unexpected data type in authorityKeyIdentifier certificate extension")}W(),L()}else if(T==="2.5.29.14"){t.expectUint8(hr,0);let[L]=t.expectASN1Length(0);t.expectUint8(hr,0);let[W,Q]=t.expectASN1Length(0);this.subjectKeyIdentifier=t.readBytes(Q()),W(),L()}else if(T==="2.5.29.19"){let L,W=t.readUint8();if(W===Ce&&(L=t.readASN1Boolean(),W=t.readUint8()),W!==hr)throw new Error("Unexpected type in certificate basic constraints");let[Q]=t.expectASN1Length(0);t.expectUint8(bt,0);let[B,z]=t.expectASN1Length(),V;z()>0&&(t.expectUint8(Ce,0),V=t.readASN1Boolean());let j;if(z()>0){t.expectUint8(re,0);let $=t.readASN1Length(0);if(j=$===1?t.readUint8():$===2?t.readUint16():$===3?t.readUint24():void 0,j===void 0)throw new Error("Too many bytes in max path length in certificate basicConstraints")}B(),Q(),this.basicConstraints={critical:L,ca:V,pathLength:j}}else t.skip(S(),0);R()}E(),C(),i(),this.signedData=t.data.subarray(o,t.offset),t.expectUint8(bt,0);let[O,_]=t.expectASN1Length(0);t.expectUint8(Lr,0);let k=t.readASN1OID();if(_()>0&&(t.expectUint8(Le,0),t.expectUint8(0,0)),O(),k!==this.algorithm)throw new Error(`Certificate specifies different signature algorithms inside (${this.algorithm}) and out (${k})`);t.expectUint8(ke,0),this.signature=t.readASN1BitString(),e()}static fromPEM(r){let t="[A-Z0-9 ]+",e=new RegExp(`-{5}BEGIN ${t}-{5}([a-zA-Z0-9=+\\/\\n\\r]+)-{5}END ${t}-{5}`,"g"),o=[],i=null;for(;i=e.exec(r);){let u=i[1].replace(/[\r\n]/g,""),l=Du(u),s=new this(l);o.push(s)}return o}subjectAltNameMatchingHost(r){let t=/[.][^.]+[.][^.]+$/;return(this.subjectAltNames??[]).find(e=>{let o=e,i=r;if(t.test(r)&&t.test(o)&&o.startsWith("*.")&&(o=o.slice(1),i=i.slice(i.indexOf("."))),o===i)return!0})}isValidAtMoment(r=new Date){return r>=this.validityPeriod.notBefore&&r<=this.validityPeriod.notAfter}description(){return"subject: "+Object.entries(this.subject).map(r=>r.join("=")).join(", ")+(this.subjectAltNames?`
subject alt names: `+this.subjectAltNames.join(", "):"")+(this.subjectKeyIdentifier?`
subject key id: ${dr(this.subjectKeyIdentifier," ")}`:"")+`
issuer: `+Object.entries(this.issuer).map(r=>r.join("=")).join(", ")+(this.authorityKeyIdentifier?`
authority key id: ${dr(this.authorityKeyIdentifier," ")}`:"")+`
validity: `+this.validityPeriod.notBefore.toISOString()+" \u2013 "+this.validityPeriod.notAfter.toISOString()+` (${this.isValidAtMoment()?"currently valid":"not valid"})`+(this.keyUsage?`
key usage (${this.keyUsage.critical?"critical":"non-critical"}): `+[...this.keyUsage.usages].join(", "):"")+(this.extKeyUsage?`
extended key usage: TLS server \u2014\xA0${this.extKeyUsage.serverTls}, TLS client \u2014\xA0${this.extKeyUsage.clientTls}`:"")+(this.basicConstraints?`
basic constraints (${this.basicConstraints.critical?"critical":"non-critical"}): CA \u2014\xA0${this.basicConstraints.ca}, path length \u2014 ${this.basicConstraints.pathLength}`:"")+`
signature algorithm: `+Fu(ju(this.algorithm))}toJSON(){return{serialNumber:[...this.serialNumber],algorithm:this.algorithm,issuer:this.issuer,validityPeriod:{notBefore:this.validityPeriod.notBefore.toISOString(),notAfter:this.validityPeriod.notAfter.toISOString()},subject:this.subject,publicKey:{identifiers:this.publicKey.identifiers,data:[...this.publicKey.data],all:[...this.publicKey.all]},signature:[...this.signature],keyUsage:{critical:this.keyUsage?.critical,usages:[...this.keyUsage?.usages??[]]},subjectAltNames:this.subjectAltNames,extKeyUsage:this.extKeyUsage,authorityKeyIdentifier:this.authorityKeyIdentifier&&[...this.authorityKeyIdentifier],subjectKeyIdentifier:this.subjectKeyIdentifier&&[...this.subjectKeyIdentifier],basicConstraints:this.basicConstraints,signedData:[...this.signedData]}}},On=class extends bn{},fi=new TextEncoder,pi=class{constructor(r){F(this,"queue"),F(this,"outstandingRequest"),this.ws=r,this.queue=[],r.addEventListener("message",t=>this.enqueue(new Uint8Array(t.data))),r.addEventListener("close",()=>this.dequeue())}enqueue(r){this.queue.push(r),this.dequeue()}dequeue(){if(this.outstandingRequest===void 0)return;let{resolve:r,bytes:t}=this.outstandingRequest,e=this.bytesInQueue();if(e<t&&this.ws.readyState<=1)return;if(t=Math.min(t,e),t===0)return r(void 0);this.outstandingRequest=void 0;let o=this.queue[0],i=o.length;if(i===t)return this.queue.shift(),r(o);if(i>t)return this.queue[0]=o.subarray(t),r(o.subarray(0,t));{let u=new Uint8Array(t),l=t,s=0;for(;l>0;){let g=this.queue[0],v=g.length;v<=l?(this.queue.shift(),u.set(g,s),s+=v,l-=v):(this.queue[0]=g.subarray(l),u.set(g.subarray(0,l),s),l-=l,s+=l)}return r(u)}}bytesInQueue(){return this.queue.reduce((r,t)=>r+t.length,0)}async read(r){if(this.outstandingRequest!==void 0)throw new Error("Can\u2019t read while already awaiting read");return new Promise(t=>{this.outstandingRequest={resolve:t,bytes:r},this.dequeue()})}}}),En,zu=Ct(()=>{En=`-----BEGIN CERTIFICATE-----
MIIFazCCA1OgAwIBAgIRAIIQz7DSQONZRGPgu2OCiwAwDQYJKoZIhvcNAQELBQAw
TzELMAkGA1UEBhMCVVMxKTAnBgNVBAoTIEludGVybmV0IFNlY3VyaXR5IFJlc2Vh
cmNoIEdyb3VwMRUwEwYDVQQDEwxJU1JHIFJvb3QgWDEwHhcNMTUwNjA0MTEwNDM4
WhcNMzUwNjA0MTEwNDM4WjBPMQswCQYDVQQGEwJVUzEpMCcGA1UEChMgSW50ZXJu
ZXQgU2VjdXJpdHkgUmVzZWFyY2ggR3JvdXAxFTATBgNVBAMTDElTUkcgUm9vdCBY
MTCCAiIwDQYJKoZIhvcNAQEBBQADggIPADCCAgoCggIBAK3oJHP0FDfzm54rVygc
h77ct984kIxuPOZXoHj3dcKi/vVqbvYATyjb3miGbESTtrFj/RQSa78f0uoxmyF+
0TM8ukj13Xnfs7j/EvEhmkvBioZxaUpmZmyPfjxwv60pIgbz5MDmgK7iS4+3mX6U
A5/TR5d8mUgjU+g4rk8Kb4Mu0UlXjIB0ttov0DiNewNwIRt18jA8+o+u3dpjq+sW
T8KOEUt+zwvo/7V3LvSye0rgTBIlDHCNAymg4VMk7BPZ7hm/ELNKjD+Jo2FR3qyH
B5T0Y3HsLuJvW5iB4YlcNHlsdu87kGJ55tukmi8mxdAQ4Q7e2RCOFvu396j3x+UC
B5iPNgiV5+I3lg02dZ77DnKxHZu8A/lJBdiB3QW0KtZB6awBdpUKD9jf1b0SHzUv
KBds0pjBqAlkd25HN7rOrFleaJ1/ctaJxQZBKT5ZPt0m9STJEadao0xAH0ahmbWn
OlFuhjuefXKnEgV4We0+UXgVCwOPjdAvBbI+e0ocS3MFEvzG6uBQE3xDk3SzynTn
jh8BCNAw1FtxNrQHusEwMFxIt4I7mKZ9YIqioymCzLq9gwQbooMDQaHWBfEbwrbw
qHyGO0aoSCqI3Haadr8faqU9GY/rOPNk3sgrDQoo//fb4hVC1CLQJ13hef4Y53CI
rU7m2Ys6xt0nUW7/vGT1M0NPAgMBAAGjQjBAMA4GA1UdDwEB/wQEAwIBBjAPBgNV
HRMBAf8EBTADAQH/MB0GA1UdDgQWBBR5tFnme7bl5AFzgAiIyBpY9umbbjANBgkq
hkiG9w0BAQsFAAOCAgEAVR9YqbyyqFDQDLHYGmkgJykIrGF1XIpu+ILlaS/V9lZL
ubhzEFnTIZd+50xx+7LSYK05qAvqFyFWhfFQDlnrzuBZ6brJFe+GnY+EgPbk6ZGQ
3BebYhtF8GaV0nxvwuo77x/Py9auJ/GpsMiu/X1+mvoiBOv/2X/qkSsisRcOj/KK
NFtY2PwByVS5uCbMiogziUwthDyC3+6WVwW6LLv3xLfHTjuCvjHIInNzktHCgKQ5
ORAzI4JMPJ+GslWYHb4phowim57iaztXOoJwTdwJx4nLCgdNbOhdjsnvzqvHu7Ur
TkXWStAmzOVyyghqpZXjFaH3pO3JLF+l+/+sKAIuvtd7u+Nxe5AW0wdeRlN8NwdC
jNPElpzVmbUq4JUagEiuTDkHzsxHpFKVK7q4+63SM1N95R1NbdWhscdCb+ZAJzVc
oyi3B43njTOQ5yOf+1CceWxG1bQVs5ZufpsMljq4Ui0/1lvh+wjChP4kqKOJ2qxq
4RgqsahDYVvTH9w7jXbyLeiNdd8XM2w9U/t7y0Ff/9yi0GE44Za4rF2LN9d11TPA
mRGunUHBcnWEvgJBQl9nJEiU0Zsnvgc/ubhPgXRR4Xq37Z0j4r7g1SgEEzwxA57d
emyPxgcYxn/eR44/KJ4EBs+lVDR3veyJm+kXQ99b21/+jh5Xos1AnX5iItreGCc=
-----END CERTIFICATE-----
`}),ci={};Nt(ci,{Socket:()=>qt,isIP:()=>Gu});function Gu(r){return 0}var Do,wt,qt,li=Ct(()=>{"use strict";X(),Do=In(kr(),1),Vu(),zu(),wt=class extends Do.EventEmitter{constructor(){super(...arguments),F(this,"_webSocketConstructor"),F(this,"_wsProxy"),F(this,"_coalesceWrites"),F(this,"_useSecureWebSocket"),F(this,"_disableSNI"),F(this,"_pipelineConnect"),F(this,"_pipelineTLS"),F(this,"_rootCerts"),F(this,"connecting",!1),F(this,"pending",!0),F(this,"writable",!0),F(this,"encrypted",!1),F(this,"authorized",!1),F(this,"destroyed",!1),F(this,"ws",null),F(this,"writeBuffer"),F(this,"tlsState",0),F(this,"tlsRead"),F(this,"tlsWrite")}get webSocketConstructor(){return this._webSocketConstructor??wt.webSocketConstructor??wt.defaults.webSocketConstructor}set webSocketConstructor(r){this._webSocketConstructor=r}get wsProxy(){return this._wsProxy??wt.wsProxy??wt.defaults.wsProxy}set wsProxy(r){this._wsProxy=r}get coalesceWrites(){return this._coalesceWrites??wt.coalesceWrites??wt.defaults.coalesceWrites}set coalesceWrites(r){this._coalesceWrites=r}get useSecureWebSocket(){return this._useSecureWebSocket??wt.useSecureWebSocket??wt.defaults.useSecureWebSocket}set useSecureWebSocket(r){this._useSecureWebSocket=r}get disableSNI(){return this._disableSNI??wt.disableSNI??wt.defaults.disableSNI}set disableSNI(r){this._disableSNI=r}get pipelineConnect(){return this._pipelineConnect??wt.pipelineConnect??wt.defaults.pipelineConnect}set pipelineConnect(r){this._pipelineConnect=r}get pipelineTLS(){return this._pipelineTLS??wt.pipelineTLS??wt.defaults.pipelineTLS}set pipelineTLS(r){this._pipelineTLS=r}get rootCerts(){return this._rootCerts??wt.rootCerts??wt.defaults.rootCerts}set rootCerts(r){this._rootCerts=r}wsProxyAddrForHost(r,t){let e=this.wsProxy;if(e===void 0){let o=`No WebSocket proxy is configured on the Neon serverless driver for database host "${r}". `,i="That's the fallback host when none is specified, so perhaps an environment variable (such as DATABASE_URL) is missing? ",u=`If "${r}" is the host you expected, then you'll need to set the 'wsProxy' option on the driver (see: https://github.com/neondatabase/serverless#run-your-own-websocket-proxy).`,l=o+(r==="localhost"?i:"")+u;throw new Error(l)}return typeof e=="function"?e(r,t):`${e}?address=${r}:${t}`}setNoDelay(){return this}setKeepAlive(){return this}ref(){return this}unref(){return this}async connect(r,t,e){this.connecting=!0,e&&this.once("connect",e);let o;try{o=this.wsProxyAddrForHost(t,typeof r=="string"?parseInt(r,10):r)}catch(i){this.emit("error",i),this.emit("close");return}return this.ws=await new Promise(async i=>{try{let u=(this.useSecureWebSocket?"wss:":"ws:")+"//"+o,l;if(this.webSocketConstructor!==void 0)l=new this.webSocketConstructor(u);else try{l=new WebSocket(u)}catch{try{l=new __unstable_WebSocket(u)}catch{let{default:s}=await import(String.fromCharCode(119)+String.fromCharCode(115));l=new s(u)}}l.addEventListener("open",()=>{i(l)})}catch(u){try{let l=(this.useSecureWebSocket?"https:":"http:")+"//"+o;await fetch(l,{headers:{Upgrade:"websocket"}}).then(s=>{let g=s.webSocket;if(g==null)throw u;g.accept(),i(g)})}catch{this.emit("error",new Error("All attempts to open a WebSocket to connect to the database failed. If using Node, please install the `ws` package (or simply use the `pg` package instead).")),this.emit("close");return}}}),this.ws.binaryType="arraybuffer",this.ws.addEventListener("error",i=>{this.emit("error",i),this.emit("close")}),this.ws.addEventListener("close",()=>{this.emit("close")}),this.ws.addEventListener("message",i=>{if(this.tlsState===0){let u=G.from(i.data);this.emit("data",u)}}),this.connecting=!1,this.pending=!1,this.emit("connect"),this.emit("ready"),this}async startTls(r){this.tlsState=1;let t=On.fromPEM(En),e=new pi(this.ws),o=e.read.bind(e),i=this.rawWrite.bind(this),[u,l]=await Hu(r,t,o,i,!this.disableSNI,void 0,this.pipelineTLS?new Uint8Array([83]):void 0);this.tlsRead=u,this.tlsWrite=l,this.tlsState=2,this.encrypted=!0,this.authorized=!0,this.emit("secureConnection",this),this.tlsReadLoop()}async tlsReadLoop(){for(;;){let r=await this.tlsRead();if(r===void 0)break;{let t=G.from(r);this.emit("data",t)}}}rawWrite(r){if(!this.coalesceWrites){this.ws.send(r);return}if(this.writeBuffer===void 0)this.writeBuffer=r,setTimeout(()=>{this.ws.send(this.writeBuffer),this.writeBuffer=void 0},0);else{let t=new Uint8Array(this.writeBuffer.length+r.length);t.set(this.writeBuffer),t.set(r,this.writeBuffer.length),this.writeBuffer=t}}write(r,t="utf8",e=o=>{}){return r.length===0?e():(typeof r=="string"&&(r=G.from(r,t)),this.tlsState===0?this.rawWrite(r):this.tlsState===1?this.once("secureConnection",()=>this.write(r,t,e)):this.tlsWrite(r),!0)}end(r=G.alloc(0),t="utf8",e){return this.write(r,t,()=>{this.ws.close(),e&&e()}),this}destroy(){return this.destroyed=!0,this.end()}},qt=wt,F(qt,"defaults",{webSocketConstructor:void 0,wsProxy:r=>r+"/v2",useSecureWebSocket:!0,coalesceWrites:!0,disableSNI:!1,pipelineConnect:"password",pipelineTLS:!0,rootCerts:En}),F(qt,"webSocketConstructor"),F(qt,"wsProxy"),F(qt,"coalesceWrites"),F(qt,"useSecureWebSocket"),F(qt,"disableSNI"),F(qt,"pipelineConnect"),F(qt,"pipelineTLS"),F(qt,"rootCerts")}),mi=J(r=>{"use strict";X(),Object.defineProperty(r,"__esModule",{value:!0}),r.NoticeMessage=r.DataRowMessage=r.CommandCompleteMessage=r.ReadyForQueryMessage=r.NotificationResponseMessage=r.BackendKeyDataMessage=r.AuthenticationMD5Password=r.ParameterStatusMessage=r.ParameterDescriptionMessage=r.RowDescriptionMessage=r.Field=r.CopyResponse=r.CopyDataMessage=r.DatabaseError=r.copyDone=r.emptyQuery=r.replicationStart=r.portalSuspended=r.noData=r.closeComplete=r.bindComplete=r.parseComplete=void 0,r.parseComplete={name:"parseComplete",length:5},r.bindComplete={name:"bindComplete",length:5},r.closeComplete={name:"closeComplete",length:5},r.noData={name:"noData",length:5},r.portalSuspended={name:"portalSuspended",length:5},r.replicationStart={name:"replicationStart",length:4},r.emptyQuery={name:"emptyQuery",length:4},r.copyDone={name:"copyDone",length:4};var t=class extends Error{constructor(h,x,A){super(h),this.length=x,this.name=A}};r.DatabaseError=t;var e=class{constructor(h,x){this.length=h,this.chunk=x,this.name="copyData"}};r.CopyDataMessage=e;var o=class{constructor(h,x,A,C){this.length=h,this.name=x,this.binary=A,this.columnTypes=new Array(C)}};r.CopyResponse=o;var i=class{constructor(h,x,A,C,E,N,O){this.name=h,this.tableID=x,this.columnID=A,this.dataTypeID=C,this.dataTypeSize=E,this.dataTypeModifier=N,this.format=O}};r.Field=i;var u=class{constructor(h,x){this.length=h,this.fieldCount=x,this.name="rowDescription",this.fields=new Array(this.fieldCount)}};r.RowDescriptionMessage=u;var l=class{constructor(h,x){this.length=h,this.parameterCount=x,this.name="parameterDescription",this.dataTypeIDs=new Array(this.parameterCount)}};r.ParameterDescriptionMessage=l;var s=class{constructor(h,x,A){this.length=h,this.parameterName=x,this.parameterValue=A,this.name="parameterStatus"}};r.ParameterStatusMessage=s;var g=class{constructor(h,x){this.length=h,this.salt=x,this.name="authenticationMD5Password"}};r.AuthenticationMD5Password=g;var v=class{constructor(h,x,A){this.length=h,this.processID=x,this.secretKey=A,this.name="backendKeyData"}};r.BackendKeyDataMessage=v;var m=class{constructor(h,x,A,C){this.length=h,this.processId=x,this.channel=A,this.payload=C,this.name="notification"}};r.NotificationResponseMessage=m;var d=class{constructor(h,x){this.length=h,this.status=x,this.name="readyForQuery"}};r.ReadyForQueryMessage=d;var f=class{constructor(h,x){this.length=h,this.text=x,this.name="commandComplete"}};r.CommandCompleteMessage=f;var y=class{constructor(h,x){this.length=h,this.fields=x,this.name="dataRow",this.fieldCount=x.length}};r.DataRowMessage=y;var p=class{constructor(h,x){this.length=h,this.message=x,this.name="notice"}};r.NoticeMessage=p}),Ju=J(r=>{"use strict";X(),Object.defineProperty(r,"__esModule",{value:!0}),r.Writer=void 0;var t=class{constructor(e=256){this.size=e,this.offset=5,this.headerPosition=0,this.buffer=G.allocUnsafe(e)}ensure(e){var o=this.buffer.length-this.offset;if(o<e){var i=this.buffer,u=i.length+(i.length>>1)+e;this.buffer=G.allocUnsafe(u),i.copy(this.buffer)}}addInt32(e){return this.ensure(4),this.buffer[this.offset++]=e>>>24&255,this.buffer[this.offset++]=e>>>16&255,this.buffer[this.offset++]=e>>>8&255,this.buffer[this.offset++]=e>>>0&255,this}addInt16(e){return this.ensure(2),this.buffer[this.offset++]=e>>>8&255,this.buffer[this.offset++]=e>>>0&255,this}addCString(e){if(!e)this.ensure(1);else{var o=G.byteLength(e);this.ensure(o+1),this.buffer.write(e,this.offset,"utf-8"),this.offset+=o}return this.buffer[this.offset++]=0,this}addString(e=""){var o=G.byteLength(e);return this.ensure(o),this.buffer.write(e,this.offset),this.offset+=o,this}add(e){return this.ensure(e.length),e.copy(this.buffer,this.offset),this.offset+=e.length,this}join(e){if(e){this.buffer[this.headerPosition]=e;let o=this.offset-(this.headerPosition+1);this.buffer.writeInt32BE(o,this.headerPosition+1)}return this.buffer.slice(e?0:5,this.offset)}flush(e){var o=this.join(e);return this.offset=5,this.headerPosition=0,this.buffer=G.allocUnsafe(this.size),o}};r.Writer=t}),Yu=J(r=>{"use strict";X(),Object.defineProperty(r,"__esModule",{value:!0}),r.serialize=void 0;var t=Ju(),e=new t.Writer,o=B=>{e.addInt16(3).addInt16(0);for(let j of Object.keys(B))e.addCString(j).addCString(B[j]);e.addCString("client_encoding").addCString("UTF8");var z=e.addCString("").flush(),V=z.length+4;return new t.Writer().addInt32(V).add(z).flush()},i=()=>{let B=G.allocUnsafe(8);return B.writeInt32BE(8,0),B.writeInt32BE(80877103,4),B},u=B=>e.addCString(B).flush(112),l=function(B,z){return e.addCString(B).addInt32(G.byteLength(z)).addString(z),e.flush(112)},s=function(B){return e.addString(B).flush(112)},g=B=>e.addCString(B).flush(81),v=[],m=B=>{let z=B.name||"";z.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",z,z.length),console.error("This can cause conflicts and silent errors executing queries"));let V=B.types||v;for(var j=V.length,$=e.addCString(z).addCString(B.text).addInt16(j),ot=0;ot<j;ot++)$.addInt32(V[ot]);return e.flush(80)},d=new t.Writer,f=function(B,z){for(let V=0;V<B.length;V++){let j=z?z(B[V],V):B[V];j==null?(e.addInt16(0),d.addInt32(-1)):j instanceof G?(e.addInt16(1),d.addInt32(j.length),d.add(j)):(e.addInt16(0),d.addInt32(G.byteLength(j)),d.addString(j))}},y=(B={})=>{let z=B.portal||"",V=B.statement||"",j=B.binary||!1,$=B.values||v,ot=$.length;return e.addCString(z).addCString(V),e.addInt16(ot),f($,B.valueMapper),e.addInt16(ot),e.add(d.flush()),e.addInt16(j?1:0),e.flush(66)},p=G.from([69,0,0,0,9,0,0,0,0,0]),h=B=>{if(!B||!B.portal&&!B.rows)return p;let z=B.portal||"",V=B.rows||0,j=G.byteLength(z),$=4+j+1+4,ot=G.allocUnsafe(1+$);return ot[0]=69,ot.writeInt32BE($,1),ot.write(z,5,"utf-8"),ot[j+5]=0,ot.writeUInt32BE(V,ot.length-4),ot},x=(B,z)=>{let V=G.allocUnsafe(16);return V.writeInt32BE(16,0),V.writeInt16BE(1234,4),V.writeInt16BE(5678,6),V.writeInt32BE(B,8),V.writeInt32BE(z,12),V},A=(B,z)=>{let V=4+G.byteLength(z)+1,j=G.allocUnsafe(1+V);return j[0]=B,j.writeInt32BE(V,1),j.write(z,5,"utf-8"),j[V]=0,j},C=e.addCString("P").flush(68),E=e.addCString("S").flush(68),N=B=>B.name?A(68,`${B.type}${B.name||""}`):B.type==="P"?C:E,O=B=>{let z=`${B.type}${B.name||""}`;return A(67,z)},_=B=>e.add(B).flush(100),k=B=>A(102,B),R=B=>G.from([B,0,0,0,4]),S=R(72),T=R(83),L=R(88),W=R(99),Q={startup:o,password:u,requestSsl:i,sendSASLInitialResponseMessage:l,sendSCRAMClientFinalMessage:s,query:g,parse:m,bind:y,execute:h,describe:N,close:O,flush:()=>S,sync:()=>T,end:()=>L,copyData:_,copyDone:()=>W,copyFail:k,cancel:x};r.serialize=Q}),$u=J(r=>{"use strict";X(),Object.defineProperty(r,"__esModule",{value:!0}),r.BufferReader=void 0;var t=G.allocUnsafe(0),e=class{constructor(o=0){this.offset=o,this.buffer=t,this.encoding="utf-8"}setBuffer(o,i){this.offset=o,this.buffer=i}int16(){let o=this.buffer.readInt16BE(this.offset);return this.offset+=2,o}byte(){let o=this.buffer[this.offset];return this.offset++,o}int32(){let o=this.buffer.readInt32BE(this.offset);return this.offset+=4,o}string(o){let i=this.buffer.toString(this.encoding,this.offset,this.offset+o);return this.offset+=o,i}cstring(){let o=this.offset,i=o;for(;this.buffer[i++]!==0;);return this.offset=i,this.buffer.toString(this.encoding,o,i-1)}bytes(o){let i=this.buffer.slice(this.offset,this.offset+o);return this.offset+=o,i}};r.BufferReader=e}),hi={};Nt(hi,{default:()=>di});var di,Zu=Ct(()=>{X(),di={}}),tf=J(r=>{"use strict";X();var t=r&&r.__importDefault||function(m){return m&&m.__esModule?m:{default:m}};Object.defineProperty(r,"__esModule",{value:!0}),r.Parser=void 0;var e=mi(),o=$u(),i=t((Zu(),xt(hi))),u=1,l=4,s=u+l,g=G.allocUnsafe(0),v=class{constructor(m){if(this.buffer=g,this.bufferLength=0,this.bufferOffset=0,this.reader=new o.BufferReader,m?.mode==="binary")throw new Error("Binary mode not supported yet");this.mode=m?.mode||"text"}parse(m,d){this.mergeBuffer(m);let f=this.bufferOffset+this.bufferLength,y=this.bufferOffset;for(;y+s<=f;){let p=this.buffer[y],h=this.buffer.readUInt32BE(y+u),x=u+h;if(x+y<=f){let A=this.handlePacket(y+s,p,h,this.buffer);d(A),y+=x}else break}y===f?(this.buffer=g,this.bufferLength=0,this.bufferOffset=0):(this.bufferLength=f-y,this.bufferOffset=y)}mergeBuffer(m){if(this.bufferLength>0){let d=this.bufferLength+m.byteLength;if(d+this.bufferOffset>this.buffer.byteLength){let f;if(d<=this.buffer.byteLength&&this.bufferOffset>=this.bufferLength)f=this.buffer;else{let y=this.buffer.byteLength*2;for(;d>=y;)y*=2;f=G.allocUnsafe(y)}this.buffer.copy(f,0,this.bufferOffset,this.bufferOffset+this.bufferLength),this.buffer=f,this.bufferOffset=0}m.copy(this.buffer,this.bufferOffset+this.bufferLength),this.bufferLength=d}else this.buffer=m,this.bufferOffset=0,this.bufferLength=m.byteLength}handlePacket(m,d,f,y){switch(d){case 50:return e.bindComplete;case 49:return e.parseComplete;case 51:return e.closeComplete;case 110:return e.noData;case 115:return e.portalSuspended;case 99:return e.copyDone;case 87:return e.replicationStart;case 73:return e.emptyQuery;case 68:return this.parseDataRowMessage(m,f,y);case 67:return this.parseCommandCompleteMessage(m,f,y);case 90:return this.parseReadyForQueryMessage(m,f,y);case 65:return this.parseNotificationMessage(m,f,y);case 82:return this.parseAuthenticationResponse(m,f,y);case 83:return this.parseParameterStatusMessage(m,f,y);case 75:return this.parseBackendKeyData(m,f,y);case 69:return this.parseErrorMessage(m,f,y,"error");case 78:return this.parseErrorMessage(m,f,y,"notice");case 84:return this.parseRowDescriptionMessage(m,f,y);case 116:return this.parseParameterDescriptionMessage(m,f,y);case 71:return this.parseCopyInMessage(m,f,y);case 72:return this.parseCopyOutMessage(m,f,y);case 100:return this.parseCopyData(m,f,y);default:i.default.fail(`unknown message code: ${d.toString(16)}`)}}parseReadyForQueryMessage(m,d,f){this.reader.setBuffer(m,f);let y=this.reader.string(1);return new e.ReadyForQueryMessage(d,y)}parseCommandCompleteMessage(m,d,f){this.reader.setBuffer(m,f);let y=this.reader.cstring();return new e.CommandCompleteMessage(d,y)}parseCopyData(m,d,f){let y=f.slice(m,m+(d-4));return new e.CopyDataMessage(d,y)}parseCopyInMessage(m,d,f){return this.parseCopyMessage(m,d,f,"copyInResponse")}parseCopyOutMessage(m,d,f){return this.parseCopyMessage(m,d,f,"copyOutResponse")}parseCopyMessage(m,d,f,y){this.reader.setBuffer(m,f);let p=this.reader.byte()!==0,h=this.reader.int16(),x=new e.CopyResponse(d,y,p,h);for(let A=0;A<h;A++)x.columnTypes[A]=this.reader.int16();return x}parseNotificationMessage(m,d,f){this.reader.setBuffer(m,f);let y=this.reader.int32(),p=this.reader.cstring(),h=this.reader.cstring();return new e.NotificationResponseMessage(d,y,p,h)}parseRowDescriptionMessage(m,d,f){this.reader.setBuffer(m,f);let y=this.reader.int16(),p=new e.RowDescriptionMessage(d,y);for(let h=0;h<y;h++)p.fields[h]=this.parseField();return p}parseField(){let m=this.reader.cstring(),d=this.reader.int32(),f=this.reader.int16(),y=this.reader.int32(),p=this.reader.int16(),h=this.reader.int32(),x=this.reader.int16()===0?"text":"binary";return new e.Field(m,d,f,y,p,h,x)}parseParameterDescriptionMessage(m,d,f){this.reader.setBuffer(m,f);let y=this.reader.int16(),p=new e.ParameterDescriptionMessage(d,y);for(let h=0;h<y;h++)p.dataTypeIDs[h]=this.reader.int32();return p}parseDataRowMessage(m,d,f){this.reader.setBuffer(m,f);let y=this.reader.int16(),p=new Array(y);for(let h=0;h<y;h++){let x=this.reader.int32();p[h]=x===-1?null:this.reader.string(x)}return new e.DataRowMessage(d,p)}parseParameterStatusMessage(m,d,f){this.reader.setBuffer(m,f);let y=this.reader.cstring(),p=this.reader.cstring();return new e.ParameterStatusMessage(d,y,p)}parseBackendKeyData(m,d,f){this.reader.setBuffer(m,f);let y=this.reader.int32(),p=this.reader.int32();return new e.BackendKeyDataMessage(d,y,p)}parseAuthenticationResponse(m,d,f){this.reader.setBuffer(m,f);let y=this.reader.int32(),p={name:"authenticationOk",length:d};switch(y){case 0:break;case 3:p.length===8&&(p.name="authenticationCleartextPassword");break;case 5:if(p.length===12){p.name="authenticationMD5Password";let x=this.reader.bytes(4);return new e.AuthenticationMD5Password(d,x)}break;case 10:p.name="authenticationSASL",p.mechanisms=[];let h;do h=this.reader.cstring(),h&&p.mechanisms.push(h);while(h);break;case 11:p.name="authenticationSASLContinue",p.data=this.reader.string(d-8);break;case 12:p.name="authenticationSASLFinal",p.data=this.reader.string(d-8);break;default:throw new Error("Unknown authenticationOk message type "+y)}return p}parseErrorMessage(m,d,f,y){this.reader.setBuffer(m,f);let p={},h=this.reader.string(1);for(;h!=="\0";)p[h]=this.reader.cstring(),h=this.reader.string(1);let x=p.M,A=y==="notice"?new e.NoticeMessage(d,x):new e.DatabaseError(x,d,y);return A.severity=p.S,A.code=p.C,A.detail=p.D,A.hint=p.H,A.position=p.P,A.internalPosition=p.p,A.internalQuery=p.q,A.where=p.W,A.schema=p.s,A.table=p.t,A.column=p.c,A.dataType=p.d,A.constraint=p.n,A.file=p.F,A.line=p.L,A.routine=p.R,A}};r.Parser=v}),yi=J(r=>{"use strict";X(),Object.defineProperty(r,"__esModule",{value:!0}),r.DatabaseError=r.serialize=r.parse=void 0;var t=mi();Object.defineProperty(r,"DatabaseError",{enumerable:!0,get:function(){return t.DatabaseError}});var e=Yu();Object.defineProperty(r,"serialize",{enumerable:!0,get:function(){return e.serialize}});var o=tf();function i(u,l){let s=new o.Parser;return u.on("data",g=>s.parse(g,l)),new Promise(g=>u.on("end",()=>g()))}r.parse=i}),gi={};Nt(gi,{connect:()=>rf});function rf(r){let{socket:t,servername:e}=r;return t.startTls(e),t}var ef=Ct(()=>{X()}),vi=J((r,t)=>{"use strict";X();var e=(li(),xt(ci)),o=kr().EventEmitter,{parse:i,serialize:u}=yi(),l=u.flush(),s=u.sync(),g=u.end(),v=class extends o{constructor(m){super(),m=m||{},this.stream=m.stream||new e.Socket,typeof this.stream=="function"&&(this.stream=this.stream(m)),this._keepAlive=m.keepAlive,this._keepAliveInitialDelayMillis=m.keepAliveInitialDelayMillis,this.lastBuffer=!1,this.parsedStatements={},this.ssl=m.ssl||!1,this._ending=!1,this._emitMessage=!1;var d=this;this.on("newListener",function(f){f==="message"&&(d._emitMessage=!0)})}connect(m,d){var f=this;this._connecting=!0,this.stream.setNoDelay(!0),this.stream.connect(m,d),this.stream.once("connect",function(){f._keepAlive&&f.stream.setKeepAlive(!0,f._keepAliveInitialDelayMillis),f.emit("connect")});let y=function(p){f._ending&&(p.code==="ECONNRESET"||p.code==="EPIPE")||f.emit("error",p)};if(this.stream.on("error",y),this.stream.on("close",function(){f.emit("end")}),!this.ssl)return this.attachListeners(this.stream);this.stream.once("data",function(p){var h=p.toString("utf8");switch(h){case"S":break;case"N":return f.stream.end(),f.emit("error",new Error("The server does not support SSL connections"));default:return f.stream.end(),f.emit("error",new Error("There was an error establishing an SSL connection"))}var x=(ef(),xt(gi));let A={socket:f.stream};f.ssl!==!0&&(Object.assign(A,f.ssl),"key"in f.ssl&&(A.key=f.ssl.key)),e.isIP(d)===0&&(A.servername=d);try{f.stream=x.connect(A)}catch(C){return f.emit("error",C)}f.attachListeners(f.stream),f.stream.on("error",y),f.emit("sslconnect")})}attachListeners(m){m.on("end",()=>{this.emit("end")}),i(m,d=>{var f=d.name==="error"?"errorMessage":d.name;this._emitMessage&&this.emit("message",d),this.emit(f,d)})}requestSsl(){this.stream.write(u.requestSsl())}startup(m){this.stream.write(u.startup(m))}cancel(m,d){this._send(u.cancel(m,d))}password(m){this._send(u.password(m))}sendSASLInitialResponseMessage(m,d){this._send(u.sendSASLInitialResponseMessage(m,d))}sendSCRAMClientFinalMessage(m){this._send(u.sendSCRAMClientFinalMessage(m))}_send(m){return this.stream.writable?this.stream.write(m):!1}query(m){this._send(u.query(m))}parse(m){this._send(u.parse(m))}bind(m){this._send(u.bind(m))}execute(m){this._send(u.execute(m))}flush(){this.stream.writable&&this.stream.write(l)}sync(){this._ending=!0,this._send(s)}ref(){this.stream.ref()}unref(){this.stream.unref()}end(){if(this._ending=!0,!this._connecting||!this.stream.writable){this.stream.end();return}return this.stream.write(g,()=>{this.stream.end()})}close(m){this._send(u.close(m))}describe(m){this._send(u.describe(m))}sendCopyFromChunk(m){this._send(u.copyData(m))}endCopyFrom(){this._send(u.copyDone())}sendCopyFail(m){this._send(u.copyFail(m))}};t.exports=v}),nf=J((r,t)=>{"use strict";X();var e=kr().EventEmitter,o=Cn(),i=xu(),u=Eu(),l=Yo(),s=ri(),g=ku(),v=Be(),m=vi(),d=class extends e{constructor(f){super(),this.connectionParameters=new s(f),this.user=this.connectionParameters.user,this.database=this.connectionParameters.database,this.port=this.connectionParameters.port,this.host=this.connectionParameters.host,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:this.connectionParameters.password}),this.replication=this.connectionParameters.replication;var y=f||{};this._Promise=y.Promise||Te.Promise,this._types=new l(y.types),this._ending=!1,this._connecting=!1,this._connected=!1,this._connectionError=!1,this._queryable=!0,this.connection=y.connection||new m({stream:y.stream,ssl:this.connectionParameters.ssl,keepAlive:y.keepAlive||!1,keepAliveInitialDelayMillis:y.keepAliveInitialDelayMillis||0,encoding:this.connectionParameters.client_encoding||"utf8"}),this.queryQueue=[],this.binary=y.binary||v.binary,this.processID=null,this.secretKey=null,this.ssl=this.connectionParameters.ssl||!1,this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this._connectionTimeoutMillis=y.connectionTimeoutMillis||0}_errorAllQueries(f){let y=p=>{Y.nextTick(()=>{p.handleError(f,this.connection)})};this.activeQuery&&(y(this.activeQuery),this.activeQuery=null),this.queryQueue.forEach(y),this.queryQueue.length=0}_connect(f){var y=this,p=this.connection;if(this._connectionCallback=f,this._connecting||this._connected){let h=new Error("Client has already been connected. You cannot reuse a client.");Y.nextTick(()=>{f(h)});return}this._connecting=!0,this.connectionTimeoutHandle,this._connectionTimeoutMillis>0&&(this.connectionTimeoutHandle=setTimeout(()=>{p._ending=!0,p.stream.destroy(new Error("timeout expired"))},this._connectionTimeoutMillis)),this.host&&this.host.indexOf("/")===0?p.connect(this.host+"/.s.PGSQL."+this.port):p.connect(this.port,this.host),p.on("connect",function(){y.ssl?p.requestSsl():p.startup(y.getStartupConf())}),p.on("sslconnect",function(){p.startup(y.getStartupConf())}),this._attachListeners(p),p.once("end",()=>{let h=this._ending?new Error("Connection terminated"):new Error("Connection terminated unexpectedly");clearTimeout(this.connectionTimeoutHandle),this._errorAllQueries(h),this._ending||(this._connecting&&!this._connectionError?this._connectionCallback?this._connectionCallback(h):this._handleErrorEvent(h):this._connectionError||this._handleErrorEvent(h)),Y.nextTick(()=>{this.emit("end")})})}connect(f){if(f){this._connect(f);return}return new this._Promise((y,p)=>{this._connect(h=>{h?p(h):y()})})}_attachListeners(f){f.on("authenticationCleartextPassword",this._handleAuthCleartextPassword.bind(this)),f.on("authenticationMD5Password",this._handleAuthMD5Password.bind(this)),f.on("authenticationSASL",this._handleAuthSASL.bind(this)),f.on("authenticationSASLContinue",this._handleAuthSASLContinue.bind(this)),f.on("authenticationSASLFinal",this._handleAuthSASLFinal.bind(this)),f.on("backendKeyData",this._handleBackendKeyData.bind(this)),f.on("error",this._handleErrorEvent.bind(this)),f.on("errorMessage",this._handleErrorMessage.bind(this)),f.on("readyForQuery",this._handleReadyForQuery.bind(this)),f.on("notice",this._handleNotice.bind(this)),f.on("rowDescription",this._handleRowDescription.bind(this)),f.on("dataRow",this._handleDataRow.bind(this)),f.on("portalSuspended",this._handlePortalSuspended.bind(this)),f.on("emptyQuery",this._handleEmptyQuery.bind(this)),f.on("commandComplete",this._handleCommandComplete.bind(this)),f.on("parseComplete",this._handleParseComplete.bind(this)),f.on("copyInResponse",this._handleCopyInResponse.bind(this)),f.on("copyData",this._handleCopyData.bind(this)),f.on("notification",this._handleNotification.bind(this))}_checkPgPass(f){let y=this.connection;typeof this.password=="function"?this._Promise.resolve().then(()=>this.password()).then(p=>{if(p!==void 0){if(typeof p!="string"){y.emit("error",new TypeError("Password must be a string"));return}this.connectionParameters.password=this.password=p}else this.connectionParameters.password=this.password=null;f()}).catch(p=>{y.emit("error",p)}):this.password!==null?f():u(this.connectionParameters,p=>{p!==void 0&&(this.connectionParameters.password=this.password=p),f()})}_handleAuthCleartextPassword(f){this._checkPgPass(()=>{this.connection.password(this.password)})}_handleAuthMD5Password(f){this._checkPgPass(()=>{let y=o.postgresMd5PasswordHash(this.user,this.password,f.salt);this.connection.password(y)})}_handleAuthSASL(f){this._checkPgPass(()=>{try{this.saslSession=i.startSession(f.mechanisms),this.connection.sendSASLInitialResponseMessage(this.saslSession.mechanism,this.saslSession.response)}catch(y){this.connection.emit("error",y)}})}_handleAuthSASLContinue(f){try{i.continueSession(this.saslSession,this.password,f.data),this.connection.sendSCRAMClientFinalMessage(this.saslSession.response)}catch(y){this.connection.emit("error",y)}}_handleAuthSASLFinal(f){try{i.finalizeSession(this.saslSession,f.data),this.saslSession=null}catch(y){this.connection.emit("error",y)}}_handleBackendKeyData(f){this.processID=f.processID,this.secretKey=f.secretKey}_handleReadyForQuery(f){this._connecting&&(this._connecting=!1,this._connected=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback&&(this._connectionCallback(null,this),this._connectionCallback=null),this.emit("connect"));let{activeQuery:y}=this;this.activeQuery=null,this.readyForQuery=!0,y&&y.handleReadyForQuery(this.connection),this._pulseQueryQueue()}_handleErrorWhileConnecting(f){if(!this._connectionError){if(this._connectionError=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback)return this._connectionCallback(f);this.emit("error",f)}}_handleErrorEvent(f){if(this._connecting)return this._handleErrorWhileConnecting(f);this._queryable=!1,this._errorAllQueries(f),this.emit("error",f)}_handleErrorMessage(f){if(this._connecting)return this._handleErrorWhileConnecting(f);let y=this.activeQuery;if(!y){this._handleErrorEvent(f);return}this.activeQuery=null,y.handleError(f,this.connection)}_handleRowDescription(f){this.activeQuery.handleRowDescription(f)}_handleDataRow(f){this.activeQuery.handleDataRow(f)}_handlePortalSuspended(f){this.activeQuery.handlePortalSuspended(this.connection)}_handleEmptyQuery(f){this.activeQuery.handleEmptyQuery(this.connection)}_handleCommandComplete(f){this.activeQuery.handleCommandComplete(f,this.connection)}_handleParseComplete(f){this.activeQuery.name&&(this.connection.parsedStatements[this.activeQuery.name]=this.activeQuery.text)}_handleCopyInResponse(f){this.activeQuery.handleCopyInResponse(this.connection)}_handleCopyData(f){this.activeQuery.handleCopyData(f,this.connection)}_handleNotification(f){this.emit("notification",f)}_handleNotice(f){this.emit("notice",f)}getStartupConf(){var f=this.connectionParameters,y={user:f.user,database:f.database},p=f.application_name||f.fallback_application_name;return p&&(y.application_name=p),f.replication&&(y.replication=""+f.replication),f.statement_timeout&&(y.statement_timeout=String(parseInt(f.statement_timeout,10))),f.lock_timeout&&(y.lock_timeout=String(parseInt(f.lock_timeout,10))),f.idle_in_transaction_session_timeout&&(y.idle_in_transaction_session_timeout=String(parseInt(f.idle_in_transaction_session_timeout,10))),f.options&&(y.options=f.options),y}cancel(f,y){if(f.activeQuery===y){var p=this.connection;this.host&&this.host.indexOf("/")===0?p.connect(this.host+"/.s.PGSQL."+this.port):p.connect(this.port,this.host),p.on("connect",function(){p.cancel(f.processID,f.secretKey)})}else f.queryQueue.indexOf(y)!==-1&&f.queryQueue.splice(f.queryQueue.indexOf(y),1)}setTypeParser(f,y,p){return this._types.setTypeParser(f,y,p)}getTypeParser(f,y){return this._types.getTypeParser(f,y)}escapeIdentifier(f){return'"'+f.replace(/"/g,'""')+'"'}escapeLiteral(f){for(var y=!1,p="'",h=0;h<f.length;h++){var x=f[h];x==="'"?p+=x+x:x==="\\"?(p+=x+x,y=!0):p+=x}return p+="'",y===!0&&(p=" E"+p),p}_pulseQueryQueue(){if(this.readyForQuery===!0)if(this.activeQuery=this.queryQueue.shift(),this.activeQuery){this.readyForQuery=!1,this.hasExecuted=!0;let f=this.activeQuery.submit(this.connection);f&&Y.nextTick(()=>{this.activeQuery.handleError(f,this.connection),this.readyForQuery=!0,this._pulseQueryQueue()})}else this.hasExecuted&&(this.activeQuery=null,this.emit("drain"))}query(f,y,p){var h,x,A,C,E;if(f==null)throw new TypeError("Client was passed a null or undefined query");return typeof f.submit=="function"?(A=f.query_timeout||this.connectionParameters.query_timeout,x=h=f,typeof y=="function"&&(h.callback=h.callback||y)):(A=this.connectionParameters.query_timeout,h=new g(f,y,p),h.callback||(x=new this._Promise((N,O)=>{h.callback=(_,k)=>_?O(_):N(k)}))),A&&(E=h.callback,C=setTimeout(()=>{var N=new Error("Query read timeout");Y.nextTick(()=>{h.handleError(N,this.connection)}),E(N),h.callback=()=>{};var O=this.queryQueue.indexOf(h);O>-1&&this.queryQueue.splice(O,1),this._pulseQueryQueue()},A),h.callback=(N,O)=>{clearTimeout(C),E(N,O)}),this.binary&&!h.binary&&(h.binary=!0),h._result&&!h._result._types&&(h._result._types=this._types),this._queryable?this._ending?(Y.nextTick(()=>{h.handleError(new Error("Client was closed and is not queryable"),this.connection)}),x):(this.queryQueue.push(h),this._pulseQueryQueue(),x):(Y.nextTick(()=>{h.handleError(new Error("Client has encountered a connection error and is not queryable"),this.connection)}),x)}ref(){this.connection.ref()}unref(){this.connection.unref()}end(f){if(this._ending=!0,!this.connection._connecting)if(f)f();else return this._Promise.resolve();if(this.activeQuery||!this._queryable?this.connection.stream.destroy():this.connection.end(),f)this.connection.once("end",f);else return new this._Promise(y=>{this.connection.once("end",y)})}};d.Query=g,t.exports=d}),of=J((r,t)=>{"use strict";X();var e=kr().EventEmitter,o=function(){},i=(d,f)=>{let y=d.findIndex(f);return y===-1?void 0:d.splice(y,1)[0]},u=class{constructor(d,f,y){this.client=d,this.idleListener=f,this.timeoutId=y}},l=class{constructor(d){this.callback=d}};function s(){throw new Error("Release called on client which has already been released to the pool.")}function g(d,f){if(f)return{callback:f,result:void 0};let y,p,h=function(A,C){A?y(A):p(C)},x=new d(function(A,C){p=A,y=C});return{callback:h,result:x}}function v(d,f){return function y(p){p.client=f,f.removeListener("error",y),f.on("error",()=>{d.log("additional client error after disconnection due to error",p)}),d._remove(f),d.emit("error",p,f)}}var m=class extends e{constructor(d,f){super(),this.options=Object.assign({},d),d!=null&&"password"in d&&Object.defineProperty(this.options,"password",{configurable:!0,enumerable:!1,writable:!0,value:d.password}),d!=null&&d.ssl&&d.ssl.key&&Object.defineProperty(this.options.ssl,"key",{enumerable:!1}),this.options.max=this.options.max||this.options.poolSize||10,this.options.maxUses=this.options.maxUses||1/0,this.options.allowExitOnIdle=this.options.allowExitOnIdle||!1,this.options.maxLifetimeSeconds=this.options.maxLifetimeSeconds||0,this.log=this.options.log||function(){},this.Client=this.options.Client||f||Bn().Client,this.Promise=this.options.Promise||Te.Promise,typeof this.options.idleTimeoutMillis>"u"&&(this.options.idleTimeoutMillis=1e4),this._clients=[],this._idle=[],this._expired=new WeakSet,this._pendingQueue=[],this._endCallback=void 0,this.ending=!1,this.ended=!1}_isFull(){return this._clients.length>=this.options.max}_pulseQueue(){if(this.log("pulse queue"),this.ended){this.log("pulse queue ended");return}if(this.ending){this.log("pulse queue on ending"),this._idle.length&&this._idle.slice().map(f=>{this._remove(f.client)}),this._clients.length||(this.ended=!0,this._endCallback());return}if(!this._pendingQueue.length){this.log("no queued requests");return}if(!this._idle.length&&this._isFull())return;let d=this._pendingQueue.shift();if(this._idle.length){let f=this._idle.pop();clearTimeout(f.timeoutId);let y=f.client;y.ref&&y.ref();let p=f.idleListener;return this._acquireClient(y,d,p,!1)}if(!this._isFull())return this.newClient(d);throw new Error("unexpected condition")}_remove(d){let f=i(this._idle,y=>y.client===d);f!==void 0&&clearTimeout(f.timeoutId),this._clients=this._clients.filter(y=>y!==d),d.end(),this.emit("remove",d)}connect(d){if(this.ending){let p=new Error("Cannot use a pool after calling end on the pool");return d?d(p):this.Promise.reject(p)}let f=g(this.Promise,d),y=f.result;if(this._isFull()||this._idle.length){if(this._idle.length&&Y.nextTick(()=>this._pulseQueue()),!this.options.connectionTimeoutMillis)return this._pendingQueue.push(new l(f.callback)),y;let p=(A,C,E)=>{clearTimeout(x),f.callback(A,C,E)},h=new l(p),x=setTimeout(()=>{i(this._pendingQueue,A=>A.callback===p),h.timedOut=!0,f.callback(new Error("timeout exceeded when trying to connect"))},this.options.connectionTimeoutMillis);return this._pendingQueue.push(h),y}return this.newClient(new l(f.callback)),y}newClient(d){let f=new this.Client(this.options);this._clients.push(f);let y=v(this,f);this.log("checking client timeout");let p,h=!1;this.options.connectionTimeoutMillis&&(p=setTimeout(()=>{this.log("ending client due to timeout"),h=!0,f.connection?f.connection.stream.destroy():f.end()},this.options.connectionTimeoutMillis)),this.log("connecting new client"),f.connect(x=>{if(p&&clearTimeout(p),f.on("error",y),x)this.log("client failed to connect",x),this._clients=this._clients.filter(A=>A!==f),h&&(x.message="Connection terminated due to connection timeout"),this._pulseQueue(),d.timedOut||d.callback(x,void 0,o);else{if(this.log("new client connected"),this.options.maxLifetimeSeconds!==0){let A=setTimeout(()=>{this.log("ending client due to expired lifetime"),this._expired.add(f),this._idle.findIndex(C=>C.client===f)!==-1&&this._acquireClient(f,new l((C,E,N)=>N()),y,!1)},this.options.maxLifetimeSeconds*1e3);A.unref(),f.once("end",()=>clearTimeout(A))}return this._acquireClient(f,d,y,!0)}})}_acquireClient(d,f,y,p){p&&this.emit("connect",d),this.emit("acquire",d),d.release=this._releaseOnce(d,y),d.removeListener("error",y),f.timedOut?p&&this.options.verify?this.options.verify(d,d.release):d.release():p&&this.options.verify?this.options.verify(d,h=>{if(h)return d.release(h),f.callback(h,void 0,o);f.callback(void 0,d,d.release)}):f.callback(void 0,d,d.release)}_releaseOnce(d,f){let y=!1;return p=>{y&&s(),y=!0,this._release(d,f,p)}}_release(d,f,y){if(d.on("error",f),d._poolUseCount=(d._poolUseCount||0)+1,y||this.ending||!d._queryable||d._ending||d._poolUseCount>=this.options.maxUses){d._poolUseCount>=this.options.maxUses&&this.log("remove expended client"),this._remove(d),this._pulseQueue();return}if(this._expired.has(d)){this.log("remove expired client"),this._expired.delete(d),this._remove(d),this._pulseQueue();return}let p;this.options.idleTimeoutMillis&&(p=setTimeout(()=>{this.log("remove idle client"),this._remove(d)},this.options.idleTimeoutMillis),this.options.allowExitOnIdle&&p.unref()),this.options.allowExitOnIdle&&d.unref(),this._idle.push(new u(d,f,p)),this._pulseQueue()}query(d,f,y){if(typeof d=="function"){let h=g(this.Promise,d);return Rn(function(){return h.callback(new Error("Passing a function as the first parameter to pool.query is not supported"))}),h.result}typeof f=="function"&&(y=f,f=void 0);let p=g(this.Promise,y);return y=p.callback,this.connect((h,x)=>{if(h)return y(h);let A=!1,C=E=>{A||(A=!0,x.release(E),y(E))};x.once("error",C),this.log("dispatching query");try{x.query(d,f,(E,N)=>{if(this.log("query dispatched"),x.removeListener("error",C),!A)return A=!0,x.release(E),E?y(E):y(void 0,N)})}catch(E){return x.release(E),y(E)}}),p.result}end(d){if(this.log("ending"),this.ending){let y=new Error("Called end on pool more than once");return d?d(y):this.Promise.reject(y)}this.ending=!0;let f=g(this.Promise,d);return this._endCallback=f.callback,this._pulseQueue(),f.result}get waitingCount(){return this._pendingQueue.length}get idleCount(){return this._idle.length}get expiredCount(){return this._clients.reduce((d,f)=>d+(this._expired.has(f)?1:0),0)}get totalCount(){return this._clients.length}};t.exports=m}),xi={};Nt(xi,{default:()=>_i});var _i,af=Ct(()=>{X(),_i={}}),sf=J((r,t)=>{"use strict";X();var e=kr().EventEmitter,o=(Tn(),xt(Ne)),i=Cn(),u=t.exports=function(s,g,v){e.call(this),s=i.normalizeQueryConfig(s,g,v),this.text=s.text,this.values=s.values,this.name=s.name,this.callback=s.callback,this.state="new",this._arrayMode=s.rowMode==="array",this._emitRowEvents=!1,this.on("newListener",function(m){m==="row"&&(this._emitRowEvents=!0)}.bind(this))};o.inherits(u,e);var l={sqlState:"code",statementPosition:"position",messagePrimary:"message",context:"where",schemaName:"schema",tableName:"table",columnName:"column",dataTypeName:"dataType",constraintName:"constraint",sourceFile:"file",sourceLine:"line",sourceFunction:"routine"};u.prototype.handleError=function(s){var g=this.native.pq.resultErrorFields();if(g)for(var v in g){var m=l[v]||v;s[m]=g[v]}this.callback?this.callback(s):this.emit("error",s),this.state="error"},u.prototype.then=function(s,g){return this._getPromise().then(s,g)},u.prototype.catch=function(s){return this._getPromise().catch(s)},u.prototype._getPromise=function(){return this._promise?this._promise:(this._promise=new Promise(function(s,g){this._once("end",s),this._once("error",g)}.bind(this)),this._promise)},u.prototype.submit=function(s){this.state="running";var g=this;this.native=s.native,s.native.arrayMode=this._arrayMode;var v=function(f,y,p){if(s.native.arrayMode=!1,Rn(function(){g.emit("_done")}),f)return g.handleError(f);g._emitRowEvents&&(p.length>1?y.forEach((h,x)=>{h.forEach(A=>{g.emit("row",A,p[x])})}):y.forEach(function(h){g.emit("row",h,p)})),g.state="end",g.emit("end",p),g.callback&&g.callback(null,p)};if(Y.domain&&(v=Y.domain.bind(v)),this.name){this.name.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",this.name,this.name.length),console.error("This can cause conflicts and silent errors executing queries"));var m=(this.values||[]).map(i.prepareValue);if(s.namedQueries[this.name]){if(this.text&&s.namedQueries[this.name]!==this.text){let f=new Error(`Prepared statements must be unique - '${this.name}' was used for a different statement`);return v(f)}return s.native.execute(this.name,m,v)}return s.native.prepare(this.name,this.text,m.length,function(f){return f?v(f):(s.namedQueries[g.name]=g.text,g.native.execute(g.name,m,v))})}else if(this.values){if(!Array.isArray(this.values)){let f=new Error("Query values must be an array");return v(f)}var d=this.values.map(i.prepareValue);s.native.query(this.text,d,v)}else s.native.query(this.text,v)}}),uf=J((r,t)=>{"use strict";X();var e=(af(),xt(xi)),o=Yo(),i=kr().EventEmitter,u=(Tn(),xt(Ne)),l=ri(),s=sf(),g=t.exports=function(v){i.call(this),v=v||{},this._Promise=v.Promise||Te.Promise,this._types=new o(v.types),this.native=new e({types:this._types}),this._queryQueue=[],this._ending=!1,this._connecting=!1,this._connected=!1,this._queryable=!0;var m=this.connectionParameters=new l(v);this.user=m.user,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:m.password}),this.database=m.database,this.host=m.host,this.port=m.port,this.namedQueries={}};g.Query=s,u.inherits(g,i),g.prototype._errorAllQueries=function(v){let m=d=>{Y.nextTick(()=>{d.native=this.native,d.handleError(v)})};this._hasActiveQuery()&&(m(this._activeQuery),this._activeQuery=null),this._queryQueue.forEach(m),this._queryQueue.length=0},g.prototype._connect=function(v){var m=this;if(this._connecting){Y.nextTick(()=>v(new Error("Client has already been connected. You cannot reuse a client.")));return}this._connecting=!0,this.connectionParameters.getLibpqConnectionString(function(d,f){if(d)return v(d);m.native.connect(f,function(y){if(y)return m.native.end(),v(y);m._connected=!0,m.native.on("error",function(p){m._queryable=!1,m._errorAllQueries(p),m.emit("error",p)}),m.native.on("notification",function(p){m.emit("notification",{channel:p.relname,payload:p.extra})}),m.emit("connect"),m._pulseQueryQueue(!0),v()})})},g.prototype.connect=function(v){if(v){this._connect(v);return}return new this._Promise((m,d)=>{this._connect(f=>{f?d(f):m()})})},g.prototype.query=function(v,m,d){var f,y,p,h,x;if(v==null)throw new TypeError("Client was passed a null or undefined query");if(typeof v.submit=="function")p=v.query_timeout||this.connectionParameters.query_timeout,y=f=v,typeof m=="function"&&(v.callback=m);else if(p=this.connectionParameters.query_timeout,f=new s(v,m,d),!f.callback){let A,C;y=new this._Promise((E,N)=>{A=E,C=N}),f.callback=(E,N)=>E?C(E):A(N)}return p&&(x=f.callback,h=setTimeout(()=>{var A=new Error("Query read timeout");Y.nextTick(()=>{f.handleError(A,this.connection)}),x(A),f.callback=()=>{};var C=this._queryQueue.indexOf(f);C>-1&&this._queryQueue.splice(C,1),this._pulseQueryQueue()},p),f.callback=(A,C)=>{clearTimeout(h),x(A,C)}),this._queryable?this._ending?(f.native=this.native,Y.nextTick(()=>{f.handleError(new Error("Client was closed and is not queryable"))}),y):(this._queryQueue.push(f),this._pulseQueryQueue(),y):(f.native=this.native,Y.nextTick(()=>{f.handleError(new Error("Client has encountered a connection error and is not queryable"))}),y)},g.prototype.end=function(v){var m=this;this._ending=!0,this._connected||this.once("connect",this.end.bind(this,v));var d;return v||(d=new this._Promise(function(f,y){v=p=>p?y(p):f()})),this.native.end(function(){m._errorAllQueries(new Error("Connection terminated")),Y.nextTick(()=>{m.emit("end"),v&&v()})}),d},g.prototype._hasActiveQuery=function(){return this._activeQuery&&this._activeQuery.state!=="error"&&this._activeQuery.state!=="end"},g.prototype._pulseQueryQueue=function(v){if(!!this._connected&&!this._hasActiveQuery()){var m=this._queryQueue.shift();if(!m){v||this.emit("drain");return}this._activeQuery=m,m.submit(this);var d=this;m.once("_done",function(){d._pulseQueryQueue()})}},g.prototype.cancel=function(v){this._activeQuery===v?this.native.cancel(function(){}):this._queryQueue.indexOf(v)!==-1&&this._queryQueue.splice(this._queryQueue.indexOf(v),1)},g.prototype.ref=function(){},g.prototype.unref=function(){},g.prototype.setTypeParser=function(v,m,d){return this._types.setTypeParser(v,m,d)},g.prototype.getTypeParser=function(v,m){return this._types.getTypeParser(v,m)}}),Wo=J((r,t)=>{"use strict";X(),t.exports=uf()}),Bn=J((r,t)=>{"use strict";X();var e=nf(),o=Be(),i=vi(),u=of(),{DatabaseError:l}=yi(),s=v=>class extends u{constructor(m){super(m,v)}},g=function(v){this.defaults=o,this.Client=v,this.Query=this.Client.Query,this.Pool=s(this.Client),this._pools=[],this.Connection=i,this.types=Oe(),this.DatabaseError=l};typeof Y.env.NODE_PG_FORCE_NATIVE<"u"?t.exports=new g(Wo()):(t.exports=new g(e),Object.defineProperty(t.exports,"native",{configurable:!0,enumerable:!1,get(){var v=null;try{v=new g(Wo())}catch(m){if(m.code!=="MODULE_NOT_FOUND")throw m}return Object.defineProperty(t.exports,"native",{value:v}),v}}))}),wi={};Nt(wi,{Client:()=>Ai,ClientBase:()=>jr.ClientBase,Connection:()=>jr.Connection,DatabaseError:()=>jr.DatabaseError,Pool:()=>ff,Query:()=>jr.Query,defaults:()=>jr.defaults,neonConfig:()=>qt,types:()=>jr.types});bi.exports=xt(wi);X();var Si=In(Bn());li();var jr=In(Bn()),Ai=class extends Si.Client{get neonConfig(){return this.connection.stream}connect(r){this.ssl&&this.neonConfig.useSecureWebSocket&&console.warn("SSL is enabled for both Postgres (e.g. ?sslmode=true in the connection string) and the WebSocket tunnel (useSecureWebSocket = true). Double encryption will increase latency and CPU usage. Please disable SSL on the Postgres connection."),this.host==="localhost"&&console.warn("The database host is 'localhost', which is the default host when none is set. If that's intentional, please ignore this warning. If not, perhaps an environment variable has not been set, or has not been passed to the library?");let t=super.connect(r),e=this.neonConfig.pipelineTLS&&this.ssl,o=this.neonConfig.pipelineConnect==="password";if(!e&&!this.neonConfig.pipelineConnect)return t;let i=this.connection;if(e&&i.on("connect",()=>i.stream.emit("data","S")),o){i.removeAllListeners("authenticationCleartextPassword"),i.removeAllListeners("readyForQuery"),i.once("readyForQuery",()=>i.on("readyForQuery",this._handleReadyForQuery.bind(this)));let u=this.ssl?"sslconnect":"connect";i.on(u,()=>{this._handleAuthCleartextPassword(),this._handleReadyForQuery()})}return t}async _handleAuthSASLContinue(r){let t=this.saslSession,e=this.password,o=r.data;if(t.message!=="SASLInitialResponse"||typeof e!="string"||typeof o!="string")throw new Error("SASL: protocol error");let i=Object.fromEntries(o.split(",").map(V=>{if(!/^.=/.test(V))throw new Error("SASL: Invalid attribute pair entry");let j=V[0],$=V.substring(2);return[j,$]})),u=i.r,l=i.s,s=i.i;if(!u||!/^[!-+--~]+$/.test(u))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce missing/unprintable");if(!l||!/^(?:[a-zA-Z0-9+/]{4})*(?:[a-zA-Z0-9+/]{2}==|[a-zA-Z0-9+/]{3}=)?$/.test(l))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt missing/not base64");if(!s||!/^[1-9][0-9]*$/.test(s))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: missing/invalid iteration count");if(!u.startsWith(t.clientNonce))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce does not start with client nonce");if(u.length===t.clientNonce.length)throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce is too short");let g=parseInt(s,10),v=G.from(l,"base64"),m=new TextEncoder,d=m.encode(e),f=await vt.subtle.importKey("raw",d,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),y=new Uint8Array(await vt.subtle.sign("HMAC",f,G.concat([v,G.from([0,0,0,1])]))),p=y;for(var h=0;h<g-1;h++)y=new Uint8Array(await vt.subtle.sign("HMAC",f,y)),p=G.from(p.map((V,j)=>p[j]^y[j]));let x=p,A=await vt.subtle.importKey("raw",x,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),C=new Uint8Array(await vt.subtle.sign("HMAC",A,m.encode("Client Key"))),E=await vt.subtle.digest("SHA-256",C),N="n=*,r="+t.clientNonce,O="r="+u+",s="+l+",i="+g,_="c=biws,r="+u,k=N+","+O+","+_,R=await vt.subtle.importKey("raw",E,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]);var S=new Uint8Array(await vt.subtle.sign("HMAC",R,m.encode(k))),T=G.from(C.map((V,j)=>C[j]^S[j])),L=T.toString("base64");let W=await vt.subtle.importKey("raw",x,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),Q=await vt.subtle.sign("HMAC",W,m.encode("Server Key")),B=await vt.subtle.importKey("raw",Q,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]);var z=G.from(await vt.subtle.sign("HMAC",B,m.encode(k)));t.message="SASLResponse",t.serverSignature=z.toString("base64"),t.response=_+",p="+L,this.connection.sendSCRAMClientFinalMessage(this.saslSession.response)}},ff=class extends Si.Pool{constructor(){super(...arguments),F(this,"Client",Ai)}}});var so=({base:r="",routes:t=[]}={})=>({__proto__:new Proxy({},{get:(e,o,i)=>(u,...l)=>t.push([o.toUpperCase(),RegExp(`^${(r+u).replace(/(\/?)\*/g,"($1.*)?").replace(/(\/$)|((?<=\/)\/)/,"").replace(/(:(\w+)\+)/,"(?<$2>.*)").replace(/:(\w+)(\?)?(\.)?/g,"$2(?<$1>[^/]+)$2$3").replace(/\.(?=[\w(])/,"\\.").replace(/\)\.\?\(([^\[]+)\[\^/g,"?)\\.?($1(?<=\\.)[^\\.")}/*$`),l])&&i}),routes:t,async handle(e,...o){let i,u,l=new URL(e.url),s=e.query={};for(let[g,v]of l.searchParams)s[g]=s[g]===void 0?v:[s[g],v].flat();for(let[g,v,m]of t)if((g===e.method||g==="ALL")&&(u=l.pathname.match(v))){e.params=u.groups||{};for(let d of m)if((i=await d(e.proxy||e,...o))!==void 0)return i}}});function tt(r){return r!=null&&typeof r=="object"&&r["@@functional/placeholder"]===!0}function q(r){return function t(e){return arguments.length===0||tt(e)?t:r.apply(this,arguments)}}function U(r){return function t(e,o){switch(arguments.length){case 0:return t;case 1:return tt(e)?t:q(function(i){return r(e,i)});default:return tt(e)&&tt(o)?t:tt(e)?q(function(i){return r(i,o)}):tt(o)?q(function(i){return r(e,i)}):r(e,o)}}}function Pt(r,t){switch(r){case 0:return function(){return t.apply(this,arguments)};case 1:return function(e){return t.apply(this,arguments)};case 2:return function(e,o){return t.apply(this,arguments)};case 3:return function(e,o,i){return t.apply(this,arguments)};case 4:return function(e,o,i,u){return t.apply(this,arguments)};case 5:return function(e,o,i,u,l){return t.apply(this,arguments)};case 6:return function(e,o,i,u,l,s){return t.apply(this,arguments)};case 7:return function(e,o,i,u,l,s,g){return t.apply(this,arguments)};case 8:return function(e,o,i,u,l,s,g,v){return t.apply(this,arguments)};case 9:return function(e,o,i,u,l,s,g,v,m){return t.apply(this,arguments)};case 10:return function(e,o,i,u,l,s,g,v,m,d){return t.apply(this,arguments)};default:throw new Error("First argument to _arity must be a non-negative integer no greater than ten")}}function ur(r,t,e){return function(){for(var o=[],i=0,u=r,l=0;l<t.length||i<arguments.length;){var s;l<t.length&&(!tt(t[l])||i>=arguments.length)?s=t[l]:(s=arguments[i],i+=1),o[l]=s,tt(s)||(u-=1),l+=1}return u<=0?e.apply(this,o):Pt(u,ur(r,o,e))}}var Ea=U(function(t,e){return t===1?q(e):Pt(t,ur(t,[],e))}),dt=Ea;function K(r){return function t(e,o,i){switch(arguments.length){case 0:return t;case 1:return tt(e)?t:U(function(u,l){return r(e,u,l)});case 2:return tt(e)&&tt(o)?t:tt(e)?U(function(u,l){return r(u,o,l)}):tt(o)?U(function(u,l){return r(e,u,l)}):q(function(u){return r(e,o,u)});default:return tt(e)&&tt(o)&&tt(i)?t:tt(e)&&tt(o)?U(function(u,l){return r(u,l,i)}):tt(e)&&tt(i)?U(function(u,l){return r(u,o,l)}):tt(o)&&tt(i)?U(function(u,l){return r(e,u,l)}):tt(e)?q(function(u){return r(u,o,i)}):tt(o)?q(function(u){return r(e,u,i)}):tt(i)?q(function(u){return r(e,o,u)}):r(e,o,i)}}}var yt=Array.isArray||function(t){return t!=null&&t.length>=0&&Object.prototype.toString.call(t)==="[object Array]"};function Xr(r){return r!=null&&typeof r["@@transducer/step"]=="function"}function et(r,t,e){return function(){if(arguments.length===0)return e();var o=arguments[arguments.length-1];if(!yt(o)){for(var i=0;i<r.length;){if(typeof o[r[i]]=="function")return o[r[i]].apply(o,Array.prototype.slice.call(arguments,0,-1));i+=1}if(Xr(o)){var u=t.apply(null,Array.prototype.slice.call(arguments,0,-1));return u(o)}}return e.apply(this,arguments)}}var nt={init:function(){return this.xf["@@transducer/init"]()},result:function(r){return this.xf["@@transducer/result"](r)}};function gt(r,t){return Object.prototype.hasOwnProperty.call(t,r)}var uo=Object.prototype.toString,Ia=function(){return uo.call(arguments)==="[object Arguments]"?function(t){return uo.call(t)==="[object Arguments]"}:function(t){return gt("callee",t)}}(),Ze=Ia;var Ra=!{toString:null}.propertyIsEnumerable("toString"),fo=["constructor","valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],po=function(){"use strict";return arguments.propertyIsEnumerable("length")}(),Ua=function(t,e){for(var o=0;o<t.length;){if(t[o]===e)return!0;o+=1}return!1},Ca=typeof Object.keys=="function"&&!po?q(function(t){return Object(t)!==t?[]:Object.keys(t)}):q(function(t){if(Object(t)!==t)return[];var e,o,i=[],u=po&&Ze(t);for(e in t)gt(e,t)&&(!u||e!=="length")&&(i[i.length]=e);if(Ra)for(o=fo.length-1;o>=0;)e=fo[o],gt(e,t)&&!Ua(i,e)&&(i[i.length]=e),o-=1;return i}),Bt=Ca;function Ir(r,t){for(var e=0,o=t.length,i=Array(o);e<o;)i[e]=r(t[e]),e+=1;return i}var Vr=function(t){return(t<10?"0":"")+t},Ml=typeof Date.prototype.toISOString=="function"?function(t){return t.toISOString()}:function(t){return t.getUTCFullYear()+"-"+Vr(t.getUTCMonth()+1)+"-"+Vr(t.getUTCDate())+"T"+Vr(t.getUTCHours())+":"+Vr(t.getUTCMinutes())+":"+Vr(t.getUTCSeconds())+"."+(t.getUTCMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"};function pr(r,t,e){for(var o=0,i=e.length;o<i;)t=r(t,e[o]),o+=1;return t}function zr(r,t){for(var e=0,o=t.length,i=[];e<o;)r(t[e])&&(i[i.length]=t[e]),e+=1;return i}function Rr(r){return Object.prototype.toString.call(r)==="[object Object]"}var Pa=function(){function r(t,e){this.xf=e,this.f=t}return r.prototype["@@transducer/init"]=nt.init,r.prototype["@@transducer/result"]=nt.result,r.prototype["@@transducer/step"]=function(t,e){return this.f(e)?this.xf["@@transducer/step"](t,e):t},r}();function tn(r){return function(t){return new Pa(r,t)}}var Ta=U(et(["fantasy-land/filter","filter"],tn,function(r,t){return Rr(t)?pr(function(e,o){return r(t[o])&&(e[o]=t[o]),e},{},Bt(t)):zr(r,t)})),Gr=Ta;var Na=function(){function r(t,e){this.xf=e,this.f=t}return r.prototype["@@transducer/init"]=nt.init,r.prototype["@@transducer/result"]=nt.result,r.prototype["@@transducer/step"]=function(t,e){return this.xf["@@transducer/step"](t,this.f(e))},r}(),Ma=function(t){return function(e){return new Na(t,e)}},en=Ma;var Da=U(et(["fantasy-land/map","map"],en,function(t,e){switch(Object.prototype.toString.call(e)){case"[object Function]":return dt(e.length,function(){return t.call(this,e.apply(this,arguments))});case"[object Object]":return pr(function(o,i){return o[i]=t(e[i]),o},{},Bt(e));default:return Ir(t,e)}})),Kt=Da;var Zt=Number.isInteger||function(t){return t<<0===t};function tr(r){return Object.prototype.toString.call(r)==="[object String]"}var Wa=U(function(t,e){var o=t<0?e.length+t:t;return tr(e)?e.charAt(o):e[o]}),cr=Wa;var qa=U(function(t,e){if(e!=null)return Zt(t)?cr(t,e):e[t]}),zt=qa;var ja=U(function(t,e){return Kt(zt(t),e)}),Ur=ja;var Fa=q(function(t){return yt(t)?!0:!t||typeof t!="object"||tr(t)?!1:t.length===0?!0:t.length>0?t.hasOwnProperty(0)&&t.hasOwnProperty(t.length-1):!1}),Yr=Fa;var mo=typeof Symbol<"u"?Symbol.iterator:"@@iterator";function _e(r,t,e){return function(i,u,l){if(Yr(l))return r(i,u,l);if(l==null)return u;if(typeof l["fantasy-land/reduce"]=="function")return t(i,u,l,"fantasy-land/reduce");if(l[mo]!=null)return e(i,u,l[mo]());if(typeof l.next=="function")return e(i,u,l);if(typeof l.reduce=="function")return t(i,u,l,"reduce");throw new TypeError("reduce: list must be array or iterable")}}function we(r,t,e){for(var o=0,i=e.length;o<i;){if(t=r["@@transducer/step"](t,e[o]),t&&t["@@transducer/reduced"]){t=t["@@transducer/value"];break}o+=1}return r["@@transducer/result"](t)}var Qa=U(function(t,e){return Pt(t.length,function(){return t.apply(e,arguments)})}),nn=Qa;function Ka(r,t,e){for(var o=e.next();!o.done;){if(t=r["@@transducer/step"](t,o.value),t&&t["@@transducer/reduced"]){t=t["@@transducer/value"];break}o=e.next()}return r["@@transducer/result"](t)}function Ha(r,t,e,o){return r["@@transducer/result"](e[o](nn(r["@@transducer/step"],r),t))}var Xa=_e(we,Ha,Ka),lr=Xa;var Va=function(){function r(t){this.f=t}return r.prototype["@@transducer/init"]=function(){throw new Error("init not implemented on XWrap")},r.prototype["@@transducer/result"]=function(t){return t},r.prototype["@@transducer/step"]=function(t,e){return this.f(t,e)},r}();function Mr(r){return new Va(r)}var za=K(function(r,t,e){return lr(typeof r=="function"?Mr(r):r,t,e)}),Gt=za;function un(r,t){return function(){return t.call(this,r.apply(this,arguments))}}function mr(r,t){return function(){var e=arguments.length;if(e===0)return t();var o=arguments[e-1];return yt(o)||typeof o[r]!="function"?t.apply(this,arguments):o[r].apply(o,Array.prototype.slice.call(arguments,0,e-1))}}var es=K(mr("slice",function(t,e,o){return Array.prototype.slice.call(o,t,e)})),Wt=es;var ns=q(mr("tail",Wt(1,1/0))),be=ns;function Wr(){if(arguments.length===0)throw new Error("pipe requires at least one argument");return Pt(arguments[0].length,Gt(un,arguments[0],be(arguments)))}var d8=typeof String.prototype.trim=="function";var Cr=r=>new Response(r,{status:200}),Lo=()=>new Response("Not found",{status:404}),ko=()=>new Response("Internal error",{status:500});var Jt=ba(Ei(),1);var Ii=Jt.default.Client,MP=Jt.default.ClientBase,DP=Jt.default.Connection,WP=Jt.default.DatabaseError,qP=Jt.default.Pool,jP=Jt.default.Query,FP=Jt.default.defaults,QP=Jt.default.neonConfig,KP=Jt.default.types;var Ri=async r=>r.query("SELECT * FROM artists;"),Ui=r=>async t=>t.query(`insert into artists (name) values ('${r.name}');`);var Ci=async r=>{let t=new Ii(r.DATABASE_URL);return await t.connect(),t},Nn=async r=>Ci(r).then(Ri).then(zt("rows")),Li=r=>async t=>Ci(r).then(Ui(t)).then(JSON.stringify);var ki=r=>async t=>t.json().then(e=>e).then(Li(r)).then(Cr).catch(ko),pf=r=>t=>t.toLowerCase().includes(r.toLowerCase()),Pi=r=>async t=>{let e=decodeURIComponent(t.params.artist);return Nn(r).then(Wr(Gr(o=>pf(e)(o.name)),JSON.stringify,Cr))},cf=Wr(Ur("name"),JSON.stringify,Cr),Ti=r=>async()=>Nn(r).then(cf);function rt(r){return r!=null&&typeof r=="object"&&r["@@functional/placeholder"]===!0}function D(r){return function t(e){return arguments.length===0||rt(e)?t:r.apply(this,arguments)}}function b(r){return function t(e,o){switch(arguments.length){case 0:return t;case 1:return rt(e)?t:D(function(i){return r(e,i)});default:return rt(e)&&rt(o)?t:rt(e)?D(function(i){return r(i,o)}):rt(o)?D(function(i){return r(e,i)}):r(e,o)}}}var lf=b(function(t,e){return Number(t)+Number(e)}),Pr=lf;function Mt(r,t){r=r||[],t=t||[];var e,o=r.length,i=t.length,u=[];for(e=0;e<o;)u[u.length]=r[e],e+=1;for(e=0;e<i;)u[u.length]=t[e],e+=1;return u}function Tt(r,t){switch(r){case 0:return function(){return t.apply(this,arguments)};case 1:return function(e){return t.apply(this,arguments)};case 2:return function(e,o){return t.apply(this,arguments)};case 3:return function(e,o,i){return t.apply(this,arguments)};case 4:return function(e,o,i,u){return t.apply(this,arguments)};case 5:return function(e,o,i,u,l){return t.apply(this,arguments)};case 6:return function(e,o,i,u,l,s){return t.apply(this,arguments)};case 7:return function(e,o,i,u,l,s,g){return t.apply(this,arguments)};case 8:return function(e,o,i,u,l,s,g,v){return t.apply(this,arguments)};case 9:return function(e,o,i,u,l,s,g,v,m){return t.apply(this,arguments)};case 10:return function(e,o,i,u,l,s,g,v,m,d){return t.apply(this,arguments)};default:throw new Error("First argument to _arity must be a non-negative integer no greater than ten")}}function rr(r,t,e){return function(){for(var o=[],i=0,u=r,l=0;l<t.length||i<arguments.length;){var s;l<t.length&&(!rt(t[l])||i>=arguments.length)?s=t[l]:(s=arguments[i],i+=1),o[l]=s,rt(s)||(u-=1),l+=1}return u<=0?e.apply(this,o):Tt(u,rr(r,o,e))}}var mf=b(function(t,e){return t===1?D(e):Tt(t,rr(t,[],e))}),ct=mf;function H(r){return function t(e,o,i){switch(arguments.length){case 0:return t;case 1:return rt(e)?t:b(function(u,l){return r(e,u,l)});case 2:return rt(e)&&rt(o)?t:rt(e)?b(function(u,l){return r(u,o,l)}):rt(o)?b(function(u,l){return r(e,u,l)}):D(function(u){return r(e,o,u)});default:return rt(e)&&rt(o)&&rt(i)?t:rt(e)&&rt(o)?b(function(u,l){return r(u,l,i)}):rt(e)&&rt(i)?b(function(u,l){return r(u,o,l)}):rt(o)&&rt(i)?b(function(u,l){return r(e,u,l)}):rt(e)?D(function(u){return r(u,o,i)}):rt(o)?D(function(u){return r(e,u,i)}):rt(i)?D(function(u){return r(e,o,u)}):r(e,o,i)}}}var _t=Array.isArray||function(t){return t!=null&&t.length>=0&&Object.prototype.toString.call(t)==="[object Array]"};function oe(r){return r!=null&&typeof r["@@transducer/step"]=="function"}function st(r,t,e){return function(){if(arguments.length===0)return e();var o=arguments[arguments.length-1];if(!_t(o)){for(var i=0;i<r.length;){if(typeof o[r[i]]=="function")return o[r[i]].apply(o,Array.prototype.slice.call(arguments,0,-1));i+=1}if(oe(o)){var u=t.apply(null,Array.prototype.slice.call(arguments,0,-1));return u(o)}}return e.apply(this,arguments)}}var ft={init:function(){return this.xf["@@transducer/init"]()},result:function(r){return this.xf["@@transducer/result"](r)}};var hf=b(function(t,e){return e>t?e:t}),gr=hf;function vr(r,t){for(var e=0,o=t.length,i=Array(o);e<o;)i[e]=r(t[e]),e+=1;return i}function xr(r){return Object.prototype.toString.call(r)==="[object String]"}var df=D(function(t){return _t(t)?!0:!t||typeof t!="object"||xr(t)?!1:t.length===0?!0:t.length>0?t.hasOwnProperty(0)&&t.hasOwnProperty(t.length-1):!1}),ie=df;var yf=function(){function r(t){this.f=t}return r.prototype["@@transducer/init"]=function(){throw new Error("init not implemented on XWrap")},r.prototype["@@transducer/result"]=function(t){return t},r.prototype["@@transducer/step"]=function(t,e){return this.f(t,e)},r}();function Me(r){return new yf(r)}var gf=b(function(t,e){return Tt(t.length,function(){return t.apply(e,arguments)})}),Mn=gf;function vf(r,t,e){for(var o=0,i=e.length;o<i;){if(t=r["@@transducer/step"](t,e[o]),t&&t["@@transducer/reduced"]){t=t["@@transducer/value"];break}o+=1}return r["@@transducer/result"](t)}function Oi(r,t,e){for(var o=e.next();!o.done;){if(t=r["@@transducer/step"](t,o.value),t&&t["@@transducer/reduced"]){t=t["@@transducer/value"];break}o=e.next()}return r["@@transducer/result"](t)}function Bi(r,t,e,o){return r["@@transducer/result"](e[o](Mn(r["@@transducer/step"],r),t))}var Ni=typeof Symbol<"u"?Symbol.iterator:"@@iterator";function St(r,t,e){if(typeof r=="function"&&(r=Me(r)),ie(e))return vf(r,t,e);if(typeof e["fantasy-land/reduce"]=="function")return Bi(r,t,e,"fantasy-land/reduce");if(e[Ni]!=null)return Oi(r,t,e[Ni]());if(typeof e.next=="function")return Oi(r,t,e);if(typeof e.reduce=="function")return Bi(r,t,e,"reduce");throw new TypeError("reduce: list must be array or iterable")}var xf=function(){function r(t,e){this.xf=e,this.f=t}return r.prototype["@@transducer/init"]=ft.init,r.prototype["@@transducer/result"]=ft.result,r.prototype["@@transducer/step"]=function(t,e){return this.xf["@@transducer/step"](t,this.f(e))},r}(),_f=b(function(t,e){return new xf(t,e)}),Mi=_f;function mt(r,t){return Object.prototype.hasOwnProperty.call(t,r)}var Di=Object.prototype.toString,wf=function(){return Di.call(arguments)==="[object Arguments]"?function(t){return Di.call(t)==="[object Arguments]"}:function(t){return mt("callee",t)}}(),Dn=wf;var Sf=!{toString:null}.propertyIsEnumerable("toString"),Wi=["constructor","valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],qi=function(){"use strict";return arguments.propertyIsEnumerable("length")}(),Af=function(t,e){for(var o=0;o<t.length;){if(t[o]===e)return!0;o+=1}return!1},bf=typeof Object.keys=="function"&&!qi?D(function(t){return Object(t)!==t?[]:Object.keys(t)}):D(function(t){if(Object(t)!==t)return[];var e,o,i=[],u=qi&&Dn(t);for(e in t)mt(e,t)&&(!u||e!=="length")&&(i[i.length]=e);if(Sf)for(o=Wi.length-1;o>=0;)e=Wi[o],mt(e,t)&&!Af(i,e)&&(i[i.length]=e),o-=1;return i}),Lt=bf;var Ef=b(st(["fantasy-land/map","map"],Mi,function(t,e){switch(Object.prototype.toString.call(e)){case"[object Function]":return ct(e.length,function(){return t.call(this,e.apply(this,arguments))});case"[object Object]":return St(function(o,i){return o[i]=t(e[i]),o},{},Lt(e));default:return vr(t,e)}})),kt=Ef;var er=Number.isInteger||function(t){return t<<0===t};var If=b(function(t,e){var o=t<0?e.length+t:t;return xr(e)?e.charAt(o):e[o]}),Et=If;var Rf=b(function(t,e){if(e!=null)return er(t)?Et(t,e):e[t]}),Yt=Rf;var Uf=b(function(t,e){return kt(Yt(t),e)}),Tr=Uf;var Cf=H(St),Dt=Cf;var Lf=b(function(t,e){return Mt(e,[t])}),De=Lf;var kf=b(function(t,e){return t.apply(this,e)}),Wn=kf;var Pf=D(function(t){for(var e=Lt(t),o=e.length,i=[],u=0;u<o;)i[u]=t[e[u]],u+=1;return i}),qn=Pf;function ji(r,t){return _t(t)?t.map(r):Lt(t).reduce(function(e,o){return e[o]=r(t[o]),e},{})}var Tf=D(function r(t){return t=ji(function(e){return typeof e=="function"?e:r(e)},t),ct(Dt(gr,0,Tr("length",qn(t))),function(){var e=arguments;return ji(function(o){return Wn(o,e)},t)})}),We=Tf;var Mf=D(function(t){return t===null?"Null":t===void 0?"Undefined":Object.prototype.toString.call(t).slice(8,-1)}),Or=Mf;function Kn(r,t){return function(){return t.call(this,r.apply(this,arguments))}}function _r(r,t){return function(){var e=arguments.length;if(e===0)return t();var o=arguments[e-1];return _t(o)||typeof o[r]!="function"?t.apply(this,arguments):o[r].apply(o,Array.prototype.slice.call(arguments,0,e-1))}}var qf=H(_r("slice",function(t,e,o){return Array.prototype.slice.call(o,t,e)})),jt=qf;var jf=D(_r("tail",jt(1,1/0))),je=jf;function nr(){if(arguments.length===0)throw new Error("pipe requires at least one argument");return Tt(arguments[0].length,Dt(Kn,arguments[0],je(arguments)))}function ae(r){return r}var Ff=D(ae),Qr=Ff;function Fe(r){for(var t=[],e;!(e=r.next()).done;)t.push(e.value);return t}function wr(r,t,e){for(var o=0,i=e.length;o<i;){if(r(t,e[o]))return!0;o+=1}return!1}function Hn(r){var t=String(r).match(/^function (\w*)/);return t==null?"":t[1]}function Hf(r,t){return r===t?r!==0||1/r===1/t:r!==r&&t!==t}var se=typeof Object.is=="function"?Object.is:Hf;function Vi(r,t,e,o){var i=Fe(r),u=Fe(t);function l(s,g){return ue(s,g,e.slice(),o.slice())}return!wr(function(s,g){return!wr(l,g,s)},u,i)}function ue(r,t,e,o){if(se(r,t))return!0;var i=Or(r);if(i!==Or(t))return!1;if(typeof r["fantasy-land/equals"]=="function"||typeof t["fantasy-land/equals"]=="function")return typeof r["fantasy-land/equals"]=="function"&&r["fantasy-land/equals"](t)&&typeof t["fantasy-land/equals"]=="function"&&t["fantasy-land/equals"](r);if(typeof r.equals=="function"||typeof t.equals=="function")return typeof r.equals=="function"&&r.equals(t)&&typeof t.equals=="function"&&t.equals(r);switch(i){case"Arguments":case"Array":case"Object":if(typeof r.constructor=="function"&&Hn(r.constructor)==="Promise")return r===t;break;case"Boolean":case"Number":case"String":if(!(typeof r==typeof t&&se(r.valueOf(),t.valueOf())))return!1;break;case"Date":if(!se(r.valueOf(),t.valueOf()))return!1;break;case"Error":return r.name===t.name&&r.message===t.message;case"RegExp":if(!(r.source===t.source&&r.global===t.global&&r.ignoreCase===t.ignoreCase&&r.multiline===t.multiline&&r.sticky===t.sticky&&r.unicode===t.unicode))return!1;break}for(var u=e.length-1;u>=0;){if(e[u]===r)return o[u]===t;u-=1}switch(i){case"Map":return r.size!==t.size?!1:Vi(r.entries(),t.entries(),e.concat([r]),o.concat([t]));case"Set":return r.size!==t.size?!1:Vi(r.values(),t.values(),e.concat([r]),o.concat([t]));case"Arguments":case"Array":case"Object":case"Boolean":case"Number":case"String":case"Date":case"Error":case"RegExp":case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":case"ArrayBuffer":break;default:return!1}var l=Lt(r);if(l.length!==Lt(t).length)return!1;var s=e.concat([r]),g=o.concat([t]);for(u=l.length-1;u>=0;){var v=l[u];if(!(mt(v,t)&&ue(t[v],r[v],s,g)))return!1;u-=1}return!0}var Xf=b(function(t,e){return ue(t,e,[],[])}),Ot=Xf;var fe=function(t){return(t<10?"0":"")+t},ID=typeof Date.prototype.toISOString=="function"?function(t){return t.toISOString()}:function(t){return t.getUTCFullYear()+"-"+fe(t.getUTCMonth()+1)+"-"+fe(t.getUTCDate())+"T"+fe(t.getUTCHours())+":"+fe(t.getUTCMinutes())+":"+fe(t.getUTCSeconds())+"."+(t.getUTCMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"};var Yf=b(function(t,e){return ct(Dt(gr,0,Tr("length",e)),function(){var o=arguments,i=this;return t.apply(i,vr(function(u){return u.apply(i,o)},e))})}),He=Yf;var tp=b(function(t,e){return t/e}),Kr=tp;var up=H(function(t,e,o){return ct(Math.max(t.length,e.length,o.length),function(){return t.apply(this,arguments)?e.apply(this,arguments):o.apply(this,arguments)})}),Gn=up;function Ve(r){return Object.prototype.toString.call(r)==="[object Number]"}var lp=D(function(t){return t!=null&&Ve(t.length)?t.length:NaN}),pe=lp;var yp=Dt(Pr,0),le=yp;var gp=D(function(t){return le(t)/t.length}),or=gp;var xp=b(function(t,e){return t*e}),Sr=xp;var Cp=b(function(t,e){var o=Number(e),i=0,u;if(o<0||isNaN(o))throw new RangeError("n must be a non-negative number");for(u=new Array(o);i<o;)u[i]=t(i),i+=1;return u}),ze=Cp;var Tp=b(function(t,e){return Number(t)-Number(e)}),Hr=Tp;var HG=typeof String.prototype.trim=="function";var jp=b(function(t,e){for(var o=[],i=0,u=Math.min(t.length,e.length);i<u;)o[i]=[t[i],e[i]],i+=1;return o}),ro=jp;var ia=(r,t)=>Hr(r,t),sa=r=>r*r,Fp=r=>r**(1/2),Qp=(r,t)=>e=>Sr(ia(Et(e,r),or(r)),ia(Et(e,t),or(t))),Kp=(r,t)=>le(ze(Qp(r,t),pe(r))),Hp=r=>Hr(Et(0,r),Et(1,r)),Xp=nr(Hp,sa),Vp=kt(Xp),zp=nr(ro,Vp,or),ua=(r,t)=>zp(r,t),Ge=(r,t)=>Kr(Kp(r,t),pe(r)),eo=r=>Ge(r,r),aa=r=>Fp(eo(r)),no=(r,t)=>Kr(Ge(r,t),Sr(aa(r),aa(t))),fa=(r,t)=>sa(no(r,t));var Gp=(r,t)=>Kr(Ge(r,t),eo(r)),Jp=(r,t)=>e=>Hr(or(t),Sr(e,or(r))),Yp=(r,t)=>nr(Et(0),Jp(r,t)),pa=r=>t=>Pr(Sr(r.a,t),r.b),$p=r=>t=>kt(pa(r))(t),Zp=r=>Ot(Or(r),"Number"),oo=(r,t)=>tc(Yt("parameters",t),r),tc=(r,t)=>Gn(Zp,pa(r),$p(r))(t),ca=(r,t)=>We({parameters:nr(De(Gp(r,t)),He(De,[Yp(r,t),Qr]),We({a:Et(0),b:Et(1)}))})([]),rc=(r,t)=>{let e=ca(r,t),o=oo(r,e);return{...e,trainData:{x:r,y:t},trainCurvePredict:o,statistics:{r2:fa(r,t),cost:ua(t,o),pearson:no(r,t)}}},la=(r,t,e=!1)=>e?ca(r,t):rc(r,t);var ma=so(),ec=()=>Cr("helloworld"),nc=()=>{let e=la([1,2,3,4,5,6,7,8,9],[2,4,6,8,10,12,14,16,18]);return Cr(String(oo(10,e)))},oc=async(r,t,e)=>(ma.get("/helloworld",ec).get("/getArtist/:artist",Pi(t)).post("/addArtist/",ki(t)).get("/getAllArtists",Ti(t)).get("/linear-regression",nc).all("*",Lo),ma.handle(r,t,e)),kit={fetch:oc};export{kit as default};
//# sourceMappingURL=index.js.map
